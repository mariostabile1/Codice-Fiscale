/*
 * Wallaby.js - v1.0.1302
 * https://wallabyjs.com
 * Copyright (c) 2014-2022 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("acorn").tokTypes,o=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,s=function(e){o.lastIndex=e.pos;var t=o.exec(e.input),i=e.pos+t[0].length;return"."===e.input.slice(i,i+1)};t.exports=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parseExprAtom=function(t){if(this.type!==r._import||!s(this))return e.prototype.parseExprAtom.call(this,t);this.options.allowImportExportEverywhere||this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'");var i=this.startNode();return this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),i.meta=this.parseIdent(!0),this.expect(r.dot),i.property=this.parseIdent(!0),"meta"!==i.property.name&&this.raiseRecoverable(i.property.start,"The only valid meta property for import is import.meta"),this.containsEsc&&this.raiseRecoverable(i.property.start,'"meta" in import.meta must not contain escape sequences'),this.finishNode(i,"MetaProperty")},t.prototype.parseStatement=function(t,i,n){if(this.type!==r._import||!s(this))return e.prototype.parseStatement.call(this,t,i,n);var o=this.startNode(),a=this.parseExpression();return this.parseExpressionStatement(o,a)},t}(e)}},{acorn:void 0}],2:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();t.exports=function(t){var i=t.acorn||e("acorn"),r=i.tokTypes;return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?(t=this.input.charCodeAt(this.pos+2),61===t?this.finishOp(r.assign,3):this.finishOp(124===e?r.logicalOR:r.logicalAND,2)):61===t?this.finishOp(r.assign,2):this.finishOp(124===e?r.bitwiseOR:r.bitwiseAND,1)},t.prototype.getTokenFromCode=function(t){return 63==t?this.readToken_question():e.prototype.getTokenFromCode.call(this,t)},t.prototype.readToken_question=function(){if(this.options.ecmaVersion>=11){var t=this.input.charCodeAt(this.pos+1);if(63===t&&(t=this.input.charCodeAt(this.pos+2),61===t))return this.finishOp(r.assign,3)}return e.prototype.readToken_question?e.prototype.readToken_question.call(this):this.finishOp(r.question,1)},t}(t)}},{acorn:void 0}],3:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("acorn");t.exports=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.readInt=function(t,i){if(null!=i)return e.prototype.readInt.call(this,t,i);for(var n=this.pos,r=0,o=!1;;){var s=this.input.charCodeAt(this.pos),a=void 0;if(s>=97)a=s-97+10;else{if(95==s){o||this.raise(this.pos,"Invalid numeric separator"),++this.pos,o=!1;continue}a=s>=65?s-65+10:s>=48&&s<=57?s-48:1/0}if(a>=t)break;++this.pos,r=r*t+a,o=!0}return this.pos===n?null:(o||this.raise(this.pos-1,"Invalid numeric separator"),r)},t.prototype.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10)||this.raise(t,"Invalid number");var i=this.pos-t>=2&&48===this.input.charCodeAt(t),n=!1;i&&this.strict&&this.raise(t,"Invalid number");var o=this.input.charCodeAt(this.pos);if(!i&&!e&&this.options.ecmaVersion>=11&&110===o){var s=this.getNumberInput(t,this.pos),a="undefined"!=typeof BigInt?BigInt(s):null;return++this.pos,r.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(r.tokTypes.num,a)}i&&/[89]/.test(this.input.slice(t,this.pos))&&(i=!1,n=!0),46!==o||i||(++this.pos,this.readInt(10),o=this.input.charCodeAt(this.pos)),69!==o&&101!==o||i||(o=this.input.charCodeAt(++this.pos),43!==o&&45!==o||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),r.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var l=this.getNumberInput(t,this.pos);(i||n)&&l.length<this.pos-t&&this.raise(t,"Invalid number");var c=i?parseInt(l,8):parseFloat(l);return this.finishToken(r.tokTypes.num,c)},t.prototype.parseLiteral=function(t){var i=e.prototype.parseLiteral.call(this,t);return i.bigint&&(i.bigint=i.bigint.replace(/_/g,"")),i},t.prototype.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var i=this.readInt(e);if(null==i&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)){var n=this.getNumberInput(t,this.pos);i="undefined"!=typeof BigInt?BigInt(n):null,++this.pos}else r.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");return this.finishToken(r.tokTypes.num,i)},t.prototype.getNumberInput=function(e,t){return this.input.slice(e,t).replace(/_/g,"")},t}(e)}},{acorn:void 0}],4:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();t.exports=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.isDirectiveCandidate=function(){return!1},t.prototype.strictDirective=function(){return!1},t.prototype.canDeclareLexicalName=function(){return!0},t.prototype.canDeclareVarName=function(){return!0},t.prototype.isSimpleParamList=function(){return!0},t.prototype.adaptDirectivePrologue=function(){},t.prototype.checkParams=function(){},t.prototype.checkPatternErrors=function(){},t.prototype.checkPatternExport=function(){},t.prototype.checkPropClash=function(){},t.prototype.checkVariableExport=function(){},t.prototype.checkYieldAwaitInDefaultParams=function(){},t.prototype.declareLexicalName=function(){},t.prototype.declareVarName=function(){},t.prototype.enterFunctionScope=function(){},t.prototype.enterLexicalScope=function(){},t.prototype.exitFunctionScope=function(){},t.prototype.exitLexicalScope=function(){},t.prototype.invalidStringToken=function(){},t}(e)}},{}],5:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();t.exports=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parseMaybeUnary=function(){return this.isContextual("await")?this.parseAwait():e.prototype.parseMaybeUnary.apply(this,arguments)},t}(e)}},{}],6:[function(e,t,i){t.exports=function(e){return e.JSXExpressionContainer=e.ExpressionStatement,e.JSXSpreadChild=e.ExpressionStatement,e.JSXClosingFragment=e.Identifier,e.JSXEmptyExpression=e.Identifier,e.JSXIdentifier=e.Identifier,e.JSXOpeningFragment=e.Identifier,e.JSXText=e.Identifier,e.JSXSpreadAttribute=e.SpreadElement,e.JSXAttribute=function(e,t,i){i(e.name,t),e.value&&i(e.value,t)},e.JSXMemberExpression=function(e,t,i){i(e.object,t),i(e.property,t)},e.JSXNamespacedName=function(e,t,i){i(e.namespace,t),i(e.name,t)},e.JSXOpeningElement=function(e,t,i){i(e.name,t);for(var n=0;n<e.attributes.length;++n)i(e.attributes[n],t)},e.JSXClosingElement=function(e,t,i){i(e.name,t)},e.JSXElement=function(e,t,i){i(e.openingElement,t);for(var n=0;n<e.children.length;++n)i(e.children[n],t);e.closingElement&&i(e.closingElement,t)},e.JSXFragment=function(e,t,i){i(e.openingFragment,t);for(var n=0;n<e.children.length;++n)i(e.children[n],t);i(e.closingFragment,t)},e}},{}],7:[function(e,t,i){e("./global");var n=e("path"),r=e("fs");process.on("uncaughtException",function(t){if(!(t&&"spawn"===t.syscall&&"OK"===t.code||(t&&t.message&&_.isString(t.message)&&0===t.message.indexOf("payload cannot exceed")&&(t.stack="One of the files specified in your `files`/`tests` list is too large, "+t.stack),t&&t.message&&_.isString(t.message)&&~t.message.indexOf("EADDRINUSE")&&~t.message.indexOf("51245")))){try{if(t instanceof Error){var i=e("path").dirname(process.mainModule.filename);t.stack=_.filter(t.stack.split("\n"),function(e,t){return!t||!_.contains(e,i)}).join("\n")}}catch(n){}console.error(t instanceof Error?t.stack:e("util").inspect(t))}});var o=!1;t.exports={start:function(t){t.onConnected=function(i){t.Project=e("./project"),t.diffMatchPatch=new(e("./diffMatchPatch"));var s=new t.Receiver(t),a=process.exit,l=function(){if(h(!0),!o){o=!0,s.stop(s._emergencyExit);var e=s.shutdown(),t=arguments,i=function(){process.env.quokka||r.unlinkSync(n.join(s.projectCachePath,"running")),console.log("wallaby.js stopped"),a.apply(process,t)};!e||s._emergencyExit?i():Promise.race([e["finally"](function(){return i()}),new Promise(function(e){setTimeout(function(){i(),e()},1e4)})])}},c=process.exit=function(){l.apply(null,arguments)};process.on("SIGINT",function(){c.apply(null,arguments)});var u,h=function(e){clearTimeout(u),e&&(d=function(){})},d=function(e){u=setTimeout(function(){try{i.send({type:"ping"}),f()}catch(t){e?(s._emergencyExit=!0,l()):d(!0)}},e?1e3:1e4)},f=function(){h(),d()};return s.on("message",function(e){if(!e._internal)try{i.send(e)}finally{f()}}),i.receive=function(e){f();var t="unknown";try{if(t=e.type,!("string"==typeof t&&t.length>0&&"_"!==t[0]))throw new Error("Incorrect incoming message format");var i=s[t](e);i&&i["catch"]&&i["catch"](function(e){e.noDetails?console.error(e.message):console.error("Failed to execute "+t+" operation, "+e.stack)})}catch(n){console.error("Failed to start "+t+" operation, "+n.stack)}},s.configure(),s}}}},{"./diffMatchPatch":39,"./global":43,"./project":62,fs:void 0,path:void 0,util:void 0}],8:[function(e,t,i){"use strict";var n,r,o=e("path"),s=e("semver"),a=e("./utils"),l=e("./babelVisitor"),c="5.0.9",u="7.0.0-beta.0",h=!0,d="babel",f="babel-core",p="@babel/core",g=function(){function e(e,t,i){_.isEmpty(e)||e.babelrc||(e.babelrc=!1),this._opts=_.extend({filename:t},e||{}),!this._opts.filename&&t&&(this._opts.filename=t),this._opts.filenameRelative||delete this._opts.filenameRelative,this._opts.sourceMaps=this._opts.sourceMap=!0,s.valid(n.version)&&s.gte(n.version,u)&&delete this._opts.sourceMap,this._opts.retainLines=this._opts.retainLines||!1,this._opts.compact=this._opts.compact||!1,this._opts.comments=this._opts.comments!==!1,_.isString(this._opts.plugins)&&(this._opts.plugins=[this._opts.plugins]),this._opts.plugins=(this._opts.plugins||[]).slice(),this._opts.plugins.unshift(new r("wallaby.js",l(_.bind(this._pushRange,this)))),i&&(this._opts.presets=(this._opts.presets||[]).slice(),this._opts.presets.push(i))}return e.prototype._pushRange=function(e){e&&this._ranges.push([e.start.line,e.start.column,e.end.line,e.end.column])},e.prototype.run=function(e){this._ranges=[];var t=n.transformSync||n.transform,i=t(e.content,this._opts);return"ts"!==e.type&&"tsx"!==e.type||!h||e.changeExt("js"),{map:i.map,code:i.code,ranges:this._ranges}},e.prototype.runAsync=function(e,t){var i=this;this._ranges=[],n.transform(e.content,this._opts,function(n,r){n?t(n):("ts"!==e.type&&"tsx"!==e.type||!h||e.changeExt("js"),t({map:r.map,code:r.code,ranges:i._ranges}))})},e}();t.exports=function(t){return function(i){if(i=i||{},process.env.BABEL_ENV&&"undefined"!==process.env.BABEL_ENV||(process.env.BABEL_ENV="test"),a.patchModule("test-exclude",function(){return function(){return{shouldInstrument:_.noop}}}),i.babel)n=i.babel;else{var l=function(){throw new Error("babel, babel-core or @babel/core must be installed locally or babel instance must be passed in opts.babel, for example `wallaby.compilers.babel({ babel: require('@babel/core') })`")};try{var u=e(o.join(t,"package.json")),v=_.find([p,f,"babel-cli",d],function(e){return u.devDependencies[e]||u.dependencies[e]});"babel-cli"===v?n=a.requireModuleFrom(o.join(t,"node_modules/babel-cli"),f):v&&(n=a.requireModuleFrom(t,v))}catch(y){}if(!n)try{n=a.requireModuleFrom(t,p)}catch(m){try{n=a.requireModuleFrom(t,f)}catch(b){try{n=a.requireModuleFrom(t,d)}catch(k){l()}}}}if(s.valid(n.version)&&s.lt(n.version,c))return void console.error("Babel version for compiler must be >= "+c);var T=i.asyncTransform;return r=n.Transformer||function(e,t){return _.each(t,function(e,i){t[i]=function(t){return e(t.node)}}),{visitor:{Program:function(e){e.traverse(t)}}}},h=i.renameTypeScriptFiles!==!1,delete i.babel,delete i.asyncTransform,delete i.renameTypeScriptFiles,function(e,t){var n=e.additionalPreset;if(delete e.additionalPreset,T)new g(i,e.path,n).runAsync(e,t);else try{var r=new g(i,e.path,n).run(e);t(r)}catch(o){t(o)}}}}},{"./babelVisitor":9,"./utils":72,path:void 0,semver:void 0}],9:[function(e,t,i){t.exports=function(e,t){var i={Statement:function(t){switch(t.type){case"DoWhileStatement":case"WhileStatement":case"IfStatement":case"ForStatement":t.test&&e(t.test.loc);break;case"ForOfStatement":case"ForInStatement":t.right&&e(t.right.loc);break;case"SwitchStatement":e(t.discriminant.loc);break;case"BreakStatement":case"ContinueStatement":case"ThrowStatement":case"VariableDeclaration":case"ExpressionStatement":case"ReturnStatement":e(t.loc)}},ArrowFunctionExpression:function(t){t.body&&"BlockStatement"!==t.body.type&&e(t.body.loc)},LogicalExpression:function(t){e(t.left.loc),e(t.right.loc)},ConditionalExpression:function(t){e(t.consequent.loc),e(t.alternate.loc)}};return t&&t.visitImports&&(i.ImportDeclaration=function(t){e(t.loc)}),i}},{}],10:[function(e,t,i){var n=e("path"),r=e("compression"),o=e("graceful-fs"),s=e("express"),a=e("./fileCacheMiddleware"),l=e("./utils"),c=o.readFileSync(n.join(__dirname,"runners","browser","sandbox.html")).toString(),u="__wallaby__",h=logger.create("browserRunner").debug,d=function(e,t){var i=this;i._project=e,i._workerPool=t,i._baseDir=i._project._instrumentedRoot+n.sep,i._initializer=e.settings().bootstrap,i._reportUnhandledPromises=!!e.settings().reportUnhandledPromises,i._throwOnBeforeunload=!!e.settings().throwOnBeforeUnload,i._maxLogEntrySize=e.settings().maxLogEntrySize,i._maxTraceSteps=e.settings().maxTraceSteps,i._resolveGetters=e.settings().resolveGetters,i._logLimits=e.settings().logLimits,i._sandboxHtml={},i._report404AsError=e.settings().env.report404AsError,i._lruCache=i._project._lruCache,i._wallabyFileIdPrefix=i._workerPool.wallabyFileIdPrefix(),i._app=s(),i._app.use(r({filter:function(e){return~e.url.indexOf("____wallaby-bundle")}})),i._app.use("/wallaby_sandbox:id.html",function(e,t){t.send(i._sandboxHtml[e.params.id])}),e.settings().testFramework.path&&i._app.use("/"+u+"/"+e.settings().testFramework.version+"/framework.js",a.create({main:{root:n.join(e._localRoot,e.settings().testFramework.path)}})),i._app.use("/"+u+"/tracer.js",a.create({main:{root:n.join(__dirname,"tracer.js")}})),i._app.use("/"+u,a.create({main:{root:n.join(__dirname,"runners","browser")}})),e.settings().middleware(i._app,s),i._project.isNativeBundler()?i._app.use(a.create({main:{root:i._baseDir,cache:i._lruCache},alt:{root:i._project._localProjectDir,read:function(e,t){var r=l.normalizePath(n.relative(i._project._localProjectDir,e));i._project.idByPath(r)?i._project.getLatestOriginalFileContentByPathAsync(r).then(function(e){return t(null,e)})["catch"](function(e){return t(e)}):t(new Error("File '"+r+"' is not registered."))}}},i._report404AsError)):i._app.use(a.create({main:{root:i._baseDir,cache:i._lruCache}},i._report404AsError))};d.prototype={prepareSandbox:function(e,t,i){var n=this;e.allFilesHash=_.reduce(e.allFiles.concat(e.allTestFiles),function(e,t){return e[t.normalizedRelativePath]={ts:t.ts,id:t.tmp&&t.originalId?t.originalId:t.id},e},{});var r=e.allFiles.concat(e.allTestFiles),o=e.filesToLoad.concat(e.testFilesToLoad),s=_.reduce(e.testFilesToLoad,function(e,t){return e[t.id]=t,e},{});h("Total files to load in sandbox: "+o.length);var a=n._workerPool.receiverPort(),d=l.isWsl()?"localhost":"127.0.0.1";n._anyIncludedEsm=!1;var f=n._project.isNativeBundler();n._sandboxHtml[i]=c.replace("<inject/>",function(){return _.reduce(r,function(e,t){return e+(_.isNumber(t.id)?"file = window.$_$coverage["+t.id+"]=[]; for(i=0, len="+t.rangesLength+"; i < len; i++) file[i] = {};":"")},"<script>(function() {window.$_$receiverPort = "+a+";window.$_$receiverHost = '"+d+"';window.$_$session=\""+t+'";window.$_$baseDir='+JSON.stringify(f?n._project._localProjectDir:n._baseDir)+";window.$_$initialSpecId="+1e5*(i+1)+";window.$_$reportUnhanledPromises="+n._reportUnhandledPromises+";window.$_$throwOnBeforeunload="+n._throwOnBeforeunload+";window.$_$maxLogEntrySize="+n._maxLogEntrySize+";window.$_$maxTraceSteps="+n._maxTraceSteps+";"+(n._resolveGetters?"window.$_$resolveGetters=true;":"")+"window.$_$logLimits="+JSON.stringify(n._logLimits)+";window.$_$traceContext="+JSON.stringify(n._workerPool.traceContext())+";window.$_$coverage=[]; var file, i, len;")+(e.profileRun?"window.$_$profileRun=true;":"")+"window.$_$logsSuppressions="+JSON.stringify(e.logsSuppressions)+";window.$_$slow="+n._project.settings().slowTestThreshold+";window.$_$expressionsToEvaluate="+JSON.stringify(e.expressionsToEvaluate)+";window.$_$files="+JSON.stringify(e.allFilesHash)+";window.$_$tests="+(e.tests?JSON.stringify(e.tests):"null")+";window.$_$testFiles="+JSON.stringify(_.chain(e.allTestFiles).filter(function(e){return!e.shadowed}).map(function(t){return{path:f?t.normalizedRelativePath:t.relativePath,loaded:t.include&&!!s[t.id],id:(e.allFilesHash[t.normalizedRelativePath]||{}).id}}).value())+';})();</script><script src="'+u+'/tracer.js"></script><script src="'+u+"/"+e.framework.version+'/framework.js"></script><script src="'+u+"/"+e.framework.configurator+'/configurator.js"></script><script src="'+u+"/"+e.framework.reporter+'/reporter.js"></script>'+_.reduce(o,function(e,t){n._anyIncludedEsm=n._anyIncludedEsm||t.esm;var i=t.tmp,r=t.ts+(i?t.originalId?n._wallabyFileIdPrefix+t.originalId:"":n._wallabyFileIdPrefix+t.id);switch(t.type){case"js":case"mjs":case"jsx":case"es6":case"es7":return e+"<script "+(t.esm?'type="module"':"")+' src="'+t.normalizedRelativePath+"?"+r+'"></script>';case"html":case"htm":return e+'<link href="'+t.normalizedRelativePath+"?"+t.ts+'" rel="import">';case"css":return e+'<link rel="stylesheet" type="text/css" href="'+t.normalizedRelativePath+"?"+r+'"></link>';default:return e}},"")+(n._initializer&&r.length?"<script>$_$tracer.setInitializeResult(("+n._initializer+")(window.wallaby));</script>":"")+"<script "+(n._anyIncludedEsm?'type="module"':"")+' src="'+u+"/"+e.framework.starter+'/starter.js"></script>'});var p=n.sandboxRootUrl()+"wallaby_sandbox"+i+".html";return h("Sandbox is generated [%s]: %s",n.sandboxName(i,t),p),Q.when(p)},doesSandboxContainESModules:function(){return this._anyIncludedEsm},sandboxRootUrl:function(){return this._sandboxRootUrl?this._sandboxRootUrl:(this._sandboxRootUrl="http://localhost:"+this._workerPool.receiverPort()+"/",this._sandboxRootUrl)},webApp:function(){return this._app},sandboxName:function(e,t){return"worker #"+e+", session #"+t}},t.exports=d},{"./fileCacheMiddleware":42,"./utils":72,compression:void 0,express:void 0,"graceful-fs":void 0,path:void 0}],11:[function(e,t,i){var n,r,o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o.apply(this,arguments)},s=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},l=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},c=function(){function t(t){n=e("chrome-launcher"),r=e("chrome-remote-interface"),this._project=t}return t.prototype.show=function(e,t,i){return s(this,void 0,void 0,function(){var s,c,u,h,d,f,p,g,v,y,m=this;return a(this,function(a){switch(a.label){case 0:return s=["--disable-background-networking","--enable-features=NetworkService,NetworkServiceInProcess","--disable-background-timer-throttling","--disable-backgrounding-occluded-windows","--disable-breakpad","--disable-devTools-side-phishing-detection","--disable-component-extensions-with-background-pages","--disable-default-apps","--disable-dev-shm-usage","--disable-extensions","--disable-features=TranslateUI","--disable-hang-monitor","--disable-ipc-flooding-protection","--disable-popup-blocking","--disable-prompt-on-repost","--disable-renderer-backgrounding","--disable-sync","--force-color-profile=srgb","--metrics-recording-only","--no-first-run","--password-store=basic","--use-mock-keychain","--auto-open-devtools-for-tabs"],this.stop(),this._chrome?[3,2]:(c=this,[4,n.launch({chromeFlags:s,logLevel:"silent"})]);case 1:c._chrome=a.sent(),a.label=2;case 2:return u={port:this._chrome.port,host:"127.0.0.1"},this._startChecking(u),[4,r.List(u)];case 3:return h=a.sent(),d=h.find(function(e){return e.url.startsWith("devtools:")}),f=h.find(function(e){return e.url.startsWith("about:")}),[4,Promise.all([r(o({target:f},u)),r(o({target:d},u))])];case 4:return p=l.apply(void 0,[a.sent(),2]),g=p[0],v=p[1],[4,g.Page.navigate({url:"devtools://devtools/bundled/devtools_app.html"})];case 5:return a.sent(),[4,v.Runtime.evaluate({expression:"\n            const checker = setInterval(() => {\n            if (window.UI && window.UI.viewManager\n              && document.querySelector('.main-tabbed-pane').shadowRoot\n              && document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-right-toolbar')\n              && document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-right-toolbar').shadowRoot\n              && document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-right-toolbar').shadowRoot.querySelector('.largeicon-delete')\n            ) {\n                clearInterval(checker);\n                document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-right-toolbar').shadowRoot.querySelector('.largeicon-delete').click();\n            }\n        }, 5);\n    "})];case 6:return a.sent(),y="pageDataEvent",[4,g.send("Runtime.addBinding",{name:y})];case 7:return a.sent(),g.Runtime.bindingCalled(function(e){var t=e.name,i=e.payload;if(t===y){var n=JSON.parse(i);n&&"link"===n.type&&m._project.navigationRequested(n.href)}}),[4,g.Runtime.evaluate({expression:"\n        const checker = setInterval(async () => {\n            if (window.UI && window.UI.viewManager && document.querySelector('.main-tabbed-pane')\n            && document.querySelector('.main-tabbed-pane').shadowRoot\n            && document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-header')\n            ) {\n                clearInterval(checker);\n                \n                document.title = '"+(process.env.quokka?"Quokka Profile":i)+"';\n                var link = document.querySelector(\"link[rel~='icon']\");\n                if (!link) {\n                    link = document.createElement('link');\n                    link.rel = 'icon';\n                    document.getElementsByTagName('head')[0].appendChild(link);\n                }\n                link.href = '"+(process.env.quokka?"https://quokkajs.com/assets/img/favicon.ico":"https://wallabyjs.com/assets/img/favicon.ico")+"';\n                \n                document.querySelector('.main-tabbed-pane').shadowRoot.querySelector('.tabbed-pane-header').style.display = 'none';\n                var viewManagerInstance = UI.ViewManager && UI.ViewManager.instance() || window.UI.viewManager;\n                await window.UI.viewManager.showView('js_profiler', true);\n                var profilerWidget = viewManagerInstance.materializedWidget('js_profiler');\n                var cpuProfileType = profilerWidget._findProfileTypeByExtension && profilerWidget._findProfileTypeByExtension('.cpuprofile') || profilerWidget;\n                \n                await cpuProfileType.loadFromFile(new File([decodeURIComponent('"+encodeURIComponent(JSON.stringify(e))+"')], '"+t+".cpuprofile'));\n                \n                var profileToLoad = cpuProfileType._profiles && cpuProfileType._profiles[0] || cpuProfileType.selectedProfileType.profiles[0];\n\n                await profilerWidget.showProfile(profileToLoad);\n                \n                var profileView = viewManagerInstance.materializedWidget('js_profiler').visibleView;\n                \n                const selectFlameChart = () => {\n                  if (!profileView.viewSelectComboBox) return setTimeout(() => selectFlameChart(), 10);\n                  profileView.viewSelectComboBox.select(profileView.viewSelectComboBox.options()[0]);\n                  profileView._changeView && profileView._changeView() || profileView.changeView();\n                  profileView.viewSelectComboBox.selectElement().addEventListener('change', () => {\n                    setTimeout(() => {\n                      var allLinks = document.querySelectorAll('.profile-node-file.devtools-link');\n                      for (var i = 0; i < allLinks.length; i++) {\n                        let link = allLinks[i];\n                        if (link.fixed) continue;\n                        let newLink = link.cloneNode(true);\n                        newLink.href = link.href + ':' + link.innerText.split(':').pop();\n                        newLink.fixed = true;\n                        link.parentNode.replaceChild(newLink, link);\n                      }\n                    }, 100);\n                  });\n                };\n                \n                selectFlameChart();\n                \n                window.history.replaceState({}, null, '/"+(process.env.quokka?"quokka":"wallaby")+"');\n                \n                document.addEventListener('click', e => {\n                  if (e && e.srcElement && e.srcElement.href) {\n                    window."+y+"(JSON.stringify({ type: 'link', href: e.srcElement.href }));\n                  } else if (e && e.path && e.path[1]) {\n                    var parent = e.path[1];\n                    var hover = parent.querySelector('.flame-chart-entry-info table');\n                    if (hover && hover.rows) {\n                      window."+y+"(JSON.stringify({ type: 'link', href: 'file://' + hover.rows[3].cells[1].innerHTML }));\n                    }\n                  }                  \n                });\n            }\n        }, 5);\n      "})];case 8:return a.sent(),[2]}})})},t.prototype._startChecking=function(e){var t=this;clearTimeout(this._checker),this._checker=setTimeout(function(){return s(t,void 0,void 0,function(){var t,i;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r.List(e)];case 1:if(t=n.sent(),!t.length)throw new Error("Profile closed");return this._startChecking(e),[3,3];case 2:return i=n.sent(),this.stop(),[3,3];case 3:return[2]}})})},300)},t.prototype.stop=function(){if(clearTimeout(this._checker),this._chrome){try{process.kill(this._chrome.pid)}catch(e){}delete this._chrome}},t}();t.exports=c},{"chrome-launcher":void 0,"chrome-remote-interface":void 0}],12:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();
continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},o=e("child_process").spawn,s=e("chrome-launcher").Launcher,a=e("chrome-remote-interface"),l=e("./runWorkerPool"),c=e("./browserEnvironment"),u=e("net"),h=e("./utils"),d=(e("os"),logger.create("chromeRunner").debug);s.prototype.isDebuggerReady=function(){var e=this;return new Promise(function(t,i){var n;n=h.isWsl()?u.createConnection(e.port,h.wslHostIpAddress()):u.createConnection(e.port),n.once("error",function(t){e.cleanup(n),i(t)}),n.once("connect",function(){e.cleanup(n),t()})})};var f=function(){function t(e){this._screenShotReady=Promise.resolve(),this._profilerStopped=Promise.resolve(),this._project=e;var t=e.settings().env;this._path=t.runner,t.params&&t.params.runner&&(this._flags=t.params.runner.split(" ")),t.keepTabsOpened&&(this._keepTabsOpened=t.keepTabsOpened),this._chromePromise=this._launchChromeInstance(),this._workerPool=new l(this._project,{create:_.bind(this._create,this),recycle:_.bind(this._recycle,this),healthy:function(){return!0},prepare:_.bind(this._prepareTab,this)}),this._browserEnvironment=new c(e,this._workerPool)}return t.prototype.run=function(e){return this._workerPool.run(e)},t.prototype.cancel=function(e){return this._workerPool.cancel(e)},t.prototype.start=function(){return n(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return[4,this._workerPool.start(this._browserEnvironment.webApp())];case 1:return e=t.sent(),this._workerPool.setFileRoot(this._browserEnvironment.sandboxRootUrl()),[2,e]}})})},t.prototype.stop=function(){if(this._workerPool.stop(),this._chrome)try{process.kill(this._chrome.pid)}catch(e){}},t.prototype.mapStack=function(e,t){return this._workerPool._mapStackEntries(e,t)},t.prototype._create=function(e,t){return n(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return[4,this._chromePromise];case 1:return i.sent(),t({workerId:e}),[2]}})})},t.prototype._recycle=function(e){this._closeTab(e)},t.prototype._prepareTab=function(t,i){return n(this,void 0,void 0,function(){var n,o,s,a,l;return r(this,function(r){switch(r.label){case 0:return n=this,o=_.randomId(),s=this._browserEnvironment.sandboxName(i,o),d("Starting sandbox [%s]",s),[4,this._workerPool.getWorker(i)];case 1:return a=r.sent(),this._checkCancelled(),d("Preparing sandbox [%s]",s),[4,this._browserEnvironment.prepareSandbox(t,o,i)];case 2:return l=r.sent(),this._checkCancelled(),d("Prepared sandbox [%s]",s),[2,{name:s,sessionId:o,workerId:i,instance:{resume:function(){n._evaluateOnTab(a.client,function(){$_$tracer.resume()})},ping:function(e){n._evaluateOnTab(a.client,function(){},e)},close:function(e){if(t.profileRun){var i={client:a&&a.client};a&&delete a.client,n._profilerStopped.then(function(e){n._workerPool["worker:profile"](e&&e.profile||{}),n._closeTab(i)})}else if(t.screen){var r={client:a&&a.client};a&&delete a.client,n._screenShotReady.then(function(){n._closeTab(r)})}else n._closeTab(a);e(!0)},closing:function(){try{t.profileRun?n._profilerStopped=a.client.Profiler.stop():t.screen&&(n._screenShotReady=a.client.Page.captureScreenshot().then(function(i){var n=Buffer.from(i.data,"base64");e("fs").writeFileSync(t.screen,n,"base64")}))}catch(i){n._screenShotReady=Promise.resolve(),n._profilerStopped=Promise.resolve()}},start:function(e){a.profileRun=t.profileRun,n._openTab(a,l,function(t){e(t.status)&&n._evaluateOnTab(a.client,"function() {\n              function startTracer() {\n                var counter = 0;\n                var interval = 10; //ms\n                var timeout = 2000; //ms\n                var maxIterations = timeout / interval;\n                if (window.$_$tracer) {\n                  counter++;\n                  $_$tracer.start();\n                } else {\n                  // 2 seconds\n                  if (counter > maxIterations) {\n                    throw new Error('Cannot cannot start tracer in sandbox.');\n                  }\n                  setTimeout(startTracer, 10);\n                }\n              }\n              startTracer();\n            }")})}}}]}})})},t.prototype._checkCancelled=function(){if(this._workerPool.cancelled())throw{runCancelled:!0}},t.prototype._connectionOptions=function(e){void 0===e&&(e={});var t=h.isWsl()?h.wslHostIpAddress():"127.0.0.1";return _.extend({port:this._chrome.port,host:t},e)},t.prototype._evaluateOnTab=function(e,t,i){return void 0===i&&(i=_.noop),n(this,void 0,void 0,function(){var n,o,s,a;return r(this,function(r){switch(r.label){case 0:n="Failed to evaluate code on Chrome Tab:",r.label=1;case 1:return r.trys.push([1,3,,4]),e.Runtime?[4,e.Runtime.evaluate({expression:"("+t.toString()+")()"})]:[2];case 2:return o=r.sent(),s=o.exceptionDetails,s?(this._handleHostError({message:s.exception&&s.exception.description}),d(n+" "+JSON.stringify(s))):i(),[3,4];case 3:return a=r.sent(),d(n+" "+a.message),[3,4];case 4:return[2]}})})},t.prototype._openTab=function(e,t,i){return void 0===i&&(i=_.noop),n(this,void 0,void 0,function(){var n,o,s,l,c,u,h,d,f,p,g,v,y,m=this;return r(this,function(r){switch(r.label){case 0:if(r.trys.push([0,20,,21]),!this._chrome)throw new Error("Chrome is not running");return n=this._connectionOptions({url:t}),[4,a.New(n)];case 1:return o=r.sent(),e.client={target:{id:o.id}},this._checkCancelled(),[4,a({host:n.host,port:n.port,tab:o,target:o.id})];case 2:s=r.sent(),e.client=s,e.client.target={id:o.id},this._checkCancelled(),l=s.Page,c=s.Network,u=s.Profiler,r.label=3;case 3:return r.trys.push([3,18,,19]),h=!!this._browserEnvironment.doesSandboxContainESModules(),d=e.profileRun,f=[l.enable()],h&&f.push(c.enable()),d&&f.push(u.enable()),[4,Promise.all(f)];case 4:if(r.sent(),this._checkCancelled(),!h)return[3,13];c.requestIntercepted(function(e){var t=e.interceptionId,i=e.request;return c.continueInterceptedRequest({interceptionId:t,url:m._updateTrackedFileUrlIfRequired(i.url)})["catch"](function(e){})}),r.label=5;case 5:return r.trys.push([5,7,,12]),[4,s.send("Network.setRequestInterception",{patterns:[{urlPattern:"*"}]})];case 6:return r.sent(),[3,12];case 7:p=r.sent(),r.label=8;case 8:return r.trys.push([8,10,,11]),[4,c.setRequestInterceptionEnabled({enabled:!0})];case 9:return r.sent(),[3,11];case 10:return g=r.sent(),console.warn("Unable to configure network request interception in Chrome"),[3,11];case 11:return[3,12];case 12:this._checkCancelled(),r.label=13;case 13:return[4,l.navigate({url:t})];case 14:return r.sent(),this._checkCancelled(),[4,l.loadEventFired()];case 15:return r.sent(),this._checkCancelled(),d?[4,u.start()]:[3,17];case 16:r.sent(),this._checkCancelled(),r.label=17;case 17:return i({status:"success"}),[3,19];case 18:return v=r.sent(),this._closeTab(e),i({status:"failed: "+(v.message||"unknown")}),[3,19];case 19:return[3,21];case 20:return y=r.sent(),i({status:"failed: "+(y.message||"unknown")}),[3,21];case 21:return[2]}})})},t.prototype._closeTab=function(e){return n(this,void 0,void 0,function(){var t,i;return r(this,function(n){switch(n.label){case 0:if(delete this._screenShotReady,delete this._profilerStopped,!e||!e.client)return[3,6];t=e.client,delete e.client,n.label=1;case 1:return n.trys.push([1,4,,5]),this._keepTabsOpened?[3,3]:[4,a.Close(this._connectionOptions({id:t.target.id}))];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:return i=n.sent(),d("Failed to close Chrome Tab: "+i.message),[3,5];case 5:try{t.close()}catch(r){d("Failed to close Chrome Tab client: "+r.message)}n.label=6;case 6:return[2]}})})},t.prototype._launchChromeInstance=function(){return n(this,void 0,void 0,function(){var t,i,n,a,l;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=["--headless","--disable-gpu","--deterministic-fetch"],i=e("os"),"Linux"!==i.type()||h.isWsl()||(t.push("--no-sandbox"),t.push("--disable-setuid-sandbox")),n=this._flags||t,h.isWsl()&&n.push("--remote-debugging-address="+h.wslHostIpAddress()),a=new s({chromeFlags:n,chromePath:this._path,logLevel:"silent"},{spawn:function(e,t,i){return i.detached=!1,o(e,t,i)}}),[4,a.launch()];case 1:return r.sent(),this._chrome={pid:a.pid,port:a.port,process:a.chrome},[3,3];case 2:return l=r.sent(),this._handleHostError(l),[3,3];case 3:return[2]}})})},t.prototype._updateTrackedFileUrlIfRequired=function(e){if(!e||~e.indexOf("wallabyFileId")||~e.indexOf("__wallaby__"))return e;var t=e;if(t=t.replace(this._browserEnvironment.sandboxRootUrl(),""),t===e)return e;var i=t.lastIndexOf("?");i>=0&&(t=t.substring(0,i));var n=t&&this._project.getFileMetadataByPath(t);return n?e+(~i?"&":"?")+n.changeTs+"&wallabyFileId="+n.id:e},t.prototype._handleHostError=function(e){e=e||{},this._project._cleanStack(e);var t="Chrome runner error: "+(e.message||"unknown"),i=e.stack||t;console.error(i),this._project._emitTestRunError(t)},t}();t.exports=f},{"./browserEnvironment":10,"./runWorkerPool":63,"./utils":72,child_process:void 0,"chrome-launcher":void 0,"chrome-remote-interface":void 0,fs:void 0,net:void 0,os:void 0}],13:[function(e,t,i){"use strict";var n,r,o,s=e("path"),a={},l={},c=function(){function e(e){var t=this;this._opts=_.extend({},e||{}),this._noRename=this._opts.noFileRename,delete this._opts.noFileRename,this._nodeVisitor("Block",function(e){_.each(e.expressions,function(e){e.expression?t._pushRange(e.expression):t._pushRange(e)})}),this._nodeVisitor("Op",function(e){"&&"!==e.operator&&"||"!==e.operator&&"?"!==e.operator||(t._pushRange(e.first),t._pushRange(e.second))})}return e.prototype._nodeVisitor=function(e,t){if(l[e]=t,!a[e]){var i=n[e].prototype.compileNode;n[e].prototype.compileNode=function(){return l[e](this),i.apply(this,arguments)},a[e]=!0}},e.prototype._pushRange=function(e){if(e){var t=e.locationData;t?this._ranges.push([t.first_line+1,t.first_column,t.last_line+1,t.last_column+1]):e.args&&e.args.length&&this._pushRange(e.args[0])}},e.prototype.run=function(e){this._ranges=[];var t=r.compile(e.content,_.extend({},this._opts,{filename:e.path,sourceMap:!0,literate:o.isLiterate(e.path)}));return this._noRename||e.changeExt("js"),{map:t.v3SourceMap,code:t.js,ranges:this._ranges}},e}(),u=function(t,i){try{n=e(s.join(t,i)),r=e(t)}catch(o){return!1}return!0};t.exports=function(e){return function(t){var i=Error.prepareStackTrace;return u(s.join(e,"node_modules","coffeescript"),"lib/coffee-script/nodes")||u(s.join(e,"node_modules","coffee-script"),"lib/coffee-script/nodes")||u(s.join(e,"node_modules","coffeescript"),"lib/coffeescript/nodes")||u("coffee-script","lib/coffee-script/nodes"),Error.prepareStackTrace=i,o=r.helpers,function(e){return new c(t).run(e)}}}},{path:void 0}],14:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__read=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},path=require("path"),os=require("os"),url=require("url"),fs=require("fs"),minimatch=require("minimatch"),semver=require("semver"),utils=require("./utils"),_a=logger.create("config"),debug=_a.debug,trace=_a.trace,supportedTestFrameworks={node:{"mocha@2.1.0":{},"jest@0.4.3":{},"jest@24.8.0":{},"jasmine@2.3.4":{},"ava@1.0.0":{jsPreprocessor:function(e){return e.replace(/import test from ["|']ava["|']/,'var test = require("ava")')}},"tape@4.2.2":{jsPreprocessor:function(e){return e.replace(/import test from ["|']tape["|']/,'var test = require("tape")')}},"vitest@0.14.0":{}},browser:{"jasmine@1.3.1":{},"jasmine@2.1.3":{},"jasmine@2.2.1":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.3.4":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.4.1":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.5.1":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.5.2":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.6.3":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@2.8.0":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@3.2.1":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@3.4.0":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@3.5.0":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@3.6.0":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"jasmine@3.10.0":{configurator:"jasmine@2.1.3",reporter:"jasmine@2.1.3",starter:"jasmine@2.1.3"},"mocha@2.0.1":{},"mocha@2.2.4":{configurator:"mocha@2.0.1",reporter:"mocha@2.0.1",starter:"mocha@2.0.1"},"mocha@3.2.0":{configurator:"mocha@2.0.1",reporter:"mocha@2.0.1",starter:"mocha@2.0.1"},"qunit@1.16.0":{},"qunit@1.18.0":{configurator:"qunit@1.16.0",reporter:"qunit@1.16.0",starter:"qunit@1.16.0"},"qunit@2.4.0":{configurator:"qunit@1.16.0",reporter:"qunit@2.4.0",starter:"qunit@1.16.0"}}},defaultPatterns={typeScript:"**/*.ts?(x)",coffeeScript:"**/*.?(lit)coffee?(.md)"},defaults,Config=function(){function Config(e,t){defaults={files:{ignore:!1,trigger:!0,load:!0},tests:{ignore:!1,trigger:!0,load:!0}};var i=this._localProjectDir=path.dirname(e);this._configFile=e,this._root=t,this._builtinCompilers={coffeeScript:require("./coffeeScriptCompiler")(i),babel:require("./babelCompiler")(i),typeScript:function(e){return e&&e.isolatedModules?require("./typeScriptCompiler")(i)(e):{replaceWithPostprocessor:!0,localProjectDir:i,opts:e}}},this._builtinPostprocessors={typeScript:require("./typeScriptPostprocessor")(i),webpack:require("./postprocessors/webpack/initialize")(i)}}return Config.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var packageJson,wallaby,esmConfig,settings,configFilePath,config_1,cjsErr_1,mjsErr_1,noSettingsFile,autoDetectSettings,availableAutomaticConfigurationProviders,autoDetectedSettings,automaticConfigurationProviders,errors,message_1,filesOrTestsAutoPopulated,files,jestWallabyConfig,tests,jestWallabyConfig_1,isNativeBundler,setup,hooksV2Api,hookFilename,hookPath,isJest,self_1,modulePrototype,compile,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:if(this._settings)return[2,this._settings];packageJson={};try{packageJson=require(path.join(this._localProjectDir,"package.json"))}catch(e){}if(wallaby={localProjectDir:path.dirname(this._configFile)+path.sep,projectCacheDir:this._root,compilers:this._builtinCompilers,postprocessors:this._builtinPostprocessors,override:function(e){return{override:e}},defaults:{files:_.extend({},defaults.files),tests:_.extend({},defaults.tests)}},esmConfig=!1,configFilePath=this._configFile,"auto.detect"===path.basename(configFilePath))return[3,14];_a.label=1;case 1:return _a.trys.push([1,2,,7]),config_1=require(configFilePath),[3,7];case 2:if(cjsErr_1=_a.sent(),process.env.WALLABY_INTEGRATION_TEST_RUN||process.env.WALLABY_UNIT_TEST_RUN)throw cjsErr_1;_a.label=3;case 3:_a.trys.push([3,5,,6]);try{configFilePath=require("url").pathToFileURL(configFilePath)}catch(e){}return[4,eval(_85d‍.c("import(configFilePath)"))];case 4:return config_1=_a.sent(),esmConfig=!0,[3,6];case 5:throw mjsErr_1=_a.sent(),new Error("\nWe have tried both CommonJs require and ESM import to load the config, you may find errors for each attempt below.\n-----------------------------\nCommonJs config loading error\n-----------------------------\n"+cjsErr_1.stack+"\n------------------------------\nES module config loading error\n------------------------------\n"+mjsErr_1.stack);case 6:return[3,7];case 7:return config_1&&(config_1.__esModule||esmConfig)&&config_1["default"]&&(config_1=config_1["default"]),_.isFunction(config_1)?2!==config_1.length?[3,9]:[4,new Promise(function(e){return config_1(wallaby,function(t){return e(t)})})]:[3,12];case 8:return settings=_a.sent(),[3,11];case 9:return settings=config_1(wallaby),settings&&settings.constructor&&"Promise"===settings.constructor.name?[4,settings]:[3,11];case 10:settings=_a.sent(),_a.label=11;case 11:if(!settings)throw new Error("Configuration function did not return an object.");return[3,13];case 12:settings=config_1,_a.label=13;case 13:return void 0!==settings.autoDetect||settings.files&&!_.isFunction(settings.files.override)||settings.test&&!_.isFunction(settings.test.override)||(settings.autoDetect=!0),[3,15];case 14:settings={noSettingsFile:!0},_a.label=15;case 15:return settings.diagnostics=settings.diagnostics||{},settings=this._mergePackageFileSettings(settings,packageJson),settings.debug&&logger.enableDebug(),settings.trace&&logger.enableTrace(),this._settings=settings,noSettingsFile=settings.noSettingsFile,delete settings.noSettingsFile,autoDetectSettings="autoDetect"===(_.isString(settings.testFramework||"")?settings.testFramework:settings.testFramework.type)||settings.testFramework&&settings.testFramework.autoDetected||settings.autoDetect,availableAutomaticConfigurationProviders=_.isArray(settings.autoDetect)?settings.autoDetect:["angular","jest","vitest"],delete settings.autoDetect,autoDetectedSettings={original:void 0,hard:{},soft:{}},noSettingsFile||autoDetectSettings?(noSettingsFile&&(settings.testFramework="autoDetect",autoDetectSettings=!0),settings.env&&settings.env.params&&settings.env.params.env&&_.reduce(settings.env.params.env.split(";"),function(e,t){var i=t.split("="),n=_.trimLeft(i[0]);return e[n]=t.substring(i[0].length+1),e},process.env),automaticConfigurationProviders=__spreadArray([],__read(availableAutomaticConfigurationProviders.map(function(e){switch(e){case"angular":return require("./configurators/angular-cli/configure").configure;case"jest":return require("./configurators/jest/configure").configure;case"vitest":return require("./configurators/vitest/configure").configure}})),!1).filter(function(e){return!!e}),[4,automaticConfigurationProviders.reduce(function(e,t){return __awaiter(_this,void 0,void 0,function(){var i,n,r;return __generator(this,function(o){switch(o.label){case 0:return[4,e];case 1:return i=o.sent(),i.success?[3,3]:[4,t(this._localProjectDir,autoDetectedSettings,settings,packageJson)];case 2:if(n=o.sent(),n.success)return[2,Promise.resolve({success:!0,errors:[]})];n&&n.errors&&(r=i.errors).push.apply(r,__spreadArray([],__read(n.errors),!1)),o.label=3;case 3:return[2,Promise.resolve(i)]}})})},Promise.resolve({success:!1,errors:[]}))]):[3,17];case 16:if(errors=_a.sent().errors,errors.length)throw 1===errors.length?errors[0]:(message_1=""+errors[0].message+os.EOL+os.EOL+"We've also tried to automatically configure Wallaby.js for other frameworks",errors.shift(),errors.forEach(function(e){return message_1+=""+os.EOL+e.message}),new Error(message_1));_a.label=17;case 17:if(filesOrTestsAutoPopulated=!1,settings.files&&!_.isFunction(settings.files.override)||(files=[],filesOrTestsAutoPopulated=!0,settings.testFramework&&"jest"===settings.testFramework.type&&(jestWallabyConfig=settings.testFramework.originalConfig.wallaby,files=_.map(jestWallabyConfig.watchPathIgnorePatterns,function(e){return{pattern:e,regexp:new RegExp(e),ignore:!0}}),files.push({pattern:"**/**"}),jestWallabyConfig.roots.length&&(files=files.concat(_.map(jestWallabyConfig.roots,function(e){return{pattern:e+"/**"}})))),settings.files=settings.files&&_.isFunction(settings.files.override)?settings.files.override(files):files),!_.isArray(settings.files)||!settings.files.length)throw new Error("Files property must be non-empty array of files/file patterns");if(settings.tests&&!_.isFunction(settings.tests.override)||(tests=[],filesOrTestsAutoPopulated=!0,"jest"===settings.testFramework.type&&(jestWallabyConfig_1=settings.testFramework.originalConfig.wallaby,tests=_.map(jestWallabyConfig_1.testPathIgnorePatterns,function(e){return{pattern:e,regexp:new RegExp(e),ignore:!0}}),jestWallabyConfig_1.roots.length&&jestWallabyConfig_1.testMatch.length&&_.every(jestWallabyConfig_1.testMatch,function(e){return _.startsWith(e,"**")})?tests=tests.concat(_.reduce(jestWallabyConfig_1.roots,function(e,t){return e.concat(_.map(jestWallabyConfig_1.testMatch,function(e){return t+"/"+e}))},[])):(jestWallabyConfig_1.testMatch.length&&(tests=tests.concat(_.map(jestWallabyConfig_1.testMatch,function(e){return{pattern:e}}))),jestWallabyConfig_1.testRegex.length&&(tests=tests.concat(_.map(jestWallabyConfig_1.testRegex,function(e){return{pattern:e,regexp:new RegExp(e)}}))))),settings.tests=settings.tests&&_.isFunction(settings.tests.override)?settings.tests.override(tests):tests),!_.isArray(settings.tests)||!settings.tests.length)throw new Error("Tests property must be non-empty array of test files/file patterns");if(settings.filesWithNoCoverageCalculated=settings.filesWithNoCoverageCalculated||[],settings.runAllTestsInAffectedTestFile=settings.runAllTestsInAffectedTestFile||!1,settings.updateNoMoreThanOneSnapshotPerTestFileRun=settings.updateNoMoreThanOneSnapshotPerTestFileRun||!1,void 0!==settings.addModifiedTestFileToExclusiveTestRun)throw settings.addModifiedTestFileToExclusiveTestRun?new Error("addModifiedTestFileToExclusiveTestRun has been deprecated, use smartStart settings instead: \n...\n  smartStart: [\n    { startMode: 'edit' }, // Supported Options: 'edit', 'open', 'never'\n  ],\n...\n"):new Error("addModifiedTestFileToExclusiveTestRun has been deprecated, use smartStart settings instead: \n...\n  smartStart: [\n    { startMode: 'never' },  // Supported Options: 'edit', 'open', 'never'\n  ],\n...\n");if(settings.compilers=settings.compilers||{},!_.isObject(settings.compilers))throw new Error("If defined, compilers property must be an object.");if(isNativeBundler=settings.postprocessor&&settings.postprocessor.bundler&&settings.postprocessor.bundler["native"],isNativeBundler||(settings.compilers[defaultPatterns.coffeeScript]||autoDetectedSettings.hard.noCompilers||(settings.compilers[defaultPatterns.coffeeScript]=this._builtinCompilers.coffeeScript()),autoDetectedSettings.hard.noCompilers||settings.compilers[defaultPatterns.typeScript]||_.find(_.keys(settings.compilers),function(e){return minimatch("a.ts",e)})||settings.noDefaultTypeScriptCompiler||(settings.compilers[defaultPatterns.typeScript]=this._builtinCompilers.typeScript())),this._configureSmartStart(settings),this._configureLogLimits(settings),settings.preprocessors=settings.preprocessors||{},!_.isObject(settings.preprocessors))throw new Error("If defined, preprocessors property must be an object.");if(_.values(settings.preprocessors).length&&autoDetectedSettings.hard.noPreprocessors)throw new Error("Preprocessors cannot be set.");if(settings.postprocessor&&!_.isFunction(settings.postprocessor))throw new Error("Postprocessor must be a function if set");if(settings.testRunComplete&&!_.isFunction(settings.testRunComplete))throw new Error("TestRunComplete hook must be a function if set");if(settings.postprocessor&&autoDetectedSettings.hard.noPostprocessor)throw new Error("Postprocessor cannot be set.");if(isNativeBundler){if(_.values(settings.compilers).length)throw new Error("Compilers cannot be set if built in webpack postprocessor is used.");if(_.values(settings.preprocessors).length)throw new Error("Preprocessors cannot be set if built in webpack postprocessor is used.")}if(autoDetectedSettings.hard.noCompilers||isNativeBundler||this._adjustTypeScriptCompilers(settings),_.isFunction(settings.middleware)||(settings.middleware=_.noop),settings.maxConsoleMessagesPerTest=settings.maxConsoleMessagesPerTest||100,settings.telemetry=settings.telemetry!==!1,settings.autoConsoleLog=settings.autoConsoleLog!==!1,settings.delays=settings.delays||{},settings.delays.run=settings.delays.run||0,settings.delays.run?settings.delays.edit=0:settings.delays.edit=settings.delays.edit||100,settings.delays.update=settings.delays.update||0,settings.workers=settings.workers||{},settings.workers.initial=settings.workers.initial||0,settings.workers.regular=settings.workers.regular||0,_.isBoolean(settings.workers.restart)?settings.workers.recycle=settings.workers.restart:settings.workers.recycle=!!settings.workers.recycle,settings.bootstrap&&settings.setup)throw new Error("The `setup` and `bootstrap` functions are alias of the same setting, so only one of them is allowed in the config.");if(setup=settings.bootstrap||settings.setup,settings.bootstrap=setup&&setup.toString(),delete settings.setup,settings.teardown=settings.teardown&&settings.teardown.toString(),this._normalizeFunction(settings,"bootstrap"),this._normalizeFunction(settings,"teardown"),settings.hints=settings.hints||{},settings.hints.ignoreCoverage=utils.serializeRegExp(settings.hints.ignoreCoverage||/ignore coverage|istanbul ignore/),settings.hints.ignoreCoverageForFile=utils.serializeRegExp(settings.hints.ignoreCoverageForFile||/ignore file coverage/),settings.hints.commentAutoLog=settings.hints.commentAutoLog||"?",settings.hints.testFileSelection=settings.hints.testFileSelection||{},settings.hints.testFileSelection.include=utils.serializeRegExp(settings.hints.testFileSelection.include||/file\.only/),settings.hints.testFileSelection.exclude=utils.serializeRegExp(settings.hints.testFileSelection.exclude||/file\.skip/),settings.automaticTestFileSelection=settings.automaticTestFileSelection!==!1,settings.runSelectedTestsOnly=settings.runSelectedTestsOnly===!0,settings.mapConsoleMessagesStackTrace=settings.mapConsoleMessagesStackTrace===!0,settings.extensions=settings.extensions||{},settings.env||(settings.env=autoDetectedSettings.hard.env||{type:"browser",kind:"chrome"}),!_.isObject(settings.env))throw new Error("Environment is not specified correctly");if(settings.env.type=autoDetectedSettings.hard.env&&autoDetectedSettings.hard.env.type||settings.env.type||"browser",settings.env.params=settings.env.params||{},"browser"===settings.env.type&&(settings.env.kind||(settings.env.kind="chrome")),settings.env.kind&&"phantomjs"!==settings.env.kind&&"electron"!==settings.env.kind&&"chrome"!==settings.env.kind)throw new Error('Specified browser environment kind "'+settings.env.kind+'" is not supported');if("node"!==settings.env.type||settings.env.runner||(settings.env.runner=process.execPath),"electron"===settings.env.kind&&!settings.env.runner)try{try{settings.env.runner=utils.requireModuleFrom(wallaby.localProjectDir,"electron")}catch(ignored){settings.env.runner=utils.requireModuleFrom(wallaby.localProjectDir,"electron-prebuilt")}}catch(e){throw new Error("Electron runner path is not specified and `electron` module was not found.\nEither specify a path in `env.runner` or install the electron module by running `npm install electron --save-dev`")}if("phantomjs"===settings.env.kind&&!settings.env.runner)try{try{settings.env.runner=utils.requireModuleFrom(wallaby.localProjectDir,"phantomjs").path}catch(ignored){settings.env.runner=utils.requireModuleFrom(wallaby.localProjectDir,"phantomjs-prebuilt").path}}catch(e){throw new Error("From June 2019, Wallaby.js no longer ships with PhantomJs version 2.1.1.\nPhantomJs runner path is not specified and neither `phantomjs` nor `phantomjs-prebuilt` modules were found.\nEither specify a path in `env.runner` or install the phantomjs module by running `npm install phantomjs-prebuilt --save-dev`\nRead more in our docs: https://wallabyjs.com/docs/integration/phantomjs2.html ")}return settings.reportUnhandledPromises="node"===settings.env.type?settings.reportUnhandledPromises!==!1:settings.reportUnhandledPromises===!0,"browser"===settings.env.type&&(settings.throwOnBeforeUnload=settings.throwOnBeforeUnload!==!1),settings.env.viewportSize=_.extend({width:800,height:600},settings.env.viewportSize||{}),settings.env.options=_.extend({},settings.env.viewportSize,settings.env.options||{}),settings.env.bundle!==!1&&(settings.env.bundle=!0),settings.testFramework=settings.testFramework||("browser"===settings.env.type?"jasmine@3.10.0":"mocha@2.1.0"),settings.testFramework=this._normalizeTestFramework(settings),settings.env&&"node"===settings.env.type&&settings.env.params&&settings.env.params.runner&&settings.env.params.runner.indexOf("--experimental-vm-modules")!==-1&&settings.testFramework&&settings.testFramework.version&&(settings.env.params.runner.indexOf("--experimental-loader")===-1&&(hooksV2Api=semver.gte(process.versions.node,"17.0.0")||semver.gte(process.versions.node,"16.12.0")&&semver.lt(process.versions.node,"17.0.0")||semver.gte(process.versions.node,"14.999.999")&&semver.lt(process.versions.node,"15.0.0")||semver.gte(process.versions.node,"12.999.999")&&semver.lt(process.versions.node,"13.0.0"),hookFilename=hooksV2Api?"hooks-v2.mjs":"hooks.mjs",hookPath=path.join(path.dirname(process.mainModule.filename),"runners/node/"+settings.testFramework.version+"/"+hookFilename),fs.existsSync(hookPath)&&(settings.env.params.runner+=' --experimental-loader "'+url.pathToFileURL(hookPath)+'"')),settings.env.params.runner.indexOf("--experimental-loader")!==-1&&delete settings.testFramework.jsPreprocessor),_.values(settings.compilers).length&&(wallaby.defaults&&wallaby.defaults.files&&wallaby.defaults.files.instrument!==!1&&(wallaby.defaults.files.instrument=!0),wallaby.defaults&&wallaby.defaults.tests&&wallaby.defaults.tests.instrument!==!1&&(wallaby.defaults.files.instrument=!0),defaults.files.instrument=!0,defaults.tests.instrument=!0),settings.files=_.map(settings.files,this._normalizeFileObject.bind(this,wallaby.defaults&&wallaby.defaults.files||_.extend({},defaults.files))),settings.tests=_.map(settings.tests,this._normalizeFileObject.bind(this,wallaby.defaults&&wallaby.defaults.tests||_.extend({},defaults.tests))),filesOrTestsAutoPopulated&&_.each(_.filter(settings.tests,function(e){return!e.ignore}),function(e){if(!_.find(settings.files,function(t){return t.ignore&&t.pattern===e.pattern})){var t=_.clone(e);t.ignore=!0,settings.files.push(t)}}),settings.slowTestThreshold=settings.slowTestThreshold||75,settings.lowCoverageThreshold=settings.lowCoverageThreshold||80,isJest=0===settings.testFramework.version.indexOf("jest"),
settings.loose=isJest||isNativeBundler,isJest||"node"!==settings.env.type||void 0===settings.symlinkNodeModules&&(settings.symlinkNodeModules="module"===packageJson.type||void 0),isJest&&!autoDetectSettings&&(_.find(settings.files,function(e){return e&&_.endsWith(e.pattern,".snap")})||(self_1=this,_.each(settings.tests,function(e){e&&e.pattern&&settings.files.push(self_1._normalizeFileObject({ignore:e.ignore,instrument:!1,trigger:!0,load:!0},e.pattern+".snap"))})),_.find(settings.files,function(e){return e&&"package.json"===e.pattern})||settings.files.push(this._normalizeFileObject({ignore:!1,instrument:!1,trigger:!0,load:!0},"package.json")),_.isEmpty(settings.preprocessors)||(modulePrototype=require("module").Module.prototype,compile=modulePrototype._compile,modulePrototype._compile=function(e,t){if(t&&~t.indexOf("babel-plugin-jest-hoist")&&e){var i=e.replace("if (!expr.isCallExpression())",'if(expr.isSequenceExpression()){const expressions = expr.get("expressions");if (!expressions || expressions.length !== 2) return false;expr = expressions[1];}if (!expr.isCallExpression())');i===e&&console.warn("Initialization of babel-plugin-jest-hoist preset has failed."),arguments[0]=i}return compile.apply(this,arguments)},global.$_$w||(global.$_$w=global.$_$w_=global.$_$wf=global.$_$wv=global.$_$tracer=!0)),settings.preprocessors&&!settings.preprocessors["package.json"]&&(settings.preprocessors["package.json"]=function(e){var t=JSON.parse(e.content);return delete t.babel,JSON.stringify(t)})),[2,settings]}})})},Config.prototype._normalizeFunction=function(e,t){if(e[t]&&0!==e[t].indexOf("function")&&0!==e[t].indexOf("async function")){var i="async";0===e[t].indexOf(i)?e[t]="async function "+e[t].substr(i.length):e[t]="function "+e[t];var n=e[t].split("\n")[0],r=n.indexOf("=>"),o=n.indexOf("{");if(r>0&&(o===-1||r<o)&&(e[t]=e[t].replace("=>","{")+"}"),r>0&&n.indexOf("(")<0){n=e[t].split("\n")[0];var s=n.indexOf("{"),a=n.substring("function ".length,s);e[t]=e[t].replace(a,"("+a+")")}}},Config.prototype._configureLogLimits=function(e){var t={inline:{depth:5,elements:5e3},values:{"default":{stringLength:200},autoExpand:{elements:5e3,stringLength:8192,depth:10}}},i=function(e,t){if(t=t||[],_.isObject(e)){var n=[];return Object.keys(e).forEach(function(r){i(e[r],__spreadArray(__spreadArray([],__read(t),!1),[r],!1)).filter(function(e){return!!e}).forEach(function(e){return n.push(e)})}),n}return[t]},n=i(t),r=function(e,t){for(var i=e,n=0;n<t.length;n++){var r=t[n];if(i[r]){if(!_.isObject(i[r]))throw new Error(t.join(".")+" property must be an object.")}else i[r]={};i=i[r]}},o=function(i){for(var n=e.logLimits,r=t,o=0;o<i.length-1;o++)n=n[i[o]],r=r[i[o]];if(n[i[i.length-1]]){if(!_.isNumber(n[i[i.length-1]]))throw new Error("logLimits."+i.join(".")+" property must be numeric.");if(n[i[i.length-1]]<=0)throw new Error("logLimits."+i.join(".")+" property must be greater than zero.")}else n[i[i.length-1]]=r[i[i.length-1]]};n.forEach(function(t){var i=__spreadArray(["logLimits"],__read(t.slice(0,-1)),!1);r(e,i),o(t)})},Config.prototype._configureSmartStart=function(e){if(e.smartStart){if(!_.isArray(e.smartStart))throw new Error("smartStart property must be an array of options");if(0===e.smartStart.length)throw new Error("smartStart array must contain at least one option.");e.smartStart=e.smartStart.map(function(e){var t={};if(!_.isObject(e))throw new Error("smartStart option must be an object.");if(e.test){if(!_.isBoolean(e.test))throw new Error("smartStart option.test must be a boolean.");t.test=e.test}if(e.source)throw new Error("smartStart option.source is not a supported option.");if(t.source=!1,void 0!==t.test||t.source||(t.test=!0),e.pattern){if(!_.isString(e.pattern))throw new Error("smartStart option.pattern must be a string.");t.pattern=e.pattern}else t.pattern="**/*";if(e.path){if(e.pattern)throw new Error("smartStart only one of option.path and option.pattern may be specified.");if(!_.isString(e.path))throw new Error("smartStart option.path must be a string.");t.path=e.path}if(e.startMode){var i=["always","never","edit","open"];if(!i.find(function(t){return e.startMode===t}))throw new Error("smartStart option.pattern must one of ["+i.join(", ")+"].");t.startMode=e.startMode}return t})}else e.smartStart=[];e.smartStart.push({test:!0,source:!1,pattern:"**/*",startMode:"open"}),e.smartStart.push({test:!1,source:!0,pattern:"**/*",startMode:"edit"})},Config.prototype._normalizeTestFramework=function(e){var t=supportedTestFrameworks[e.env.type];if(!t)throw new Error("Environment ["+e.env.type+"] is not supported");var i=this._resolveTestFrameworkVersion(e,t),n=_.extend({version:i,configurator:i,reporter:i,starter:i},t[i]);return e.testFramework.path&&(n.path=e.testFramework.path),e.testFramework.configFile&&(n.configFile=e.testFramework.configFile),e.testFramework.autoDetected&&(n.autoDetected=!0,delete n.originalConfig),n},Config.prototype._resolveTestFrameworkVersion=function(e,t){var i=_.isString(e.testFramework)?e.testFramework:e.testFramework.type;if("jest"!==i||e.testFramework.autoDetected||(i+="@0.4.3"),~i.indexOf("@")){if(!t[i])throw new Error("Test framework ["+i+"] is not supported");return i}var n={};_.each(t,function(e,t){var i=t.substr(0,t.indexOf("@"));n[i]=t});var r=n[i];if(!r)throw new Error("Test framework ["+i+"] is not supported");return r},Config.prototype._adjustTypeScriptCompilers=function(e){var t=!!e.postprocessor,i={files:{}};if(_.each(e.compilers,function(n,r){n&&n.replaceWithPostprocessor&&(i.postprocessor=n.postprocessor,delete e.compilers[r],t&&(n.opts=n.opts||{}),i.files[r]=n.opts,n.opts&&n.opts.typescript&&(i.typescript=n.opts.typescript,delete n.opts.typescript))}),!_.isEmpty(i.files)){var n=i.postprocessor||this._builtinPostprocessors.typeScript(i);t?e.postprocessor=[n,e.postprocessor]:e.postprocessor=n}},Config.prototype._normalizeFileObject=function(e,t){if(_.isString(t))t={pattern:t};else if(!t.pattern)throw new Error("File/test entry must either be a string or an object that contains pattern property");var i=_.defaults(t,e);return i.regexp||("!"===i.pattern[0]&&(i.ignore=!i.ignore,i.pattern=i.pattern.substring(1)),"/"===i.pattern[0]&&(i.pattern=i.pattern.substring(1)),"."===i.pattern[0]&&"/"===i.pattern[1]&&(i.pattern=i.pattern.substring(2))),i},Config.prototype._mergePackageFileSettings=function(e,t){return t&&t.wallaby?_.merge(t.wallaby,e):e},Config}(),config;module.exports=function(e,t,i){var n=void 0===i?{}:i,r=n.forceUpdate;return config&&!r?config.load():(config=new Config(e,t),config.load())}},{"./babelCompiler":8,"./coffeeScriptCompiler":13,"./configurators/angular-cli/configure":15,"./configurators/jest/configure":35,"./configurators/vitest/configure":37,"./postprocessors/webpack/initialize":51,"./typeScriptCompiler":68,"./typeScriptPostprocessor":69,"./utils":72,fs:void 0,minimatch:void 0,module:void 0,os:void 0,path:void 0,semver:void 0,url:void 0}],15:[function(e,t,i){function n(t,i,n,s){return r(this,void 0,void 0,function(){var r,l,h,y,m,_,b,k,T,S,C,L,j,w,x,F,E,R,I,M,O,P,q,N,A,b,R,O,q,A,D,B;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,30,,31]),f("Detecting Angular CLI."),r=e("./detect"),[4,r(t)];case 1:if(l=o.sent()||{},h=l.path,y=l.type,m=l.content,!h)return d("Angular CLI not found."),[2,{success:!1,errors:[]}];d("Detected Angular CLI."),n.diagnostics.angular={workspace:m},o.label=2;case 2:if(o.trys.push([2,28,,29]),!m.version||!Object.keys(m.projects||{}).length)throw new Error("'"+h+"' is not a valid Angular CLI file.");if("nx"===y&&m.projects){e("./modulePatch");for(_ in m.projects)b=m.projects[_],b.targets&&b.targets.test&&(b.architect=b.targets,b.targets.test.executor&&(b.targets.test.builder=b.targets.test.executor))}return k=a.dirname(h),T=void 0,S=void 0,"ng"!==y&&"nx"!==y?[3,4]:(C=a.join(k,"node_modules","@angular","cli","package.json"),[4,u(C)]);case 3:if(o.sent()){if(L=e(a.resolve(C)),T=L.version,!c.valid(T)||c.lt(T,p))throw new Error("Only Angular CLI v"+p+" or higher is supported.")}else if("ng"===y)throw new Error("Cannot detect @angular/cli package version, is the package installed?");o.label=4;case 4:return"nx"!==y?[3,6]:(j=a.join(k,"node_modules","@nrwl","workspace","package.json"),[4,u(j)]);case 5:if(!o.sent())throw new Error("Cannot detect @nrwl/workspace package version, is the package installed?");if(w=e(a.resolve(j)),S=w.version,!c.valid(S)||c.lt(S,g))throw new Error("Only @nrwl/workspace v"+g+" or higher is supported.");o.label=6;case 6:if(d('Angular currentDirPath: "%s", workspaceDirPath: "%s"',t,k),t!==k)return[3,21];if(x=Object.keys(m.projects).map(function(e){return{name:e,configuration:m.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&("@angular-devkit/build-angular:karma"===e.configuration.architect.test.builder||"@angular-builders/custom-webpack:karma"===e.configuration.architect.test.builder)}),F=Object.keys(m.projects).map(function(e){return{name:e,configuration:m.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&"@angular-builders/jest:run"===e.configuration.architect.test.builder}),E=Object.keys(m.projects).map(function(e){return{name:e,configuration:m.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&"@nrwl/jest:jest"===e.configuration.architect.test.builder}),!x.length&&!F.length&&!E.length)throw new Error("None of your projects are configured with `@angular-devkit/build-angular:karma`, `@angular-builders/custom-webpack:karma`, `@angular-builders/jest:run`, or `@nrwl/jest:jest` builders as their test architect.");return x.length&&T?(R=c.major(T),I=c.minor(T),x.length>1?(M=e(8===R?"./karma/v8/WorkspaceConfigurator":R<12?"./karma/v9/WorkspaceConfigurator":R<13?"./karma/v12/WorkspaceConfigurator":R<14?I<1?"./karma/v13/WorkspaceConfigurator":"./karma/v13.1/WorkspaceConfigurator":"./karma/v13.1/WorkspaceConfigurator"),[4,new M(k,h,m,T).configure(n)]):[3,8]):[3,11];case 7:return o.sent(),[3,10];case 8:return O=e(8===R?"./karma/v8/ProjectConfigurator":R<12?"./karma/v9/ProjectConfigurator":R<13?"./karma/v12/ProjectConfigurator":R<14?I<1?"./karma/v13/ProjectConfigurator":"./karma/v13.1/ProjectConfigurator":"./karma/v13.1/ProjectConfigurator"),[4,new O(k,h,m,x[0]).configure(!0,n)];case 9:o.sent(),o.label=10;case 10:return[3,20];case 11:return F.length?F.length>1?(P=e("./v8-jest/WorkspaceConfigurator"),[4,new P(t,i,n,s,k,m).configure()]):[3,13]:[3,16];case 12:return o.sent(),[3,15];case 13:return q=e("./v8-jest/ProjectConfigurator"),[4,new q(t,i,n,s,k,F[0]).configure()];case 14:o.sent(),o.label=15;case 15:return[3,20];case 16:return E.length?E.length>1?(N=e("./v8-nrwl-jest/WorkspaceConfigurator"),[4,new N(t,i,n,s,k,m).configure()]):[3,18]:[3,20];case 17:return o.sent(),[3,20];case 18:return A=e("./v8-nrwl-jest/ProjectConfigurator"),[4,new A(t,i,n,s,k,E[0]).configure()];case 19:o.sent(),o.label=20;case 20:return[3,27];case 21:if(b=Object.keys(m.projects).map(function(e){return{name:e,configuration:m.projects[e]}}).find(function(e){return a.resolve(a.join(k,e.configuration.root))===t}),!b)throw new Error("A project for '"+t+"' directory cannot be detected.");if(!b.configuration.architect||!b.configuration.architect.test||"@angular-devkit/build-angular:karma"!==b.configuration.architect.test.builder&&"@angular-builders/jest:run"!==b.configuration.architect.test.builder&&"@nrwl/jest:jest"!==b.configuration.architect.test.builder)throw new Error("The project "+b.name+" is not configured with `@angular-devkit/build-angular:karma`, `@angular-builders/jest:run`, or `@nrwl/jest:jest` builder as its test architect.");return"@angular-devkit/build-angular:karma"!==b.configuration.architect.test.builder&&"@angular-builders/custom-webpack:karma"!==b.configuration.architect.test.builder?[3,23]:(R=c.major(T),O=e(8===R?"./karma/v8/ProjectConfigurator":R<12?"./karma/v9/ProjectConfigurator":R<13?"./karma/v12/ProjectConfigurator":R<14?I<1?"./karma/v13/ProjectConfigurator":"./karma/v13.1/ProjectConfigurator":"./karma/v13.1/ProjectConfigurator"),[4,new O(k,h,m,b).configure(!1,n)]);case 22:return o.sent(),[3,27];case 23:return"@angular-builders/jest:run"!==b.configuration.architect.test.builder?[3,25]:(q=e("./v8-jest/ProjectConfigurator"),[4,new q(t,i,n,s,k,b).configure()]);case 24:return o.sent(),[3,27];case 25:return"@nrwl/jest:jest"!==b.configuration.architect.test.builder?[3,27]:!c.valid(S)||c.gt(S,v)?(delete n.diagnostics.angular,d("@nrwl/workspace v"+v+" and higher uses jest automatic configuration."),[2,{success:!1,errors:[]}]):(A=e("./v8-nrwl-jest/ProjectConfigurator"),[4,new A(t,i,n,s,k,b).configure()]);case 26:o.sent(),o.label=27;case 27:return[2,{success:!0,errors:[]}];case 28:throw D=o.sent(),d(D),d("Angular.json: \n %O",m),D;case 29:return[3,31];case 30:return B=o.sent(),d(B),[2,{success:!1,errors:[new Error("Automatic Angular CLI configuration error: "+B.message)]}];case 31:return[2]}})})}var r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=e("util"),a=e("path"),l=e("fs"),c=e("semver"),u=s.promisify(l.exists),h=logger.create("angular/cli config"),d=h.debug,f=h.trace,p="8.2.0",g="8.0.0",v="11.1.4";t.exports={configure:n}},{"./detect":16,"./karma/v12/ProjectConfigurator":17,"./karma/v12/WorkspaceConfigurator":18,"./karma/v13.1/ProjectConfigurator":19,"./karma/v13.1/WorkspaceConfigurator":20,"./karma/v13/ProjectConfigurator":21,"./karma/v13/WorkspaceConfigurator":23,"./karma/v8/ProjectConfigurator":24,"./karma/v8/WorkspaceConfigurator":25,"./karma/v9/ProjectConfigurator":27,"./karma/v9/WorkspaceConfigurator":28,"./modulePatch":29,"./v8-jest/ProjectConfigurator":30,"./v8-jest/WorkspaceConfigurator":31,"./v8-nrwl-jest/ProjectConfigurator":32,"./v8-nrwl-jest/WorkspaceConfigurator":33,fs:void 0,path:void 0,semver:void 0,util:void 0}],16:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},o=e("util"),s=e("path"),a=e("fs"),l=e("../../utils"),c="angular.json",u="workspace.json",h="nx.json",d=o.promisify(a.exists);t.exports=function(t){return n(void 0,void 0,void 0,function(){var i,o,a;return r(this,function(f){switch(f.label){case 0:return i=s.parse(t).root,o=function(t,i){return n(void 0,void 0,void 0,function(){var n,o,a,c,u,h;return r(this,function(r){if("nx"===i)try{if(n=e(t),2===n.version&&(o=s.dirname(t),a=l.tryRequireModuleWithPathFrom(o,"@nrwl/tao/src/shared/workspace",!1),a&&a.module))return c=new a.module.Workspaces(o),u=(0,a.module.resolveOldFormatWithInlineProjects)(c.readWorkspaceConfiguration()),u.configFileName=t,u.nxWorkspace=!0,[2,{path:t,type:i,content:u}]}catch(d){}return h=e(t),[2,{path:t,type:i,content:h}]})})},a=t,[4,d(s.join(a,h))];case 1:return f.sent()?[4,d(s.join(a,c))]:[3,5];case 2:return f.sent()?[2,o(s.join(a,c),"nx")]:[3,3];case 3:return[4,d(s.join(a,u))];case 4:if(f.sent())return[2,o(s.join(a,u),"nx")];f.label=5;case 5:return[4,d(s.join(a,c))];case 6:if(f.sent())return[2,o(s.join(a,c),"ng")];f.label=7;case 7:return a===i?[2,void 0]:(a=s.resolve(a,".."),[4,d(s.join(a,h))]);case 8:return f.sent()?[4,d(s.join(a,c))]:[3,12];case 9:return f.sent()?[2,o(s.join(a,c),"nx")]:[3,10];case 10:return[4,d(s.join(a,u))];case 11:if(f.sent())return[2,o(s.join(a,u),"nx")];f.label=12;case 12:return[4,d(s.join(a,c))];case 13:return f.sent()?[2,o(s.join(a,c),"ng")]:[3,7];case 14:return[2]}})})}},{"../../utils":72,fs:void 0,path:void 0,util:void 0}],17:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("../v9/ProjectConfigurator"),o=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getTypeScriptConfig,r=e.getStylesConfig,o=e.getTestConfig,s=e.getWorkerConfig;return[i(t),r(t),n(t),o(t),s(t)]},t.prototype._adjustPostprocessor=function(e){var t=e._prepareCompiler.bind(e);e._prepareCompiler=function(e,i,n,r,o){o.watchMode=!0,t(e,o)}},t.prototype._adjustPlugins=function(e){var t="zone.js/testing fix: https://github.com/angular/angular/issues/42260";e.push({apply:function(e){e.hooks.normalModuleFactory.tap(t,function(e){e.hooks.createModule.tap(t,function(e){"zone.js/testing"!==e.rawRequest&&"zone.js/dist/zone-testing"!==e.rawRequest||e.resourceResolveData&&(e.resourceResolveData.patch=function(e){return e.replace("instance.install = function () {","instance.install = function () { var process = {listeners: function(){},removeAllListeners: function(){}};")})})})}})},t.prototype._getZoneImportStatement=function(){return"import 'zone.js';"},t.prototype._getZoneTestingImportStatement=function(){return"import 'zone.js/testing';"},t.prototype._getAllLoaders=function(e){var t=e.filter(function(e){return e.rules}).map(function(e){return e.rules}).flat(),i=e.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),n=t.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),r=t.filter(function(e){return e.oneOf}).map(function(e){return e.oneOf}).flat().filter(function(e){return e.use}).map(function(e){return e.use}).flat();return _.union(i,n,r)},t}(r);t.exports=o},{"../v9/ProjectConfigurator":27}],18:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},s=e("path"),a=e("semver"),l=e("lodash"),c=e("../v9/WorkspaceConfigurator"),u=e("../../../../utils"),h=logger.create("angular/cli karma workspace config").trace,d=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getTypeScriptConfig,r=e.getStylesConfig,o=e.getTestConfig,s=e.getWorkerConfig;return[i(t),r(t),n(t),o(t),s(t)]},t.prototype._adjustPostprocessor=function(e,t,i,n,r){var o=e._prepareCompiler.bind(e),s=!1,a=function(){var e=r(),t=e.lstat,o=e.readFile;e.readFile=function(e){return e===i?n:o(e)},e.lstat=function(e){return e===i?{isDirectory:function(){return!1}}:t(e)}};e._prepareCompiler=function(e,i,n,r,l){l.watchMode=!0,o(e,l),e?t&&(s||(a(),s=!0)):t&&a()}},t.prototype._adjustPlugins=function(e){var t="zone.js/testing fix: https://github.com/angular/angular/issues/42260";e.push({apply:function(e){e.hooks.normalModuleFactory.tap(t,function(e){e.hooks.createModule.tap(t,function(e){"zone.js/testing"!==e.rawRequest&&"zone.js/dist/zone-testing"!==e.rawRequest||e.resourceResolveData&&(e.resourceResolveData.patch=function(e){return e.replace("instance.install = function () {","instance.install = function () { var process = {listeners: function(){},removeAllListeners: function(){}};")})})})}})},t.prototype._deduplicateMainFileContent=function(e){var t=/import\s*'zone\.js'\s*;/,i=/import\s*'zone\.js\/testing'\s*;/,n=/import\s*{\s*getTestBed\s*}\s*from\s*'@angular\/core\/testing'\s*;/,r=/declare\s+const\s+require\s*:\s*any\s*;/,o=/declare\s*const\s*require\s*:\s*{\s*context\s*\(\s*path\s*:\s*string\s*,\s*deep\?\s*:\s*boolean\s*,\s*filter\?\s*:\s*RegExp\s*\)\s*:\s*{\s*keys\s*\(\s*\)\s*:\s*string\s*\[\s*]\s*;\s*<\s*T\s*>\s*\(\s*id\s*:\s*string\s*\)\s*:\s*T\s*;\s*}\s*;\s*}\s*;/,s=/declare\s*const\s*require\s*:\s*{\s*context\s*\(\s*path\s*:\s*string\s*,\s*deep\?\s*:\s*boolean\s*,\s*filter\?\s*:\s*RegExp\s*\)\s*:\s*{\s*<\s*T\s*>\s*\(\s*id\s*:\s*string\s*\)\s*:\s*T\s*;\s*keys\s*\(\s*\)\s*:\s*string\s*\[\s*]\s*;\s*}\s*;\s*}\s*;\s*/,a=/import\s*{\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting,?\s*}\s*from\s*'@angular\/platform-browser-dynamic\/testing'\s*;/,l=/getTestBed\s*\(\s*\)\s*.\s*initTestEnvironment\s*\(\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting\s*\(\s*\)\s*,?\s*\)\s*;/,c=/getTestBed\s*\(\s*\)\s*.\s*initTestEnvironment\s*\(\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting\s*\(\s*\),\s*{\s*teardown\s*:\s*{\s*destroyAfterEach\s*:\s*true\s*}\s*,?\s*}\s*,?\s*\)\s*;/,u=/getTestBed\s*\(\s*\)\s*.\s*initTestEnvironment\s*\(\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting\s*\(\s*\),\s*{\s*teardown\s*:\s*{\s*destroyAfterEach\s*:\s*false\s*}\s*,?\s*}\s*,?\s*\)\s*;/;return e.replace(t,"").replace(i,"").replace(n,"").replace(r,"").replace(o,"").replace(s,"").replace(a,"").replace(l,"").replace(c,"").replace(u,"")},t.prototype._fixStyleRules=function(e,t){var i,n,a,c,d,f,p,g,v,y,m=this;if(h("Sanitizing style rules."),t.module&&t.module.rules){var _=t.module.rules,b=_.filter(function(e){return e.rules}).map(function(e){return e.rules}).flat(),k=_.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),T=b.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),S=b.filter(function(e){return e.oneOf}).map(function(e){return e.oneOf}).flat().filter(function(e){return e.use}).map(function(e){return e.use}).flat(),C=l.union(k,T,S);try{for(var L=r(C),j=L.next();!j.done;j=L.next()){var w=j.value;"string"!=typeof w&&w.options&&(this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"postcss-loader")||this._checkCssLoader(w.loader,"resolve-url-loader"))&&(w.options.sourceMap=!1)}}catch(x){i={error:x}}finally{try{j&&!j.done&&(n=L["return"])&&n.call(L)}finally{if(i)throw i.error}}for(var F=new Map,E=0;E<_.length;E++){var R=_[E],I=R.rules?R.rules:[],M=2===I.length&&I[0].oneOf&&I[0].oneOf.length&&I[1].use&&!I[1].use.length?I[0].oneOf.filter(function(e){return e.use}).map(function(e){return e.use}).flat():I.filter(function(e){return e.use}).map(function(e){return e.use}).flat();if(!R.mimetype&&M.length){var w=M[M.length-1];"string"!=typeof w&&(this._checkCssLoader(w.loader,"sass-loader")||this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"stylus-loader")||this._checkCssLoader(w.loader,"postcss-loader"))&&F.set(E,R)}}var O=0;try{for(var P=r(F),q=P.next();!q.done;q=P.next()){var N=o(q.value,1),A=N[0];_.splice(A-O,1),O++}}catch(D){a={error:D}}finally{try{q&&!q.done&&(c=P["return"])&&c.call(P)}finally{if(a)throw a.error}}var B=new Map;try{for(var U=r(F),V=U.next();!V.done;V=U.next()){var Q=o(V.value,2),R=Q[1];if(R.test){var H={test:R.test,rules:[]};B.has(R.test.toString())?H=B.get(R.test.toString()):(H.rules.push({oneOf:[]}),H.rules.push({oneOf:[]}),B.set(R.test.toString(),H));var z=H.rules[0],W=H.rules[1],K=R.rules[0],J=R.rules[1],G=function(e,t,i){var n,o;e.type&&(t.type=e.type),e.resourceQuery&&(t.resourceQuery=e.resourceQuery);try{for(var a=(n=void 0,r(e.use)),l=a.next();!l.done;l=a.next()){var c=l.value;if("string"!=typeof c){var h=m._copyCssLoader(c);if(h.options){var d=i&&i.length?i.map(function(e){return u.normalizePath(s.resolve(s.join(m._workspaceDirPath,e)))}):null;m._setCssLoaderOptionsPaths(h,d)}t.use.push(h)}else t.use.push(c)}}catch(f){n={error:f}}finally{try{l&&!l.done&&(o=a["return"])&&o.call(a)}finally{if(n)throw n.error}}},Y=function(t){var i,n,o,a,l=null;if(t.configuration.architect.test.options){var c=t.configuration.architect.test.options.stylePreprocessorOptions;if(c&&c.includePaths){l=[];try{for(var u=(i=void 0,r(c.includePaths)),h=u.next();!h.done;h=u.next()){var d=h.value;l.push(d)}}catch(f){i={error:f}}finally{try{h&&!h.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}}}var p=[];e.filter(function(e){return e.name!==t.name}).forEach(function(e){var t=s.resolve(s.join(m._workspaceDirPath,e.configuration.root));l&&l.length?l.some(function(e){return s.resolve(s.join(m._workspaceDirPath,e)).startsWith(t)})||p.push(t):p.push(t),(e.configuration.architect.test.options.styles||[]).forEach(function(e){return p.push(s.resolve(s.join(m._workspaceDirPath,"string"==typeof e?e:e.input)))})});var g=t.configuration.architect.test.options.styles||[],v=!0,y=function(e){var t={use:[]};if(G(e,t,l),v)v=!1,t.exclude=[],g.forEach(function(e){return t.exclude.push(s.resolve(s.join(m._workspaceDirPath,"string"==typeof e?e:e.input)))}),p.forEach(function(e){return t.exclude.push(e)});else{if(!g.length)return"continue";t.include=[],g.forEach(function(e){return t.include.push(s.resolve(s.join(m._workspaceDirPath,"string"==typeof e?e:e.input)))})}t.use.length&&z.oneOf.push(t)};try{for(var _=(o=void 0,r(K.oneOf)),b=_.next();!b.done;b=_.next()){var k=b.value;y(k)}}catch(T){o={error:T}}finally{try{b&&!b.done&&(a=_["return"])&&a.call(_)}finally{if(o)throw o.error}}var S={use:[]};G(J,S,l),S.exclude=[],p.forEach(function(e){return S.exclude.push(e)}),S.use.length&&W.oneOf.push(S)};try{for(var X=(p=void 0,r(e)),Z=X.next();!Z.done;Z=X.next()){var $=Z.value;Y($)}}catch(ee){p={error:ee}}finally{try{Z&&!Z.done&&(g=X["return"])&&g.call(X)}finally{if(p)throw p.error}}var te=K.oneOf[0],ie={use:[]};G(te,ie),ie.use.length&&z.oneOf.push(ie),te=J;var ne={use:[]};G(te,ne,null),ne.use.length&&W.oneOf.push(ne)}}}catch(re){d={error:re}}finally{try{V&&!V.done&&(f=U["return"])&&f.call(U)}finally{if(d)throw d.error}}try{for(var oe=r(B),se=oe.next();!se.done;se=oe.next()){var ae=o(se.value,2),H=ae[1];_.push(H)}}catch(le){v={error:le}}finally{try{se&&!se.done&&(y=oe["return"])&&y.call(oe)}finally{if(v)throw v.error}}}},t.prototype._getZoneImportStatement=function(){return"import 'zone.js';"},t.prototype._getZoneTestingImportStatement=function(){return"import 'zone.js/testing';"},t.prototype._getTestEnvironmentInitStatement=function(){return a.minor(this._version)<2?"getTestBed().initTestEnvironment(BrowserDynamicTestingModule, platformBrowserDynamicTesting());":"getTestBed().initTestEnvironment(BrowserDynamicTestingModule, platformBrowserDynamicTesting(), { teardown: { destroyAfterEach: true }});"},t.prototype._copyCssLoader=function(e){return{loader:e.loader,options:this._copyCssLoaderOptions(e)}},t}(c);t.exports=d},{"../../../../utils":72,"../v9/WorkspaceConfigurator":28,lodash:void 0,path:void 0,semver:void 0}],19:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("../v13/ProjectConfigurator"),o=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._adjustBuildOptions=function(e){e.aot=!1,e.optimization=!1,e.buildOptimizer=!1},t.prototype._adjustConfiguration=function(t){e.prototype._adjustConfiguration.call(this,t),t.experiments||(t.experiments={}),t.experiments.backCompat=!0},t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getStylesConfig;return[i(t),n(t)]},t}(r);t.exports=o},{"../v13/ProjectConfigurator":21}],20:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o);
}finally{if(r)throw r.error}}return s},s=e("path"),a=e("../v13/WorkspaceConfigurator"),l=e("../../../../utils"),c=logger.create("angular/cli karma workspace config").trace,u=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._adjustBuildOptions=function(e){e.aot=!1,e.optimization=!1,e.buildOptimizer=!1},t.prototype._adjustConfiguration=function(t){e.prototype._adjustConfiguration.call(this,t),t.experiments||(t.experiments={}),t.experiments.backCompat=!0},t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getStylesConfig;return[i(t),n(t)]},t.prototype._fixStyleRules=function(e,t){var i,n,a,u,h,d,f,p,g,v,y=this;if(c("Sanitizing style rules."),t.module&&t.module.rules){var m=t.module.rules,b=m.filter(function(e){return e.rules}).map(function(e){return e.rules}).flat(),k=m.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),T=b.filter(function(e){return e.use}).map(function(e){return e.use}).flat(),S=b.filter(function(e){return e.oneOf}).map(function(e){return e.oneOf}).flat().filter(function(e){return e.use}).map(function(e){return e.use}).flat(),C=_.union(k,T,S);try{for(var L=r(C),j=L.next();!j.done;j=L.next()){var w=j.value;"string"!=typeof w&&w.options&&(this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"postcss-loader")||this._checkCssLoader(w.loader,"resolve-url-loader"))&&(w.options.sourceMap=!1)}}catch(x){i={error:x}}finally{try{j&&!j.done&&(n=L["return"])&&n.call(L)}finally{if(i)throw i.error}}for(var F=new Map,E=0;E<m.length;E++){var R=m[E],I=R.rules?R.rules:[],M=2===I.length&&I[0].oneOf&&I[0].oneOf.length&&I[1].use&&!I[1].use.length?I[0].oneOf.filter(function(e){return e.use}).map(function(e){return e.use}).flat():I.filter(function(e){return e.use}).map(function(e){return e.use}).flat();if(!R.mimetype&&M.length){var w=M[M.length-1];"string"!=typeof w&&(this._checkCssLoader(w.loader,"sass-loader")||this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"stylus-loader")||this._checkCssLoader(w.loader,"postcss-loader"))&&F.set(E,R)}}var O=0;try{for(var P=r(F),q=P.next();!q.done;q=P.next()){var N=o(q.value,1),A=N[0];m.splice(A-O,1),O++}}catch(D){a={error:D}}finally{try{q&&!q.done&&(u=P["return"])&&u.call(P)}finally{if(a)throw a.error}}var B=new Map;try{for(var U=r(F),V=U.next();!V.done;V=U.next()){var Q=o(V.value,2),R=Q[1];if(R.test){var H={test:R.test,rules:[]};B.has(R.test.toString())?H=B.get(R.test.toString()):(H.rules.push({oneOf:[]}),H.rules.push({oneOf:[]}),B.set(R.test.toString(),H));var z=H.rules[0],W=H.rules[1],K=R.rules[0],J=R.rules[1],G=function(e,t,i){var n,o;e.type&&(t.type=e.type),e.resourceQuery&&(t.resourceQuery=e.resourceQuery);try{for(var a=(n=void 0,r(e.use)),c=a.next();!c.done;c=a.next()){var u=c.value;if("string"!=typeof u){var h=y._copyCssLoader(u);if(h.options){var d=i&&i.length?i.map(function(e){return l.normalizePath(s.resolve(s.join(y._workspaceDirPath,e)))}):null;y._setCssLoaderOptionsPaths(h,d)}t.use.push(h)}else t.use.push(u)}}catch(f){n={error:f}}finally{try{c&&!c.done&&(o=a["return"])&&o.call(a)}finally{if(n)throw n.error}}},Y=function(t){var i,n,o,a,l=null;if(t.configuration.architect.test.options){var c=t.configuration.architect.test.options.stylePreprocessorOptions;if(c&&c.includePaths){l=[];try{for(var u=(i=void 0,r(c.includePaths)),h=u.next();!h.done;h=u.next()){var d=h.value;l.push(d)}}catch(f){i={error:f}}finally{try{h&&!h.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}}}var p=[];e.filter(function(e){return e.name!==t.name}).forEach(function(e){var t=s.resolve(s.join(y._workspaceDirPath,e.configuration.root));l&&l.length?l.some(function(e){return s.resolve(s.join(y._workspaceDirPath,e)).startsWith(t)})||p.push(t):p.push(t),(e.configuration.architect.test.options.styles||[]).forEach(function(e){return p.push(s.resolve(s.join(y._workspaceDirPath,"string"==typeof e?e:e.input)))})});var g=t.configuration.architect.test.options.styles||[],v=!0,m=function(e){var t={use:[]};if(G(e,t,l),v){if(v=!1,!g.length)return"continue";t.include=[],g.forEach(function(e){return t.include.push(s.resolve(s.join(y._workspaceDirPath,"string"==typeof e?e:e.input)))})}else t.exclude=[],g.forEach(function(e){return t.exclude.push(s.resolve(s.join(y._workspaceDirPath,"string"==typeof e?e:e.input)))}),p.forEach(function(e){return t.exclude.push(e)});t.use.length&&z.oneOf.push(t)};try{for(var _=(o=void 0,r(K.oneOf)),b=_.next();!b.done;b=_.next()){var k=b.value;m(k)}}catch(T){o={error:T}}finally{try{b&&!b.done&&(a=_["return"])&&a.call(_)}finally{if(o)throw o.error}}var S={use:[]};G(J,S,l),S.exclude=[],p.forEach(function(e){return S.exclude.push(e)}),S.use.length&&W.oneOf.push(S)};try{for(var X=(f=void 0,r(e)),Z=X.next();!Z.done;Z=X.next()){var $=Z.value;Y($)}}catch(ee){f={error:ee}}finally{try{Z&&!Z.done&&(p=X["return"])&&p.call(X)}finally{if(f)throw f.error}}var te=K.oneOf[0],ie={use:[]};G(te,ie),ie.use.length&&z.oneOf.push(ie),te=K.oneOf[1];var ne={use:[]};G(te,ne),ne.use.length&&z.oneOf.push(ne),te=J;var re={use:[]};G(te,re,null),re.use.length&&W.oneOf.push(re)}}}catch(oe){h={error:oe}}finally{try{V&&!V.done&&(d=U["return"])&&d.call(U)}finally{if(h)throw h.error}}try{for(var se=r(B),ae=se.next();!ae.done;ae=se.next()){var le=o(ae.value,2),H=le[1];m.push(H)}}catch(ce){g={error:ce}}finally{try{ae&&!ae.done&&(v=se["return"])&&v.call(se)}finally{if(g)throw g.error}}}},t}(a);t.exports=u},{"../../../../utils":72,"../v13/WorkspaceConfigurator":23,path:void 0}],21:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("../v12/ProjectConfigurator"),o=e("./StyleLoaderResolverPlugin"),s=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._adjustConfiguration=function(e){e.resolveLoader||(e.resolveLoader={}),e.resolveLoader.plugins||(e.resolveLoader.plugins=[]),e.resolveLoader.plugins.push(new o),e.plugins=e.plugins.filter(function(e){return!(e.constructor&&e.constructor.name&&"MiniCssExtractPlugin"===e.constructor.name)})},t.prototype._replaceCssLoader=function(e){e.loader.indexOf("mini-css-extract-plugin")>=0&&(e.loader="style-loader",e.options={})},t}(r);t.exports=s},{"../v12/ProjectConfigurator":17,"./StyleLoaderResolverPlugin":22}],22:[function(e,t,i){var n=e("../../../../utils"),r=e("style-loader");n.patchModule("style-loader",function(){return r});var o="WallabyPlugin",s=function(){function e(){}return e.prototype.apply=function(e){var t=e.ensureHook("file"),i="./node_modules/style-loader";t.tapAsync(o,function(e,t,n){return e.relativePath===i?n(null,{path:"style-loader"}):void n()})},e}();t.exports=s},{"../../../../utils":72,"style-loader":void 0}],23:[function(require,module,exports){var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},url=require("url"),path=require("path"),BaseWorkspaceConfigurator=require("../v12/WorkspaceConfigurator"),StyleLoaderResolverPlugin=require("./StyleLoaderResolverPlugin"),WorkspaceConfigurator=function(_super){function WorkspaceConfigurator(e,t,i,n){return _super.call(this,e,t,i,n)||this}return __extends(WorkspaceConfigurator,_super),WorkspaceConfigurator.prototype._getFileSystemGetter=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,eval(_85d‍.c("import('"+url.pathToFileURL(path.join(this._workspaceDirPath,"node_modules","@angular","compiler-cli","bundles","index.js"))+"');"))]})})},WorkspaceConfigurator.prototype._getTestEnvironmentInitStatement=function(){return"getTestBed().initTestEnvironment(BrowserDynamicTestingModule, platformBrowserDynamicTesting());"},WorkspaceConfigurator.prototype._copyCssLoader=function(e){return e.loader.indexOf("mini-css-extract-plugin")<0?{loader:e.loader,options:this._copyCssLoaderOptions(e)}:{loader:"style-loader",options:{}}},WorkspaceConfigurator.prototype._adjustConfiguration=function(e){e.resolveLoader||(e.resolveLoader={}),e.resolveLoader.plugins||(e.resolveLoader.plugins=[]),e.resolveLoader.plugins.push(new StyleLoaderResolverPlugin),e.plugins=e.plugins.filter(function(e){return!(e.constructor&&e.constructor.name&&"MiniCssExtractPlugin"===e.constructor.name)})},WorkspaceConfigurator}(BaseWorkspaceConfigurator);module.exports=WorkspaceConfigurator},{"../v12/WorkspaceConfigurator":18,"./StyleLoaderResolverPlugin":22,path:void 0,url:void 0}],24:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};e("./modulePatch");var a=e("path"),l=e("os"),c=e("fs"),u=e("util"),h=e("lodash"),d=e("../../../../utils"),f=u.promisify(c.exists),p=u.promisify(c.readFile),g=logger.create("angular/cli karma project config"),v=g.debug,y=g.trace;process.env.NG_BUILD_IVY_LEGACY=1;var m=function(){function t(e,t,i,n){this._workspaceDirPath=d.normalizePath(e),this._workspaceConfigFilePath=d.normalizePath(t),this._workspaceConfig=i,this._project=n}return t.prototype.configure=function(t,i){return r(this,void 0,void 0,function(){function c(e,t){return r(this,void 0,void 0,function(){var i,r,s;return o(this,function(o){switch(o.label){case 0:return e.codeCoverage=!1,O._adjustBuildOptions(e),[4,C(n(n({},e),{outputPath:"",budgets:void 0}),t,function(e){return M(L.module,e)})];case 1:return i=o.sent().config,I=i[0]||i,t&&t.builder&&"@angular-builders/custom-webpack:karma"===t.builder.name?(r=m.module.customWebpackConfigTransformFactory(e,t),r?[4,r(I)]:[3,3]):[3,5];case 2:return s=o.sent(),[3,4];case 3:s=I,o.label=4;case 4:I=s,o.label=5;case 5:return[2,{success:!0}]}})})}var u,g,m,_,b,k,T,S,C,L,j,w,x,F,F,E,R,I,M,O,P,q,N,A,D,B,U,V,Q,H,z,W,K,J,G,Y,W,X,Z,$,ee,te,ie,ne,re,oe,se,ae,le,ce,ue,he,de,fe,pe,ge,ve,ye,me,_e,be,ee,ke,Te,Se,Ce,Le,je,we,xe,ke,Te,Se,ke,Te,Se,Fe,Ee,Re,Ie,Me,Oe,Pe,qe,Ne,Ae,De,Be,Ue=this;return o(this,function(n){switch(n.label){case 0:if(y("Configuring."),i.testFramework={type:"jasmine",autoDetected:!0},i.env||(i.env={kind:"chrome"}),i.bootstrap||i.setup||(i.setup="function(){window.__moduleBundler.loadTests();}"),this._ts=d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"typescript",!0).module,u=d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/commands/test-impl",!1)||d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/src/commands/test/cli.js",!1),!u)throw new Error("Could not load Angular CLI package");if(g=d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/utilities/config.js",!1)||d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/src/utilities/config.js",!1),m=d.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular-builders/custom-webpack/dist/transform-factories.js"),_=u.module,b=_.TestCommand,k=_.TestCommandModule,T=d.tryRequireModuleWithPathFrom(u.path,"@angular-devkit/core/src/logger/null-logger",!0).module.NullLogger,S=d.tryRequireModuleWithPathFrom(u.path,"@angular-devkit/architect",!0).module.createBuilder,C=d.tryRequireModuleWithPathFrom(u.path,"@angular-devkit/build-angular/src/utils/webpack-browser-config",!0).module.generateBrowserWebpackConfigFromContext,L=d.tryRequireModuleWithPathFrom(u.path,"@angular-devkit/build-angular/src/angular-cli-files/models/webpack-configs",!1)||d.tryRequireModuleWithPathFrom(u.path,"@angular-devkit/build-angular/src/webpack/configs",!1),!L)throw new Error("Could not load Webpack configuration");n.label=1;case 1:return n.trys.push([1,6,,7]),this._workspaceConfig.nxWorkspace?(w=d.tryRequireModuleWithPathFrom(a.dirname(this._workspaceConfig.configFileName),"@angular-devkit/core/src/workspace/json/reader",!1),[4,w.module.readJsonWorkspace(a.basename(this._workspaceConfig.configFileName),{readFile:function(){return Ue._convertFromNxWorkspaceConfig()}})]):[3,3];case 2:return x=n.sent(),F=new g.module.AngularWorkspace(x,this._workspaceConfig.configFileName),j={workspace:F},[3,5];case 3:return[4,g.module.AngularWorkspace.load(this._workspaceConfigFilePath)];case 4:F=n.sent(),j={workspace:F},n.label=5;case 5:return[3,7];case 6:return E=n.sent(),j={workspace:{root:this._workspaceDirPath,configFile:"angular.json"}},[3,7];case 7:return R={name:"test",description:"",options:[],aliases:[],hidden:!1,scope:"default"},I={},M=this._getWebpackConfigurations,O=this,P=b?new b(j,R,new T):new k(j,R,new T),P.initialize?[4,P.initialize({})]:[3,9];case 8:n.sent(),n.label=9;case 9:return(P._architectHost?P._architectHost:P.getArchitectHost()).loadBuilder=function(){return new Promise(function(e){return e(S(c))})},y("Calling test command for %s.",this._project.name),[4,P.run({project:this._project.name})];case 10:if(n.sent(),y("Initializing postprocessor."),q=e("../../../../postprocessors/webpack/initialize"),N=q(this._workspaceDirPath),delete I.output,delete I.performance,delete I.optimization,this._adjustConfiguration(I),y("Sanitizing style rules."),I.module&&I.module.rules){A=I.module.rules;try{for(D=s(this._getAllLoaders(A)),B=D.next();!B.done;B=D.next())U=B.value,"string"!=typeof U&&(this._replaceCssLoader(U),U.options&&(this._checkCssLoader(U.loader,"less-loader")||this._checkCssLoader(U.loader,"postcss-loader")||this._checkCssLoader(U.loader,"resolve-url-loader"))&&(U.options.sourceMap=!1))}catch(r){Re={error:r}}finally{try{B&&!B.done&&(Ie=D["return"])&&Ie.call(D)}finally{if(Re)throw Re.error}}}if(y("Sanitizing plugins."),I.plugins=I.plugins.filter(function(e){return!e.sourceMappingURLComment&&(!e.patterns&&((!e.options||!e.options.budgets)&&(!e.budgets&&((!e.options||!e.modules)&&((void 0===e.profile||void 0===e.modulesCount||void 0===e.showEntries||void 0===e.showModules||void 0===e.showActiveModules)&&!(e.options&&e.options.scripts))))))}),this._adjustPlugins(I.plugins),V=this._project.configuration,Q=V.architect.test.options,H=[],y("Setting up polyfills."),z=I.entry.polyfills,z&&z.length){W=[];try{for(K=s(z),J=K.next();!J.done;J=K.next())G=J.value,W.push("require('"+d.normalizePath(G)+"');")}catch(o){Me={error:o}}finally{try{J&&!J.done&&(Oe=K["return"])&&Oe.call(K)}finally{if(Me)throw Me.error}}W.length&&H.push({path:a.join(this._workspaceDirPath,"wallaby-polyfills.js"),code:""+W.join(l.EOL)+this._getExtraPolyfills()})}if(Y=Q.styles){y("Setting up styles."),W=[];try{for(X=s(Y),Z=X.next();!Z.done;Z=X.next())$=Z.value,ee=!0,"string"!=typeof $&&(ee=void 0===$.inject||$.inject,ee=void 0===$.bundleName&&ee,$=$.input),ee&&W.push("require('"+d.normalizePath(a.resolve(a.join(this._workspaceDirPath,$)))+"');")}catch(Ve){Pe={error:Ve}}finally{try{Z&&!Z.done&&(qe=X["return"])&&qe.call(X)}finally{if(Pe)throw Pe.error}}W.length&&H.push({path:a.join(this._workspaceDirPath,"wallaby-styles.js"),code:W.join(l.EOL)})}return y("Setting up main file."),te=d.normalizePath(a.resolve(a.join(this._workspaceDirPath,Q.main))),[4,p(te,"utf-8")];case 11:return ie=n.sent(),ne=a.extname(te),re=a.posix.basename(te,ne),oe=d.normalizePath(a.resolve(a.join(a.dirname(te),re+".wallaby"+ne))),[4,f(oe)];case 12:return n.sent()||(oe=null),se=d.normalizePath(a.resolve(a.join(a.dirname(te),re+".base"+ne))),[4,f(se)];case 13:return n.sent()||(se=null),ae=/const\s+context\s*=\s*require\s*\.\s*context\s*\(\s*'\.\/'\s*,\s*true\s*,\s*\/\\\.spec\\\.ts\$\/\s*\)\s*;/g,le=/context\s*\.\s*keys\s*\(\s*\)\s*\.map\s*\(\s*context\s*\)\s*;/g,ce=/context\s*\.\s*keys\s*\(\s*\)\s*\.forEach\s*\(\s*context\s*\)\s*;/g,oe?(v("Using physical %s.",oe),[4,p(oe,"utf-8")]):[3,15];case 14:return ie=n.sent(),[3,19];case 15:return ie.match(ae)&&(ie.match(le)||ie.match(ce))?(v("Using virtual %s.",te),ie=ie.replace(ae,"").replace(le,"").replace(ce,""),[3,19]):[3,16];case 16:return se?(v("Using physical %s.",se),[4,p(se,"utf-8")]):[3,18];case 17:return ie=n.sent(),[3,19];case 18:v("Using default %s.",te),console.warn("Angular CLI automatic configuration: Wallaby.js cannot use "+te+" file, the standard test bed initialization code will be used instead. Please let us know if this is an issue for you at https:/github.com/wallabyjs/public/issues."),ie="\n            "+("library"===this._project.configuration.projectType?this._getZoneImportStatement():"")+"\n            "+this._getZoneTestingImportStatement()+"\n            import { getTestBed } from '@angular/core/testing';\n      \n            import {\n              BrowserDynamicTestingModule,\n              platformBrowserDynamicTesting\n            } from '@angular/platform-browser-dynamic/testing'; \n          \n            getTestBed().initTestEnvironment(\n              BrowserDynamicTestingModule,\n              platformBrowserDynamicTesting()\n            );",n.label=19;case 19:if(i.diagnostics.angular.main=ie,H.push({path:te,code:ie}),y("Creating postprocessor."),ue=N(I,{setupFiles:H}),this._adjustPostprocessor(ue.owner),i.postprocessor=ue,he=V.sourceRoot?V.sourceRoot:a.join(V.root,"src"),de=t?he:a.relative(V.root,he),y("Created postprocessor."),fe=[],pe=[],fe.push({pattern:d.normalizePath(a.join(de,"/**/*.spec.ts")),ignore:!0}),V.architect.test.options.polyfills&&fe.push({pattern:d.normalizePath(t?V.architect.test.options.polyfills:a.relative(V.root,V.architect.test.options.polyfills)),ignore:!0}),V.architect.test.options.main&&fe.push({pattern:d.normalizePath(t?V.architect.test.options.main:a.relative(V.root,V.architect.test.options.main)),ignore:!0}),V.architect.build&&V.architect.build.options&&(V.architect.build.options.main&&fe.push({pattern:d.normalizePath(t?V.architect.build.options.main:a.relative(V.root,V.architect.build.options.main)),ignore:!0}),V.architect.build.options.index&&fe.push({pattern:d.normalizePath(t?V.architect.build.options.index:a.relative(V.root,V.architect.build.options.index)),ignore:!0})),fe.push({pattern:d.normalizePath(a.join(de,"/test.base.ts")),ignore:!0}),fe.push({pattern:d.normalizePath(a.join(de,"/test.wallaby.ts"))}),pe.push({pattern:d.normalizePath(a.join(de,"/**/*.spec.ts")),load:!1}),ge=[],ve=new Set,ye=Q.scripts,ye&&ye.length){y("Setting up scripts.");try{for(me=s(ye),_e=me.next();!_e.done;_e=me.next())be=_e.value,ee=!0,"string"!=typeof be&&(ee=void 0===be.inject||be.inject,!ee&&be.bundleName&&be.input?(ke=d.normalizePath(a.resolve(a.join(this._workspaceDirPath,be.input))),Te=""+a.posix.sep+be.bundleName+".js",Se=""+Te+ke,ve.has(Se)||(ge.push({path:{virtual:Te,physical:ke}}),ve.add(Se))):(ee=void 0===be.bundleName&&ee,be=be.input)),ee&&be&&(Ce=d.normalizePath(a.resolve(a.join(this._workspaceDirPath,be))),(t?Ce.startsWith(this._workspaceDirPath):Ce.startsWith(d.normalizePath(a.resolve(a.join(this._workspaceDirPath,V.root)))))?fe.push({pattern:d.normalizePath(a.relative(t?this._workspaceDirPath:a.join(this._workspaceDirPath,V.root),Ce)),instrument:!1,load:!0}):console.warn("Angular CLI automatic configuration: the script "+be+" is outside of the "+(t?"workspace":"project folder")+", Wallaby.js ignores such files at the moment. Please let us know if this is an issue for you at https:/github.com/wallabyjs/public/issues."))}catch(Qe){Ne={error:Qe}}finally{try{_e&&!_e.done&&(Ae=me["return"])&&Ae.call(me)}finally{if(Ne)throw Ne.error}}}if(Le=Q.assets,!Le||!Le.length)return[3,28];y("Setting up assets."),n.label=20;case 20:n.trys.push([20,26,27,28]),je=s(Le),we=je.next(),n.label=21;case 21:return we.done?[3,25]:(xe=we.value,"string"!=typeof xe?[3,23]:(ke=d.normalizePath(a.resolve(a.join(this._workspaceDirPath,xe))),[4,f(ke)]));case 22:return n.sent()&&(Te=""+a.posix.sep+a.basename(ke),Se=""+Te+ke,ve.has(Se)||(ge.push({path:{virtual:Te,physical:ke}}),ve.add(Se))),[3,24];case 23:xe&&xe.input&&xe.output&&(ke=d.normalizePath(a.resolve(a.join(this._workspaceDirPath,xe.input))),Te=xe.output.startsWith(a.posix.sep)?xe.output:""+a.posix.sep+xe.output,Se=""+Te+ke,ve.has(Se)||(ge.push({path:{virtual:Te,physical:ke}}),ve.add(Se))),n.label=24;case 24:return we=je.next(),[3,21];case 25:return[3,28];case 26:return Fe=n.sent(),De={error:Fe},[3,28];case 27:try{we&&!we.done&&(Be=je["return"])&&Be.call(je)}finally{if(De)throw De.error}return[7];case 28:return ge.length&&(Ee=function(e,t){var i,n;try{for(var r=s(ge),o=r.next();!o.done;o=r.next()){var a=o.value;e.use(a.path.virtual,t["static"](a.path.physical))}}catch(l){i={error:l}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}},i.middleware?h.isFunction(i.middleware.override)&&(i.middleware=i.middleware.override(Ee)):i.middleware=Ee),fe.push({pattern:d.normalizePath(a.join(de,"/**/*.+(ts|js)")),load:!1}),fe.push({pattern:d.normalizePath(a.join(de,"/**/*.+(css|less|scss|sass|styl|html|json|svg)")),instrument:!1,load:!1}),i.files?h.isFunction(i.files.override)&&(i.files=i.files.override(fe)):i.files=fe,i.tests?h.isFunction(i.tests.override)&&(i.tests=i.tests.override(pe)):i.tests=pe,y("Configured."),[2]}})})},t.prototype._checkCssLoader=function(e,t){return e===t},t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getNonAotConfig,r=e.getStylesConfig,o=e.getTestConfig,s=e.getWorkerConfig;return[i(t),r(t),n(t),o(t),s(t)]},t.prototype._getExtraPolyfills=function(){return""},t.prototype._adjustPostprocessor=function(e){var t=this,i=e._prepareCompiler.bind(e);e._prepareCompiler=function(e,n,a,l,c){var u,h;i(e,c);var d=function(i){if(i._compilerHost){if(i._firstRun=!e,e)n?(i._moduleResolutionCache=t._ts.createModuleResolutionCache(i._basePath,function(e){return e}),i._compilerHost.moduleResolutionCache=i._moduleResolutionCache):a||l.forEach(function(e){return i._compilerHost.invalidate(e.fullPath)});else{c.watchMode=!0;var s=i._createOrUpdateProgram.bind(i);i._createOrUpdateProgram=function(){return r(t,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,s()];case 1:return e.sent(),i._program.getSemanticDiagnostics=function(){return[]},[2]}})})}}return"break"}};try{for(var f=s(c.options.plugins),p=f.next();!p.done;p=f.next()){var g=p.value,v=d(g);if("break"===v)break}}catch(y){u={error:y}}finally{try{p&&!p.done&&(h=f["return"])&&h.call(f)}finally{if(u)throw u.error}}}},t.prototype._adjustBuildOptions=function(e){},t.prototype._adjustConfiguration=function(e){},t.prototype._adjustPlugins=function(e){},t.prototype._getZoneImportStatement=function(){return"import 'zone.js/dist/zone';"},t.prototype._getZoneTestingImportStatement=function(){return"import 'zone.js/dist/zone-testing';"},t.prototype._replaceCssLoader=function(e){},t.prototype._getAllLoaders=function(e){return h.flatten(e.filter(function(e){return e.use}).map(function(e){return e.use}))},t.prototype._convertFromNxWorkspaceConfig=function(){var e,t,i=JSON.parse(JSON.stringify(this._workspaceConfig));if(i.projects)try{for(var n=s(Object.keys(i.projects)),r=n.next();!r.done;r=n.next()){var o=r.value,a=i.projects[o],l=a.targets||a.architect;if(l&&l.test){var c=l.test.executor||l.test.builder;c&&!c.startsWith("@angular")&&delete i.projects[o]}}}catch(u){e={error:u}}finally{try{r&&!r.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}return JSON.stringify(i)},t}();t.exports=m},{"../../../../postprocessors/webpack/initialize":51,"../../../../utils":72,"./modulePatch":26,fs:void 0,lodash:void 0,os:void 0,path:void 0,util:void 0}],25:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s};e("./modulePatch");var l=e("path"),c=e("os"),u=e("fs"),h=e("util"),d=e("lodash"),f=e("../../../../utils"),p=h.promisify(u.exists),g=h.promisify(u.readFile),v=logger.create("angular/cli karma workspace config"),y=v.debug,m=v.trace;process.env.NG_BUILD_IVY_LEGACY=1;var _=function(){function t(e,t,i,n){this._workspaceDirPath=f.normalizePath(e),this._workspaceConfigFilePath=f.normalizePath(t),this._workspaceConfig=i,this._version=n}return t.prototype.configure=function(t){return r(this,void 0,void 0,function(){function i(e,t){return r(this,void 0,void 0,function(){var i,r,s;return o(this,function(o){switch(o.label){case 0:return e.codeCoverage=!1,e.tsConfig=A,U._adjustBuildOptions(e),d.flatten(M.filter(function(e){return e.name!==O.name}).map(function(e){return e.configuration}).filter(function(e){return e.architect.test.options.fileReplacements}).map(function(e){return e.architect.test.options.fileReplacements})).forEach(function(t){return e.fileReplacements.push(t)}),[4,S(n(n({},e),{outputPath:"",budgets:void 0}),t,function(e){return B(C.module,e)})];case 1:return i=o.sent().config,t&&t.builder&&"@angular-builders/custom-webpack:karma"===t.builder.name?(r=g.module.customWebpackConfigTransformFactory(e,t),r?[4,r(D)]:[3,3]):[3,5];case 2:return s=o.sent(),[3,4];case 3:s=D,o.label=4;case 4:D=s,o.label=5;case 5:return D=i[0]||i,[2,{success:!0}]}})})}var a,c,h,g,v,_,b,k,T,S,C,L,j,w,x,x,F,E,R,I,M,O,P,q,N,A,D,B,U,V,Q,H,z,W,K,J,G,Y,X,Z,$,ee,te,ie,ne,re,oe,se,ae,le,ce,ue,he,de,fe,pe,ge,ve,ye,me,_e,be,ke,Te,Se,Ce,Le,je,we=this;return o(this,function(n){switch(n.label){case 0:return m("Configuring."),t.testFramework={type:"jasmine",autoDetected:!0},t.env||(t.env={kind:"chrome"}),t.setup||t.setup||(t.setup="function(){window.__moduleBundler.loadTests();}"),this._ts=f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"typescript",!0).module,[4,this._getFileSystemGetter()];case 1:if(a=n.sent().getFileSystem,c=f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/commands/test-impl",!1)||f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/src/commands/test/cli.js",!1),!c)throw new Error("Could not load Angular CLI package");if(h=f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/utilities/config.js",!1)||f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/src/utilities/config.js",!1),g=f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular-builders/custom-webpack/dist/transform-factories.js"),v=c.module,
_=v.TestCommand,b=v.TestCommandModule,k=f.tryRequireModuleWithPathFrom(c.path,"@angular-devkit/core/src/logger/null-logger",!0).module.NullLogger,T=f.tryRequireModuleWithPathFrom(c.path,"@angular-devkit/architect",!0).module.createBuilder,S=f.tryRequireModuleWithPathFrom(c.path,"@angular-devkit/build-angular/src/utils/webpack-browser-config",!0).module.generateBrowserWebpackConfigFromContext,C=f.tryRequireModuleWithPathFrom(c.path,"@angular-devkit/build-angular/src/angular-cli-files/models/webpack-configs",!1)||f.tryRequireModuleWithPathFrom(c.path,"@angular-devkit/build-angular/src/webpack/configs",!1),!C)throw new Error("Could not load Webpack configuration");n.label=2;case 2:return n.trys.push([2,7,,8]),this._workspaceConfig.nxWorkspace?(j=f.tryRequireModuleWithPathFrom(l.dirname(this._workspaceConfig.configFileName),"@angular-devkit/core/src/workspace/json/reader",!1),[4,j.module.readJsonWorkspace(l.basename(this._workspaceConfig.configFileName),{readFile:function(){return we._convertFromNxWorkspaceConfig()}})]):[3,4];case 3:return w=n.sent(),x=new h.module.AngularWorkspace(w,this._workspaceConfig.configFileName),L={workspace:x},[3,6];case 4:return[4,h.module.AngularWorkspace.load(this._workspaceConfigFilePath)];case 5:x=n.sent(),L={workspace:x},n.label=6;case 6:return[3,8];case 7:return F=n.sent(),L={workspace:{root:this._workspaceDirPath,configFile:"angular.json"}},[3,8];case 8:return E={name:"test",description:"",options:[],aliases:[],hidden:!1,scope:"default"},R=t["angular-cli"],I=R&&Array.isArray(R.excludedProjects)?new Set(R.excludedProjects):new Set,M=Object.keys(this._workspaceConfig.projects).map(function(e){return{name:e,configuration:we._workspaceConfig.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&("@angular-devkit/build-angular:karma"===e.configuration.architect.test.builder||"@angular-builders/custom-webpack:karma"===e.configuration.architect.test.builder)}).filter(function(e){return!I.has(e.name)}),P=M.filter(function(e){return"application"===e.configuration.projectType}),P.length>1?(q=P.filter(function(e){return""===e.configuration.root}),q.length?O=q[0]:(N=P.filter(function(e){return e.name===we._workspaceConfig.defaultProject}),O=N.length?N[0]:P[0])):O=P.length?P[0]:M.find(function(e){return"library"===e.configuration.projectType}),A="tsconfig.wallaby.spec.json",[4,p(l.join(this._workspaceDirPath,A))];case 9:return n.sent()?[3,11]:(A="tsconfig.workspace.spec.json",[4,p(l.join(this._workspaceDirPath,A))]);case 10:n.sent()||(A="tsconfig.wallaby.spec.json"),n.label=11;case 11:return D={},B=this._getWebpackConfigurations,U=this,V=_?new _(L,E,new k):new b(L,E,new k),V.initialize?[4,V.initialize({})]:[3,13];case 12:n.sent(),n.label=13;case 13:return(V._architectHost?V._architectHost:V.getArchitectHost()).loadBuilder=function(){return new Promise(function(e){return e(T(i))})},[4,this._generateMainFiles(M)];case 14:return Q=n.sent(),H=l.join(this._workspaceDirPath,A),m("Calling test command for %s.",O.name),z=f.normalizePath(H),[4,p(H)];case 15:return W=!n.sent(),K="",W?(y("Using virtual %s.",H),J=a(),G=J.lstat,Y=u.statSync,X=this._ts.sys.readFile,Z=J.readFile,[4,this._generateTsConfigFile(M,1===Q.length?Q[0].path:null)]):[3,18];case 16:return K=n.sent(),t.diagnostics.angular.tsConfig=K,J.lstat=function(e){return e===z?{isDirectory:function(){return!1}}:G(e)},this._ts.sys.readFile=function(e){return e===z?K:X(e)},u.statSync=function(e,t){return e===H?{isFile:function(){return!0}}:Y(e,t)},J.readFile=function(e){return e===z?K:Z(e)},[4,V.run({project:O.name})];case 17:return n.sent(),u.statSync=Y,[3,20];case 18:return y("Using physical %s.",H),[4,V.run({project:O.name})];case 19:n.sent(),n.label=20;case 20:return m("Initializing postprocessor."),$=e("../../../../postprocessors/webpack/initialize"),ee=$(this._workspaceDirPath),delete D.output,delete D.performance,delete D.optimization,this._adjustConfiguration(D),this._fixStyleRules(M,D),m("Sanitizing plugins."),D.plugins=D.plugins.filter(function(e){return!e.sourceMappingURLComment&&(!e.patterns&&((!e.options||!e.options.budgets)&&(!e.budgets&&((!e.options||!e.modules)&&(!e.generateName&&((void 0===e.profile||void 0===e.modulesCount||void 0===e.showEntries||void 0===e.showModules||void 0===e.showActiveModules)&&!(e.options&&e.options.scripts)))))))}),this._adjustPlugins(D.plugins),te=O.configuration.architect.test.options.polyfills?l.resolve(l.join(this._workspaceDirPath,O.configuration.architect.test.options.polyfills)):null,ie=(D.entry.polyfills||[]).filter(function(e){return null==te||te!==e}),[4,this._generatePolyfillFile(M,ie)];case 21:ne=n.sent(),re=this._generatesStyleFile(M),oe=[],ne&&(t.diagnostics.angular.polyfill=ne,oe.push(ne)),t.diagnostics.angular.main=[];try{for(se=s(Q),ae=se.next();!ae.done;ae=se.next())le=ae.value,void 0===le.code?oe.push(le.path):(t.diagnostics.angular.main.push(le),oe.push(le))}catch(r){ke={error:r}}finally{try{ae&&!ae.done&&(Te=se["return"])&&Te.call(se)}finally{if(ke)throw ke.error}}return re&&oe.push(re),[4,this._generatesAssetRoutes(M)];case 22:ce=n.sent(),ce.length&&(ue=function(e,t){var i,n;try{for(var r=s(ce),o=r.next();!o.done;o=r.next()){var a=o.value;e.use(a.path.virtual,t["static"](a.path.physical))}}catch(l){i={error:l}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}},t.middleware?d.isFunction(t.middleware.override)&&(t.middleware=t.middleware.override(ue)):t.middleware=ue),m("Creating postprocessor."),he=ee(D,{setupFiles:oe}),this._adjustPostprocessor(he.owner,W,z,K,a),t.postprocessor=he,de=[],fe=[];try{for(pe=s(this._generatesScripts(M)),ge=pe.next();!ge.done;ge=pe.next())ve=ge.value,de.push({pattern:ve,instrument:!1,load:!0})}catch(o){Se={error:o}}finally{try{ge&&!ge.done&&(Ce=pe["return"])&&Ce.call(pe)}finally{if(Se)throw Se.error}}try{for(ye=s(M.map(function(e){return e.configuration})),me=ye.next();!me.done;me=ye.next())_e=me.value,be=_e.sourceRoot?_e.sourceRoot:l.join(_e.root,"src"),_e.architect.test.options.polyfills&&de.push({pattern:f.normalizePath(_e.architect.test.options.polyfills),ignore:!0}),_e.architect.test.options.main&&de.push({pattern:f.normalizePath(_e.architect.test.options.main),ignore:!0}),_e.architect.build&&_e.architect.build.options&&(_e.architect.build.options.main&&de.push({pattern:f.normalizePath(_e.architect.build.options.main),ignore:!0}),_e.architect.build.options.index&&de.push({pattern:f.normalizePath(_e.architect.build.options.index),ignore:!0})),de.push({pattern:f.normalizePath(l.join(be,"/test.base.ts")),ignore:!0}),de.push({pattern:f.normalizePath(l.join(be,"/test.wallaby.ts")),ignore:!0}),de.push({pattern:f.normalizePath(l.join(be,"/**/*.spec.ts")),ignore:!0}),de.push({pattern:f.normalizePath(l.join(be,"/**/*.+(ts|js)")),load:!1}),de.push({pattern:f.normalizePath(l.join(be,"/**/*.+(css|less|scss|sass|styl|html|json|svg)")),instrument:!1,load:!1}),fe.push({pattern:f.normalizePath(l.join(be,"/**/*.spec.ts")),load:!1})}catch(xe){Le={error:xe}}finally{try{me&&!me.done&&(je=ye["return"])&&je.call(ye)}finally{if(Le)throw Le.error}}return t.files?d.isFunction(t.files.override)&&(t.files=t.files.override(de)):t.files=de,t.tests?d.isFunction(t.tests.override)&&(t.tests=t.tests.override(fe)):t.tests=fe,m("Configured."),[2]}})})},t.prototype._generateMainFiles=function(e){return r(this,void 0,void 0,function(){var t,i,n,r,a,c,u,h,d,v,m,_,b,k,T,S,C,L,j;return o(this,function(o){switch(o.label){case 0:return t="test.wallaby.ts",i=l.join(this._workspaceDirPath,t),[4,p(i)];case 1:return o.sent()?(y("Using physical %s.",t),[2,[{path:i}]]):(t="test.workspace.ts",i=l.join(this._workspaceDirPath,t),[4,p(i)]);case 2:if(o.sent())return y("Using physical %s.",t),[2,[{path:i}]];n=/const\s+context\s*=\s*require\s*\.\s*context\s*\(\s*'\.\/'\s*,\s*true\s*,\s*\/\\\.spec\\\.ts\$\/\s*\)\s*;/g,r=/context\s*\.\s*keys\s*\(\s*\)\s*\.map\s*\(\s*context\s*\)\s*;/g,a=/context\s*\.\s*keys\s*\(\s*\)\s*\.forEach\s*\(\s*context\s*\)\s*;/g,c=[],o.label=3;case 3:o.trys.push([3,16,17,18]),u=s(e),h=u.next(),o.label=4;case 4:return h.done?[3,15]:(d=h.value,v=d.configuration.architect.test.options,m=f.normalizePath(l.resolve(l.join(this._workspaceDirPath,v.main))),[4,g(m,"utf-8")]);case 5:return _=o.sent(),b=l.extname(m),k=l.posix.basename(m,b),T=f.normalizePath(l.resolve(l.join(l.dirname(m),k+".wallaby"+b))),[4,p(T)];case 6:return o.sent()||(T=null),S=f.normalizePath(l.resolve(l.join(l.dirname(m),k+".base"+b))),[4,p(S)];case 7:return o.sent()||(S=null),T?(y("Using physical %s.",T),[4,g(T,"utf-8")]):[3,9];case 8:return _=o.sent(),[3,13];case 9:return _.match(n)&&(_.match(r)||_.match(a))?(y("Using virtual %s.",m),_=_.replace(n,"").replace(r,"").replace(a,""),[3,13]):[3,10];case 10:return S?(y("Using physical %s.",S),[4,g(S,"utf-8")]):[3,12];case 11:return _=o.sent(),[3,13];case 12:y("Using default %s.",m),console.warn("Angular CLI automatic configuration: Wallaby.js cannot use "+m+" file, the standard test bed initialization code will be used instead. Please let us know if this is an issue for you at https:/github.com/wallabyjs/public/issues."),_="\n              "+("library"===d.configuration.projectType?this._getZoneImportStatement():"")+"\n              "+this._getZoneTestingImportStatement()+"  \n              import { getTestBed } from '@angular/core/testing';\n      \n              import {\n                BrowserDynamicTestingModule,\n                platformBrowserDynamicTesting\n              } from '@angular/platform-browser-dynamic/testing'; \n          \n              "+this._getTestEnvironmentInitStatement()+"\n              ",o.label=13;case 13:c.push({path:m,code:c.length>0?this._deduplicateMainFileContent(_):_}),o.label=14;case 14:return h=u.next(),[3,4];case 15:return[3,18];case 16:return C=o.sent(),L={error:C},[3,18];case 17:try{h&&!h.done&&(j=u["return"])&&j.call(u)}finally{if(L)throw L.error}return[7];case 18:return[2,c]}})})},t.prototype._readTsconfig=function(t){try{return this._ts.parseConfigFileTextToJson(t,u.readFileSync(t).toString()).config}catch(i){return e(t)}},t.prototype._generateTsConfigFile=function(t,i){return r(this,void 0,void 0,function(){var n,r,a,c,u,h,d,g,v,y,m,_,b,k,T,S,C,L,j,w,x,F,E,R,I,M,O,P,q,N,A,D,B,U,V,Q;return o(this,function(H){switch(H.label){case 0:return n=l.resolve(l.join(this._workspaceDirPath,"tsconfig.base.json")),[4,p(n)];case 1:return H.sent()||(n=l.resolve(l.join(this._workspaceDirPath,"tsconfig.json"))),[4,p(n)];case 2:if(!H.sent())throw new Error(n+" file does not exist.");r=this._readTsconfig(n),r.compilerOptions=r.compilerOptions||{},r.compilerOptions.paths=r.compilerOptions.paths||{},r.compilerOptions.types=r.compilerOptions.types||[],a=[],c=[],u=[],h=r.compilerOptions.paths,d=new Set,g=function(t){var i,n,r,g,y,m,_,b,k,T,S,C,L,j,w,x,F,E,R,I,M,O,P,q,N,A,D,B,U;return o(this,function(o){switch(o.label){case 0:return i=h[t.name],n=h[t.name+"/*"],(i||n)&&t.configuration.architect.build&&t.configuration.architect.build.options&&t.configuration.architect.build.options.project?(r=l.resolve(l.join(v._workspaceDirPath,t.configuration.architect.build.options.project)),[4,p(r)]):[3,2];case 1:o.sent()&&(g=e(r),g.dest&&g.lib&&g.lib.entryFile&&(y=f.normalizePath(l.relative(v._workspaceDirPath,l.resolve(l.join(l.dirname(r),g.dest)))),i&&i.find(function(e){return e.includes(y)})&&(i.splice(0,i.length),i.push(l.posix.join(t.configuration.root,g.lib.entryFile))),n&&n.find(function(e){return e.includes(y)})&&(n.splice(0,n.length),m=t.configuration.sourceRoot?t.configuration.sourceRoot:l.join(t.configuration.root,"src"),n.push(l.posix.join(m,"*"))))),o.label=2;case 2:return _=l.resolve(l.join(v._workspaceDirPath,t.configuration.architect.test.options.tsConfig)),b=l.dirname(_),[4,p(_)];case 3:if(o.sent()){if(k=v._readTsconfig(_),k.compilerOptions&&k.compilerOptions.types)try{for(O=void 0,T=s(k.compilerOptions.types),S=T.next();!S.done;S=T.next())C=S.value,d.add(C)}catch(V){O={error:V}}finally{try{S&&!S.done&&(P=T["return"])&&P.call(T)}finally{if(O)throw O.error}}if(k.files)try{for(q=void 0,L=s(k.files),j=L.next();!j.done;j=L.next())w=j.value,l.isAbsolute(w)?a.push(w):(w=f.normalizePath(l.join(l.relative(v._workspaceDirPath,b),w)),a.push(w))}catch(Q){q={error:Q}}finally{try{j&&!j.done&&(N=L["return"])&&N.call(L)}finally{if(q)throw q.error}}if(k.include)try{for(A=void 0,x=s(k.include),F=x.next();!F.done;F=x.next())E=F.value,c.push(f.normalizePath(l.join(l.relative(v._workspaceDirPath,b),E)))}catch(H){A={error:H}}finally{try{F&&!F.done&&(D=x["return"])&&D.call(x)}finally{if(A)throw A.error}}if(k.exclude)try{for(B=void 0,R=s(k.exclude),I=R.next();!I.done;I=R.next())M=I.value,u.push(f.normalizePath(l.join(l.relative(v._workspaceDirPath,b),M)))}catch(z){B={error:z}}finally{try{I&&!I.done&&(U=R["return"])&&U.call(R)}finally{if(B)throw B.error}}}return[2]}})},v=this,H.label=3;case 3:H.trys.push([3,8,9,10]),y=s(t),m=y.next(),H.label=4;case 4:return m.done?[3,7]:(_=m.value,[5,g(_)]);case 5:H.sent(),H.label=6;case 6:return m=y.next(),[3,4];case 7:return[3,10];case 8:return b=H.sent(),O={error:b},[3,10];case 9:try{m&&!m.done&&(P=y["return"])&&P.call(y)}finally{if(O)throw O.error}return[7];case 10:a.length&&(r.files=[]);try{for(k=s(a),T=k.next();!T.done;T=k.next())S=T.value,r.files.push(S)}catch(z){q={error:z}}finally{try{T&&!T.done&&(N=k["return"])&&N.call(k)}finally{if(q)throw q.error}}return i&&r.files.push(i),C=l.join(this._workspaceDirPath,"polyfills.wallaby.ts"),[4,p(C)];case 11:return H.sent()?(r.files.push(C),[3,14]):[3,12];case 12:return C=l.join(this._workspaceDirPath,"polyfills.workspace.ts"),[4,p(C)];case 13:H.sent()&&r.files.push(C),H.label=14;case 14:c.length&&(r.include=[]);try{for(L=s(c),j=L.next();!j.done;j=L.next())w=j.value,r.include.push(w)}catch(W){A={error:W}}finally{try{j&&!j.done&&(D=L["return"])&&D.call(L)}finally{if(A)throw A.error}}u.length&&(r.exclude=[]);try{for(x=s(u),F=x.next();!F.done;F=x.next())E=F.value,r.exclude.push(E)}catch(K){B={error:K}}finally{try{F&&!F.done&&(U=x["return"])&&U.call(x)}finally{if(B)throw B.error}}d.size&&(r.compilerOptions.types=[]);try{for(R=s(d),I=R.next();!I.done;I=R.next())M=I.value,r.compilerOptions.types.push(M)}catch(J){V={error:J}}finally{try{I&&!I.done&&(Q=R["return"])&&Q.call(R)}finally{if(V)throw V.error}}return[2,JSON.stringify(r)]}})})},t.prototype._generatePolyfillFile=function(e,t){return r(this,void 0,void 0,function(){var i,n,r,a,u,h,d,v,y,_,b,k,T,S,C,L;return o(this,function(o){switch(o.label){case 0:i=l.join(this._workspaceDirPath,"polyfills.wallaby.ts"),n=[];try{for(r=s(t),a=r.next();!a.done;a=r.next())u=a.value,n.push("require('"+f.normalizePath(u)+"');")}catch(j){T={error:j}}finally{try{a&&!a.done&&(S=r["return"])&&S.call(r)}finally{if(T)throw T.error}}return[4,p(i)];case 1:return o.sent()?(n.push("require('"+f.normalizePath(i)+"');"),[3,13]):[3,2];case 2:return i=l.join(this._workspaceDirPath,"polyfills.workspace.ts"),[4,p(i)];case 3:return o.sent()?(n.push("require('"+f.normalizePath(i)+"');"),[3,13]):[3,4];case 4:h=new Set,o.label=5;case 5:o.trys.push([5,11,12,13]),d=s(e),v=d.next(),o.label=6;case 6:return v.done?[3,10]:(y=v.value,y.configuration.architect.test.options.polyfills?(m("Setting up polyfills for %s.",y.name),_=l.resolve(l.join(this._workspaceDirPath,y.configuration.architect.test.options.polyfills)),[4,p(_)]):[3,9]);case 7:return o.sent()?[4,g(_,"utf-8")]:[3,9];case 8:b=o.sent(),h.has(b)||(h.add(b),n.push("require('"+f.normalizePath(_)+"');")),o.label=9;case 9:return v=d.next(),[3,6];case 10:return[3,13];case 11:return k=o.sent(),C={error:k},[3,13];case 12:try{v&&!v.done&&(L=d["return"])&&L.call(d)}finally{if(C)throw C.error}return[7];case 13:return n.length?[2,{path:l.join(this._workspaceDirPath,"wallaby-polyfills.js"),code:""+n.join(c.EOL)+this._getExtraPolyfills()}]:[2,null]}})})},t.prototype._generatesStyleFile=function(e){var t,i,n,r,o=[];try{for(var a=s(e),u=a.next();!u.done;u=a.next()){var h=u.value,d=h.configuration.architect.test.options,p=d.styles;if(p){m("Setting up styles for %s.",h.name);try{for(var g=(n=void 0,s(p)),v=g.next();!v.done;v=g.next()){var y=v.value,_=!0;"string"!=typeof y&&(_=void 0===y.inject||y.inject,_=void 0===y.bundleName&&_,y=y.input),_&&o.push("require('"+f.normalizePath(l.resolve(l.join(this._workspaceDirPath,y)))+"');")}}catch(b){n={error:b}}finally{try{v&&!v.done&&(r=g["return"])&&r.call(g)}finally{if(n)throw n.error}}}}}catch(k){t={error:k}}finally{try{u&&!u.done&&(i=a["return"])&&i.call(a)}finally{if(t)throw t.error}}return o.length?{path:l.join(this._workspaceDirPath,"wallaby-styles.js"),code:o.join(c.EOL)}:null},t.prototype._generatesAssetRoutes=function(e){return r(this,void 0,void 0,function(){var t,i,n,r,a,c,u,h,d,g,v,y,g,v,y,_,b,k,T,S,g,v,y,C,L,j,w,x,F,E;return o(this,function(o){switch(o.label){case 0:t=[],o.label=1;case 1:o.trys.push([1,14,15,16]),i=s(e),n=i.next(),o.label=2;case 2:if(n.done)return[3,13];if(r=n.value,a=new Set,c=r.configuration.architect.test.options.assets,!c||!c.length)return[3,11];m("Setting up assets for %s.",r.name),o.label=3;case 3:o.trys.push([3,9,10,11]),w=void 0,u=s(c),h=u.next(),o.label=4;case 4:return h.done?[3,8]:(d=h.value,"string"!=typeof d?[3,6]:(g=f.normalizePath(l.resolve(l.join(this._workspaceDirPath,d))),[4,p(g)]));case 5:return o.sent()&&(v=""+l.posix.sep+l.basename(g),y=""+v+g,a.has(y)||(t.push({path:{virtual:v,physical:g}}),a.add(y))),[3,7];case 6:d&&d.input&&d.output&&(g=f.normalizePath(l.resolve(l.join(this._workspaceDirPath,d.input))),v=d.output.startsWith(l.posix.sep)?d.output:""+l.posix.sep+d.output,y=""+v+g,a.has(y)||(t.push({path:{virtual:v,physical:g}}),a.add(y))),o.label=7;case 7:return h=u.next(),[3,4];case 8:return[3,11];case 9:return _=o.sent(),w={error:_},[3,11];case 10:try{h&&!h.done&&(x=u["return"])&&x.call(u)}finally{if(w)throw w.error}return[7];case 11:if(b=r.configuration.architect.test.options.scripts,b&&b.length){m("Setting up non-injectable scripts for %s.",r.name);try{for(F=void 0,k=s(b),T=k.next();!T.done;T=k.next())S=T.value,"string"!=typeof S&&!S.inject&&S.bundleName&&S.input&&(g=f.normalizePath(l.resolve(l.join(this._workspaceDirPath,S.input))),v=""+l.posix.sep+S.bundleName+".js",y=""+v+g,a.has(y)||(t.push({path:{virtual:v,physical:g}}),a.add(y)))}catch(R){F={error:R}}finally{try{T&&!T.done&&(E=k["return"])&&E.call(k)}finally{if(F)throw F.error}}}o.label=12;case 12:return n=i.next(),[3,2];case 13:return[3,16];case 14:return C=o.sent(),L={error:C},[3,16];case 15:try{n&&!n.done&&(j=i["return"])&&j.call(i)}finally{if(L)throw L.error}return[7];case 16:return[2,t]}})})},t.prototype._generatesScripts=function(e){var t,i,n,r,o=new Set,a=[];try{for(var c=s(e),u=c.next();!u.done;u=c.next()){var h=u.value,d=h.configuration.architect.test.options.scripts;if(d&&d.length){m("Setting up scripts for %s.",h.name);try{for(var p=(n=void 0,s(d)),g=p.next();!g.done;g=p.next()){var v=g.value,y=!0;if("string"!=typeof v&&(y=void 0===v.inject||v.inject,y=void 0===v.bundleName&&y,v=v.input),v){var _=f.normalizePath(l.resolve(l.join(this._workspaceDirPath,v)));_.startsWith(this._workspaceDirPath)?y&&(v=f.normalizePath(l.relative(this._workspaceDirPath,_)),o.has(v)||(a.push(v),o.add(v))):console.warn("Angular CLI automatic configuration: the script "+v+" is outside of the workspace, Wallaby.js ignores such files at the moment. Please let us know if this is an issue for you at https:/github.com/wallabyjs/public/issues.")}}}catch(b){n={error:b}}finally{try{g&&!g.done&&(r=p["return"])&&r.call(p)}finally{if(n)throw n.error}}}}}catch(k){t={error:k}}finally{try{u&&!u.done&&(i=c["return"])&&i.call(c)}finally{if(t)throw t.error}}return a},t.prototype._fixStyleRules=function(e,t){var i,n,r,o,c,u,h,p,g,v,y,_,b,k,T=this;if(m("Sanitizing style rules."),t.module&&t.module.rules){var S=t.module.rules,C=d.flatten(S.filter(function(e){return e.use}).map(function(e){return e.use}));try{for(var L=s(C),j=L.next();!j.done;j=L.next()){var w=j.value;"string"!=typeof w&&w.options&&(this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"postcss-loader")||this._checkCssLoader(w.loader,"resolve-url-loader"))&&(w.options.sourceMap=!1)}}catch(x){i={error:x}}finally{try{j&&!j.done&&(n=L["return"])&&n.call(L)}finally{if(i)throw i.error}}for(var F=new Map,E=0;E<S.length;E++){var R=S[E];if(R.use&&R.use.length){var w=R.use[R.use.length-1];"string"!=typeof w&&(this._checkCssLoader(w.loader,"sass-loader")||this._checkCssLoader(w.loader,"less-loader")||this._checkCssLoader(w.loader,"stylus-loader")||this._checkCssLoader(w.loader,"postcss-loader"))&&F.set(E,R)}}var I=0;try{for(var M=s(F),O=M.next();!O.done;O=M.next()){var P=a(O.value,1),q=P[0];S.splice(q-I,1),I++}}catch(N){r={error:N}}finally{try{O&&!O.done&&(o=M["return"])&&o.call(M)}finally{if(r)throw r.error}}var A=new Map;try{for(var D=s(F),B=D.next();!B.done;B=D.next()){var U=a(B.value,2),R=U[1],V={test:R.test,oneOf:[]};A.has(R.test.toString())?V=A.get(R.test.toString()):A.set(R.test.toString(),V);var Q=function(t){var i,n,r,o,a=null;if(t.configuration.architect.test.options){var c=t.configuration.architect.test.options.stylePreprocessorOptions;if(c&&c.includePaths){a=[];try{for(var u=(i=void 0,s(c.includePaths)),h=u.next();!h.done;h=u.next()){var d=h.value;a.push(d)}}catch(p){i={error:p}}finally{try{h&&!h.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}}}var g=[];e.filter(function(e){return e.name!==t.name}).forEach(function(e){var t=l.resolve(l.join(T._workspaceDirPath,e.configuration.root));a&&a.length?a.some(function(e){return l.resolve(l.join(T._workspaceDirPath,e)).startsWith(t)})||g.push(t):g.push(t),(e.configuration.architect.test.options.styles||[]).forEach(function(e){return g.push(l.resolve(l.join(T._workspaceDirPath,"string"==typeof e?e:e.input)))})});var v={use:[]};try{for(var y=(r=void 0,s(R.use)),m=y.next();!m.done;m=y.next()){var _=m.value;if("string"!=typeof _){var b={loader:_.loader,options:H._copyCssLoaderOptions(_)};if(b.options){var k=a&&a.length?a.map(function(e){return f.normalizePath(l.resolve(l.join(T._workspaceDirPath,e)))}):null;H._setCssLoaderOptionsPaths(b,k)}v.use.push(b)}else v.use.push(_)}}catch(S){r={error:S}}finally{try{m&&!m.done&&(o=y["return"])&&o.call(y)}finally{if(r)throw r.error}}var C=t.configuration.architect.test.options.styles||[];if(R.include&&R.include.length){if(v.include=[],!C.length)return"continue";C.forEach(function(e){return v.include.push(l.resolve(l.join(T._workspaceDirPath,"string"==typeof e?e:e.input)))})}else v.exclude=[],C.forEach(function(e){return v.exclude.push(l.resolve(l.join(T._workspaceDirPath,"string"==typeof e?e:e.input)))}),g.forEach(function(e){return v.exclude.push(e)});V.oneOf.push(v)},H=this;try{for(var z=(h=void 0,s(e)),W=z.next();!W.done;W=z.next()){var K=W.value;Q(K)}}catch(J){h={error:J}}finally{try{W&&!W.done&&(p=z["return"])&&p.call(z)}finally{if(h)throw h.error}}}}catch(G){c={error:G}}finally{try{B&&!B.done&&(u=D["return"])&&u.call(D)}finally{if(c)throw c.error}}try{for(var Y=s(F),X=Y.next();!X.done;X=Y.next()){var Z=a(X.value,2),R=Z[1];if((!R.include||!R.include.length)&&A.has(R.test.toString())){var V=A.get(R.test.toString()),$={use:[]};try{for(var ee=(y=void 0,s(R.use)),te=ee.next();!te.done;te=ee.next()){var w=te.value;if("string"!=typeof w){var ie={loader:w.loader,options:this._copyCssLoaderOptions(w)};ie.options&&this._setCssLoaderOptionsPaths(ie,void 0),$.use.push(ie)}else $.use.push(w)}}catch(ne){y={error:ne}}finally{try{te&&!te.done&&(_=ee["return"])&&_.call(ee)}finally{if(y)throw y.error}}V.oneOf.push($)}}}catch(re){g={error:re}}finally{try{X&&!X.done&&(v=Y["return"])&&v.call(Y)}finally{if(g)throw g.error}}try{for(var oe=s(A),se=oe.next();!se.done;se=oe.next()){var ae=a(se.value,2),V=ae[1];S.push(V)}}catch(le){b={error:le}}finally{try{se&&!se.done&&(k=oe["return"])&&k.call(oe)}finally{if(b)throw b.error}}}},t.prototype._deduplicateMainFileContent=function(e){var t=/import\s*'zone\.js\/dist\/zone'\s*;/,i=/import\s*'zone\.js\/dist\/zone-testing'\s*;/,n=/import\s*{\s*getTestBed\s*}\s*from\s*'@angular\/core\/testing'\s*;/,r=/declare\s+const\s+require\s*:\s*any\s*;/,o=/import\s*{\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting,?\s*}\s*from\s*'@angular\/platform-browser-dynamic\/testing'\s*;/,s=/getTestBed\s*\(\s*\)\s*.\s*initTestEnvironment\s*\(\s*BrowserDynamicTestingModule\s*,\s*platformBrowserDynamicTesting\s*\(\s*\)\s*,?\s*\)\s*;/;return e.replace(t,"").replace(i,"").replace(n,"").replace(r,"").replace(o,"").replace(s,"")},t.prototype._checkCssLoader=function(e,t){return e===t},t.prototype._copyCssLoaderOptions=function(e){return e.options?Object.assign({},e.options):void 0},t.prototype._setCssLoaderOptionsPaths=function(e,t){(this._checkCssLoader(e.loader,"less-loader")||this._checkCssLoader(e.loader,"stylus-loader"))&&(e.options.paths=t),this._checkCssLoader(e.loader,"sass-loader")&&(e.options.includePaths=t)},t.prototype._getWebpackConfigurations=function(e,t){var i=e.getCommonConfig,n=e.getNonAotConfig,r=e.getStylesConfig,o=e.getTestConfig,s=e.getWorkerConfig;return[i(t),r(t),n(t),o(t),s(t)]},t.prototype._getExtraPolyfills=function(){return""},t.prototype._adjustPostprocessor=function(e,t,i,n,a){var l=this,c=e._prepareCompiler.bind(e),u=!1,h=function(){var e=a(),t=e.lstat,r=e.readFile;e.readFile=function(e){return e===i?n:r(e)},e.lstat=function(e){return e===i?{isDirectory:function(){return!1}}:t(e)}};e._prepareCompiler=function(e,i,n,a,d){var f,p;c(e,d);var g=function(s){if(s._compilerHost){if(s._firstRun=!e,e)t&&(u||(h(),u=!0)),i?(s._moduleResolutionCache=l._ts.createModuleResolutionCache(s._basePath,function(e){return e}),s._compilerHost.moduleResolutionCache=s._moduleResolutionCache):n||a.forEach(function(e){return s._compilerHost.invalidate(e.fullPath)});else{d.watchMode=!0,t&&h();var c=s._createOrUpdateProgram.bind(s);s._createOrUpdateProgram=function(){return r(l,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,c()];case 1:return e.sent(),s._program.getSemanticDiagnostics=function(){return[]},[2]}})})}}return"break"}};try{for(var v=s(d.options.plugins),y=v.next();!y.done;y=v.next()){var m=y.value,_=g(m);if("break"===_)break}}catch(b){f={error:b}}finally{try{y&&!y.done&&(p=v["return"])&&p.call(v)}finally{if(f)throw f.error}}}},t.prototype._adjustBuildOptions=function(e){},t.prototype._adjustConfiguration=function(e){},t.prototype._adjustPlugins=function(e){},t.prototype._getZoneImportStatement=function(){return"import 'zone.js/dist/zone';"},t.prototype._getZoneTestingImportStatement=function(){return"import 'zone.js/dist/zone-testing';"},t.prototype._getTestEnvironmentInitStatement=function(){return"getTestBed().initTestEnvironment(BrowserDynamicTestingModule, platformBrowserDynamicTesting());"},t.prototype._getFileSystemGetter=function(){return r(this,void 0,void 0,function(){return o(this,function(e){return[2,f.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/compiler-cli/src/ngtsc/file_system",!0).module]})})},t.prototype._convertFromNxWorkspaceConfig=function(){var e,t,i=JSON.parse(JSON.stringify(this._workspaceConfig));if(i.projects)try{for(var n=s(Object.keys(i.projects)),r=n.next();!r.done;r=n.next()){var o=r.value,a=i.projects[o],l=a.targets||a.architect;if(l&&l.test){var c=l.test.executor||l.test.builder;c&&!c.startsWith("@angular")&&delete i.projects[o]}}}catch(u){e={error:u}}finally{try{r&&!r.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}return JSON.stringify(i)},t}();t.exports=_},{"../../../../postprocessors/webpack/initialize":51,"../../../../utils":72,"./modulePatch":26,fs:void 0,lodash:void 0,os:void 0,path:void 0,util:void 0}],26:[function(e,t,i){var n=e("../../../../utils");n.patchModulesCode([{files:["ora/index.js"],replacements:[{from:"stream: process.stderr,",to:"stream: process.stdout,",optional:!0}]}],"Possibly unsupported version of angular")},{"../../../../utils":72}],27:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("path"),o=e("../v8/ProjectConfigurator"),s=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._checkCssLoader=function(e,t){return e.indexOf(r.sep+"node_modules"+r.sep+t+r.sep)>=0},t}(o);t.exports=s},{"../v8/ProjectConfigurator":24,path:void 0}],28:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e("path"),o=e("../v8/WorkspaceConfigurator"),s=function(e){function t(t,i,n,r){return e.call(this,t,i,n,r)||this}return n(t,e),t.prototype._checkCssLoader=function(e,t){return e.indexOf(r.sep+"node_modules"+r.sep+t+r.sep)>=0},t.prototype._copyCssLoaderOptions=function(e){if(e.options){if(this._checkCssLoader(e.loader,"sass-loader")){var t=Object.assign({},e.options);return t.sassOptions=Object.assign({},e.options.sassOptions),t}if(this._checkCssLoader(e.loader,"less-loader")){var t=Object.assign({},e.options);return t.lessOptions=Object.assign({},e.options.lessOptions),t}return Object.assign({},e.options)}},t.prototype._setCssLoaderOptionsPaths=function(e,t){this._checkCssLoader(e.loader,"sass-loader")&&(e.options.sassOptions.includePaths=t),this._checkCssLoader(e.loader,"less-loader")&&(e.options.lessOptions.paths=t),this._checkCssLoader(e.loader,"stylus-loader")&&(e.options.paths=t)},t}(o);t.exports=s},{"../v8/WorkspaceConfigurator":25,path:void 0}],29:[function(e,t,i){var n=e("../../utils");n.patchModulesCode([{files:["@angular-devkit/core/src/workspace/json/reader.js"],replacements:[{from:"if (formatVersion !== 1) {",to:"if (formatVersion === 0) {"},{from:"trackChanges: true,",to:"trackChanges: false,"},{from:"targets[name] = value.value;",to:"if (name === 'test') { value.value && value.value.executor && (value.value.builder = value.value.executor) && (delete value.value.executor); }; targets[name] = value.value;"}]}])},{"../../utils":72}],30:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),
"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},o=e("../../../utils"),s=e("semver"),a=logger.create("angular/cli jest project config").trace,l=function(){function t(e,t,i,n,r,s){this._currentDirPath=e,this._autoDetectedSettings=t,this._settings=i,this._packageJson=n,this._workspaceDirPath=o.normalizePath(r),this._project=s}return t.prototype.getConfigurationOnly=function(){return n(this,void 0,void 0,function(){var e,t,i,n,a,l,c,u,h,d,f,p,g,v,y,m,b,k,T;return r(this,function(r){switch(r.label){case 0:return e=this._settings,t=e&&!_.isString(e.testFramework||"")&&e.testFramework&&e.testFramework.path||"",i=e&&!_.isString(e.testFramework||"")&&e.testFramework&&e.testFramework.configFile||"",[4,o.loadJest(this._currentDirPath,t,i)];case 1:return n=r.sent(),a={workspace:{root:this._workspaceDirPath,configFile:"angular.json"},target:{project:this._project.name},workspaceRoot:this._workspaceDirPath},l=o.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@angular/cli/commands/test-impl",!0),c=o.tryRequireModuleWithPathFrom(l.path,"@angular-devkit/core/src/logger/null-logger",!0).module.NullLogger,u=o.tryRequireModuleWithPathFrom(l.path,"@angular-builders/jest/dist/index").moduleExports.getRoots,h=o.tryRequireModuleWithPathFrom(l.path,"@angular-builders/jest/dist/jest-configuration-builder").moduleExports.JestConfigurationBuilder,d=o.tryRequireModuleWithPathFrom(l.path,"@angular-builders/jest/dist/default-config.resolver").moduleExports.DefaultConfigResolver,f=o.tryRequireModuleWithPathFrom(l.path,"@angular-builders/jest/dist/custom-config.resolver").moduleExports.CustomConfigResolver,p=o.tryRequireModuleWithPathFrom(l.path,"@angular-builders/jest/package.json"),[4,u(a)];case 2:return g=r.sent(),v=g.workspaceRoot,y=g.projectRoot,m=this._project.configuration.architect.test.options||{},b=p&&p.module&&p.module.version&&s.gte(p.module.version,"11.2.0")?{tsConfig:m.tsConfig}:m.tsConfig,k=new h(new d(b),new f(new c)).buildConfiguration(y,v,m.configPath),[4,n.jestConfigLoader.module.readConfigs({config:JSON.stringify(k)},[this._currentDirPath])];case 3:return T=r.sent(),T.globalConfig=Object.assign({},T.globalConfig),T.configs=(T.configs||[]).filter(function(e){return"jest-runner"===e.runner||~o.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~o.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}).map(function(e){return Object.assign({},e)}),[2,T]}})})},t.prototype.configure=function(){return n(this,void 0,void 0,function(){var t,i;return r(this,function(n){switch(n.label){case 0:return a("Configuring."),[4,this.getConfigurationOnly()];case 1:return t=n.sent(),i=e("../../jest/configure").applyJestAutoConfig,[4,i(this._currentDirPath,this._settings,this._autoDetectedSettings,this._packageJson,t)];case 2:return n.sent(),this._settings.customJestConfig=t,a("Configured."),[2]}})})},t}();t.exports=l},{"../../../utils":72,"../../jest/configure":35,semver:void 0}],31:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},l=e("../../../utils"),c=logger.create("angular/cli jest workspace config").trace,u=e("./ProjectConfigurator"),h=function(){function t(e,t,i,n,r,o){this._currentDirPath=e,this._autoDetectedSettings=t,this._settings=i,this._packageJson=n,this._workspaceDirPath=l.normalizePath(r),this._workspaceConfig=o}return t.prototype.configure=function(){return r(this,void 0,void 0,function(){var t,i,r,l,h,d,f=this;return o(this,function(o){switch(o.label){case 0:return c("Configuring."),t=this._settings["angular-cli"],i=t&&Array.isArray(t.excludedProjects)?new Set(t.excludedProjects):new Set,r=Object.keys(this._workspaceConfig.projects).map(function(e){return{name:e,configuration:f._workspaceConfig.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&"@angular-builders/jest:run"===e.configuration.architect.test.builder}).filter(function(e){return!i.has(e.name)}),[4,Promise.all(r.map(function(e){return new u(f._currentDirPath,f._autoDetectedSettings,f._settings,f._packageJson,f._workspaceDirPath,e).getConfigurationOnly()}))];case 1:return l=o.sent(),h=n(n({},l[0]),{configs:l.map(function(e){return e.configs}).reduce(function(e,t){return e.push.apply(e,a([],s(t),!1)),e},[])}),d=e("../../jest/configure").applyJestAutoConfig,[4,d(this._currentDirPath,this._settings,this._autoDetectedSettings,this._packageJson,h)];case 2:return o.sent(),this._settings.customJestConfig=h,c("Configured."),[2]}})})},t}();t.exports=h},{"../../../utils":72,"../../jest/configure":35,"./ProjectConfigurator":30}],32:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};e("./modulePatch");var o=e("../../../utils"),s=logger.create("angular/cli nrwl-jest project config").trace,a=function(){function t(e,t,i,n,r,s){this._currentDirPath=e,this._autoDetectedSettings=t,this._settings=i,this._packageJson=n,this._workspaceDirPath=o.normalizePath(r),this._project=s}return t.prototype.getConfigurationOnly=function(){return n(this,void 0,void 0,function(){var e,t,i,n,s,a,l,c,u;return r(this,function(r){switch(r.label){case 0:return e=this._settings,t=e&&!_.isString(e.testFramework||"")&&e.testFramework&&e.testFramework.path||"",i=e&&!_.isString(e.testFramework||"")&&e.testFramework&&e.testFramework.configFile||"",[4,o.loadJest(this._currentDirPath,t,i)];case 1:return n=r.sent(),s={root:this._workspaceDirPath,workspace:{root:this._workspaceDirPath,configFile:"angular.json"},target:{project:this._project.name},workspaceRoot:this._workspaceDirPath},a=o.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@nrwl/jest/src/executors/jest/jest.impl",!1),a||(a=o.tryRequireModuleWithPathFrom(this._workspaceDirPath,"@nrwl/jest/src/builders/jest/jest.impl",!0)),a=a.module,l=this._project.configuration.architect&&this._project.configuration.architect.test.options||{},[4,a(l,s)];case 2:return c=r.sent(),[4,n.jestConfigLoader.module.readConfigs(c.config,[c.options.jestConfig])];case 3:return u=r.sent(),u.globalConfig=Object.assign({},u.globalConfig),u.configs=(u.configs||[]).filter(function(e){return"jest-runner"===e.runner||~o.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~o.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}).map(function(e){return Object.assign({},e)}),[2,u]}})})},t.prototype.configure=function(){return n(this,void 0,void 0,function(){var t,i;return r(this,function(n){switch(n.label){case 0:return s("Configuring."),[4,this.getConfigurationOnly()];case 1:return t=n.sent(),i=e("../../jest/configure").applyJestAutoConfig,[4,i(this._currentDirPath,this._settings,this._autoDetectedSettings,this._packageJson,t)];case 2:return n.sent(),this._settings.customJestConfig=t,s("Configured."),[2]}})})},t}();t.exports=a},{"../../../utils":72,"../../jest/configure":35,"./modulePatch":34}],33:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};e("./modulePatch");var l=e("../../../utils"),c=logger.create("angular/cli nrwl-jest workspace config").trace,u=e("./ProjectConfigurator"),h=function(){function t(e,t,i,n,r,o){this._currentDirPath=e,this._autoDetectedSettings=t,this._settings=i,this._packageJson=n,this._workspaceDirPath=l.normalizePath(r),this._workspaceConfig=o}return t.prototype.configure=function(){return r(this,void 0,void 0,function(){var t,i,r,l,h,d,f=this;return o(this,function(o){switch(o.label){case 0:return c("Configuring."),t=this._settings["angular-cli"],i=t&&Array.isArray(t.excludedProjects)?new Set(t.excludedProjects):new Set,r=Object.keys(this._workspaceConfig.projects).map(function(e){return{name:e,configuration:f._workspaceConfig.projects[e]}}).filter(function(e){return e.configuration.architect&&e.configuration.architect.test&&"@nrwl/jest:jest"===e.configuration.architect.test.builder}).filter(function(e){return!i.has(e.name)}),[4,Promise.all(r.map(function(e){return new u(f._currentDirPath,f._autoDetectedSettings,f._settings,f._packageJson,f._workspaceDirPath,e).getConfigurationOnly()}))];case 1:return l=o.sent(),h=n(n({},l[0]),{configs:l.map(function(e){return e.configs}).reduce(function(e,t){return e.push.apply(e,a([],s(t),!1)),e},[])}),d=e("../../jest/configure").applyJestAutoConfig,[4,d(this._currentDirPath,this._settings,this._autoDetectedSettings,this._packageJson,h)];case 2:return o.sent(),this._settings.customJestConfig=h,c("Configured."),[2]}})})},t}();t.exports=h},{"../../../utils":72,"../../jest/configure":35,"./ProjectConfigurator":32,"./modulePatch":34}],34:[function(e,t,i){var n=e("../../../utils");n.patchModulesCode([{files:["@nrwl/jest/src/builders/jest/jest.impl.js"],replacements:[{from:"exports.default = architect_1.createBuilder(run);",to:""},{from:"function run(options, context) {",to:"exports.default = (options, context) => {"},{from:"if (options.testFile)",to:"return { config, options };\nif (options.testFile)"}]}],"Possibly incompatible/unsupported Nrwl version"),n.patchModulesCode([{files:["@nrwl/jest/src/executors/jest/jest.impl.js"],replacements:[{from:"exports.default = jestExecutor;",to:"exports.default = jestConfigParser;"},{from:"if (options.testFile)",to:"return { config, options };\nif (options.testFile)"}]}],"Possibly incompatible/unsupported Nrwl version")},{"../../../utils":72}],35:[function(e,t,i){"use strict";function n(e,t,i,n,r){return o(this,void 0,void 0,function(){var o,l,d,f,p,g,v,y,m,b,k,T,S;return s(this,function(s){switch(s.label){case 0:return u("Detecting Jest."),o=t&&!_.isString(t.testFramework||"")&&t.testFramework&&t.testFramework.path||"",l=t&&!_.isString(t.testFramework||"")&&t.testFramework&&t.testFramework.configFile||"",[4,h.loadJest(e,o,l)];case 1:if(d=s.sent(),f=d.jestCLI.path,r=r||d.jestConfig,t.diagnostics.jest={config:r},c("Detected Jest."),p=h.escapePathForRegex(a.sep+"node_modules"+a.sep),g=[h.escapePathForRegex("."+a.sep+"dist"+a.sep),h.escapePathForRegex("."+a.sep+"build"+a.sep),h.escapePathForRegex("."+a.sep+"coverage"+a.sep),h.escapePathForRegex("."+a.sep+"git"+a.sep),h.escapePathForRegex(a.sep)+"\\..+"+h.escapePathForRegex(a.sep)],n&&n.dependencies&&n.dependencies["react-native"]&&(g.push(h.escapePathForRegex("android"+a.sep)),g.push(h.escapePathForRegex("ios"+a.sep))),v=[p,g.join("|")],y=r.wallaby={roots:[],watchPathIgnorePatterns:v,testPathIgnorePatterns:v,testMatch:[],testRegex:[]},m=(r.configs||[]).length>1,b=e,k=h.normalizePath(b),T=function(e,t,i){return t&&~e.indexOf(k)?e.split(k+"/").join("").split(k).join(""):!t&&~e.indexOf(b)?i?e.split(b).join(h.escapePathForRegex(".")):e.split(b+a.sep).join("").split(b).join(""):~e.indexOf(h.replacePathSepForRegex(b))?e.split(h.replacePathSepForRegex(b)).join(i?h.escapePathForRegex("."):""):e},S=function(e,t,i,n,r){var o=[];return _.each(e,function(e){e&&(e=e.normalize());var s=T(e,i,n);s&&!~t.indexOf(s)&&(s===e&&r&&(s=r+s),t.push(s),o.push(s))}),o},t.filesWithCoverageCalculated=[],_.each(r.configs,function(e){e.cacheDirectory&&S([e.cacheDirectory],y.watchPathIgnorePatterns,!1,!0,m&&i);var i="("+S(e.roots,y.roots,!1).map(function(e){return h.escapePathForRegex(h.platformDependentPath(e))}).join("|")+".*)";y.roots.length&&(y.roots=y.roots.map(function(e){return h.normalizePath(e)})),S(e.watchPathIgnorePatterns,y.watchPathIgnorePatterns,!1,!0,m&&i),S(e.testPathIgnorePatterns.concat(e.modulePathIgnorePatterns||[]),y.testPathIgnorePatterns,!1,!0,m&&i),S(e.testMatch,y.testMatch,!0,!1,!1),S(e.testRegex,y.testRegex,!1,!0,m&&i),e.collectCoverageFrom&&(t.filesWithCoverageCalculated=t.filesWithCoverageCalculated.concat(e.collectCoverageFrom)),e.coveragePathIgnorePatterns&&(t.filesWithNoCoverageCalculated=(t.filesWithNoCoverageCalculated||[]).concat(e.coveragePathIgnorePatterns.filter(function(e){return e!==p&&!g.find(function(t){return t===e})}).map(function(e){return new RegExp(e)}))),t.globalSetup=t.globalSetup||!!e.globalSetup||!!e.globalTeardown}),(r.globalConfig||{}).collectCoverageFrom&&(t.filesWithCoverageCalculated=t.filesWithCoverageCalculated.concat((r.globalConfig||{}).collectCoverageFrom)),(r.globalConfig||{}).coverageDirectory&&S([(r.globalConfig||{}).coverageDirectory],y.watchPathIgnorePatterns,!1,!0,!1),(r.globalConfig||{}).coveragePathIgnorePatterns&&(t.filesWithNoCoverageCalculated=(t.filesWithNoCoverageCalculated||[]).concat((r.globalConfig||{}).coveragePathIgnorePatterns.filter(function(e){return e!==p&&!g.find(function(t){return t===e})}).map(function(e){return new RegExp(e)}))),t.filesWithCoverageCalculated=t.filesWithCoverageCalculated.map(function(e){return e.replace("<rootDir>/","")}),!y.testMatch.length&&!y.testRegex.length)throw new Error("Can not autodetect test patterns, neither Jest testMatch nor testRegex is set.");return _.isObject(t.testFramework)||(t.testFramework={}),t.testFramework.type="jest",t.testFramework.originalConfig=r,t.testFramework.autoDetected=!0,t.micromatch=!0,i.hard.noCompilers=!0,i.hard.env={type:"node"},c("Configured Jest."),[2]}})})}function r(e,t,i,r){return o(this,void 0,void 0,function(){var o;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,n(e,i,t,r,void 0)];case 1:return s.sent(),[2,{success:!0,errors:[]}];case 2:return o=s.sent(),c(o),[2,{success:!1,errors:[new Error("Automatic Jest configuration error: "+o.message)]}];case 3:return[2]}})})}var o=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};e("./modulePatch");var a=e("path"),l=logger.create("jest/config"),c=l.debug,u=l.trace,h=e("../../utils");t.exports={configure:r,applyJestAutoConfig:n}},{"../../utils":72,"./modulePatch":36,path:void 0}],36:[function(e,t,i){var n=e("../../utils");n.patchModulesCode([{files:["react-app-rewired/scripts/test.js"],replacements:[{from:"require(`${scriptVersion}/scripts/test`);",to:"module.exports = require('../overrides/jest')();",optional:!0},{from:"if (paths.customScriptsIndex > -1) {",to:"module.exports = config; return; if (paths.customScriptsIndex > -1) {",optional:!0}]},{files:["jest-util/build/tryRealpath.js"],replacements:[{from:"path = _gracefulFs().realpathSync.native(path);",to:"const newPath = _gracefulFs().realpathSync.native(path);\n        path = (process.platform === 'win32' && path.substr(0, 1).toLowerCase() !== newPath.substr(0, 1).toLowerCase()) ? path : newPath;"}]}])},{"../../utils":72}],37:[function(e,t,i){"use strict";function n(e,t,i){return r(this,void 0,void 0,function(){var n,r,l,d,v,k,T,S,C,L,j,w;return o(this,function(o){try{if(m("Detecting Vitest."),n=i&&!_.isString(i.testFramework||"")&&i.testFramework&&i.testFramework.configFile||"",i.diagnostics.vitest={},n){if(r=u(e,n),!f(r))throw new Error('Configuration file "'+r+" not found.");i.diagnostics.vitest.file={config:p(r)}}else l=["vitest.config.ts","vitest.config.js","vitest.config.mjs","vite.config.ts","vite.config.js","vite.config.mjs"],d=l.find(function(t){return f(u(e,t))}),d&&(i.diagnostics.vitest.file={config:p(u(e,d)).toString()});if(v=b(e,"vitest/package.json",!1),!v)throw new Error("Vitest dependency not found.");if(y("Detected Vitest."),k=h(u(c(process.mainModule.filename),"runners/node/hooks.mjs")),T="--experimental-loader",S=[T+"="+k,process.mainModule.filename,"extractor","vitest",c(v.path),v.module.version,k],C=i.env&&i.env.runner?i.env.runner:"node",L=g(C,S),j="Unable to extract Vitest configuration.",0!==L.status)throw L.error?new Error(L.error.toString()):L.stderr?new Error(L.stderr.toString()):new Error(j);if(""===(L.stdout||"").toString())throw new Error(j);return w=JSON.parse(L.stdout.toString()),i.diagnostics.vitest.config=w,_.isObject(i.testFramework)||(i.testFramework={}),i.preserveComments=!1,i.extractComments=!0,i.testFramework.type="vitest",i.testFramework.autoDetected=!0,i.env&&i.env.params&&i.env.params.runner&&i.env.params.runner.indexOf(T)<0&&(i.env.params.runner+=" "+T+"="+k),t.hard.noCompilers=!0,t.hard.env={type:"node",params:{runner:T+"="+k}},i.files=a(a(a([],s(w.include.map(function(e){return"!"+e})),!1),s(w.exclude.map(function(e){return"!"+e})),!1),["**/*.*"],!1),i.tests=a(a([],s(w.exclude.map(function(e){return"!"+e})),!1),s(w.include),!1),i.workers=i.workers||{},i.workers.initial=1,i.workers.regular=1,m("Configured Vitest."),[2,{success:!0,errors:[]}]}catch(x){return y(x),[2,{success:!1,errors:[new Error("Automatic Vitest configuration error: "+x.message)]}]}return[2]})})}var r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},l=e("path"),c=l.dirname,u=l.join,h=e("url").pathToFileURL,d=e("fs"),f=d.existsSync,p=d.readFileSync,g=e("child_process").spawnSync,v=logger.create("vitest/config"),y=v.debug,m=v.trace,b=e("../../utils").tryRequireModuleWithPathFrom;t.exports={configure:n}},{"../../utils":72,child_process:void 0,fs:void 0,path:void 0,url:void 0}],38:[function(require,module,exports){"use strict";function extract(moduleFolderPath,moduleVersion,hooksFileUrl){return __awaiter(this,void 0,void 0,function(){var _a,patchFile,findMatchingFiles,moduleDistFolderPath,entryFilePath,startVitest,configuration;return __generator(this,function(_b){switch(_b.label){case 0:if(!valid(moduleVersion)||lt(moduleVersion,minSupportedVersion))throw new Error("Only Vitest v"+minSupportedVersion+" or higher is supported.");return[4,eval(_85d‍.c("import('"+hooksFileUrl+"')"))];case 1:return _a=_b.sent(),patchFile=_a.patchFile,findMatchingFiles=_a.findMatchingFiles,moduleDistFolderPath=join(moduleFolderPath,"dist"),entryFilePath=findMatchingFiles(moduleDistFolderPath,/chunk-vite-node-externalize\..*\.mjs/,!0,!0)[0],patchFile(entryFilePath,function(e){return e.replace("const ctx = await createVitest(options, viteOverrides);","const ctx = await createVitest(options, viteOverrides); await ctx.close(); return ctx.config;").replace("async function startVitest","export async function startVitest")}),[4,eval(_85d‍.c("import('"+pathToFileURL(entryFilePath)+"')"))];case 2:return startVitest=_b.sent().startVitest,[4,startVitest([],{},{})];case 3:return configuration=_b.sent(),configuration["package"]={version:moduleVersion,urls:{hooks:hooksFileUrl},paths:{root:moduleFolderPath,dist:moduleDistFolderPath}},[2,configuration]}})})}var __awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},join=require("path").join,pathToFileURL=require("url").pathToFileURL,_a=require("semver"),lt=_a.lt,valid=_a.valid,minSupportedVersion="0.14.0";module.exports=extract},{path:void 0,semver:void 0,url:void 0}],39:[function(e,t,i){function n(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var r=-1,o=1,s=0;n.Diff,n.prototype.diff_main=function(e,t,i,n){"undefined"==typeof n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[s,e]]:[];"undefined"==typeof i&&(i=!0);var o=i,a=this.diff_commonPrefix(e,t),l=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var u=this.diff_compute_(e,t,o,r);return l&&u.unshift([s,l]),c&&u.push([s,c]),this.diff_cleanupMerge(u),u},n.prototype.diff_compute_=function(e,t,i,n){var a;if(!e)return[[o,t]];if(!t)return[[r,e]];var l=e.length>t.length?e:t,c=e.length>t.length?t:e,u=l.indexOf(c);if(u!=-1)return a=[[o,l.substring(0,u)],[s,c],[o,l.substring(u+c.length)]],e.length>t.length&&(a[0][0]=a[2][0]=r),a;if(1==c.length)return[[r,e],[o,t]];var h=this.diff_halfMatch_(e,t);if(h){var d=h[0],f=h[1],p=h[2],g=h[3],v=h[4],y=this.diff_main(d,p,i,n),m=this.diff_main(f,g,i,n);return y.concat([[s,v]],m)}return i&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,n):this.diff_bisect_(e,t,n)},n.prototype.diff_lineMode_=function(e,t,i){var n=this.diff_linesToChars_(e,t);e=n.chars1,t=n.chars2;var a=n.lineArray,l=this.diff_main(e,t,!1,i);this.diff_charsToLines_(l,a),this.diff_cleanupSemantic(l),l.push([s,""]);for(var c=0,u=0,h=0,d="",f="";c<l.length;){switch(l[c][0]){case o:h++,f+=l[c][1];break;case r:u++,d+=l[c][1];break;case s:if(u>=1&&h>=1){l.splice(c-u-h,u+h),c=c-u-h;for(var n=this.diff_main(d,f,!1,i),p=n.length-1;p>=0;p--)l.splice(c,0,n[p]);c+=n.length}h=0,u=0,d="",f=""}c++}return l.pop(),l},n.prototype.diff_bisect_=function(e,t,i){for(var n=e.length,s=t.length,a=Math.ceil((n+s)/2),l=a,c=2*a,u=new Array(c),h=new Array(c),d=0;d<c;d++)u[d]=-1,h[d]=-1;u[l+1]=0,h[l+1]=0;for(var f=n-s,p=f%2!=0,g=0,v=0,y=0,m=0,_=0;_<a&&!((new Date).getTime()>i);_++){for(var b=-_+g;b<=_-v;b+=2){var k,T=l+b;k=b==-_||b!=_&&u[T-1]<u[T+1]?u[T+1]:u[T-1]+1;for(var S=k-b;k<n&&S<s&&e.charAt(k)==t.charAt(S);)k++,S++;if(u[T]=k,k>n)v+=2;else if(S>s)g+=2;else if(p){var C=l+f-b;if(C>=0&&C<c&&h[C]!=-1){var L=n-h[C];if(k>=L)return this.diff_bisectSplit_(e,t,k,S,i)}}}for(var j=-_+y;j<=_-m;j+=2){var L,C=l+j;L=j==-_||j!=_&&h[C-1]<h[C+1]?h[C+1]:h[C-1]+1;for(var w=L-j;L<n&&w<s&&e.charAt(n-L-1)==t.charAt(s-w-1);)L++,w++;if(h[C]=L,L>n)m+=2;else if(w>s)y+=2;else if(!p){var T=l+f-j;if(T>=0&&T<c&&u[T]!=-1){var k=u[T],S=l+k-T;if(L=n-L,k>=L)return this.diff_bisectSplit_(e,t,k,S,i)}}}}return[[r,e],[o,t]]},n.prototype.diff_bisectSplit_=function(e,t,i,n,r){var o=e.substring(0,i),s=t.substring(0,n),a=e.substring(i),l=t.substring(n),c=this.diff_main(o,s,!1,r),u=this.diff_main(a,l,!1,r);return c.concat(u)},n.prototype.diff_linesToChars_=function(e,t){function i(e){for(var t="",i=0,o=-1,s=n.length;o<e.length-1;){o=e.indexOf("\n",i),o==-1&&(o=e.length-1);var a=e.substring(i,o+1);i=o+1,void 0!==r[a]?t+=String.fromCharCode(r[a]):(t+=String.fromCharCode(s),r[a]=s,n[s++]=a)}return t}var n=[],r=Object.create(null);n[0]="";var o=i(e),s=i(t);return{chars1:o,chars2:s,lineArray:n}},n.prototype.diff_wordMode=function(e,t){
var i=this.diff_linesToWords_(e,t),n=i.chars1,r=i.chars2,o=i.lineArray,s=this.diff_main(n,r,!1);return this.diff_charsToLines_(s,o),s},n.prototype.diff_linesToWords_=function(e,t){function i(e){for(var t=e.split(/(\s+|\b)/),i=0;i<t.length-1;i++)!t[i+1]&&t[i+2]&&s.test(t[i])&&s.test(t[i+2])&&(t[i]+=t[i+2],t.splice(i+1,2),i--);return t}function n(e){for(var t="",n=i(e),s=r.length,a=0,l=n.length;a<l;a++){var c=n[a];void 0!==o[c]?t+=String.fromCharCode(o[c]):(t+=String.fromCharCode(s),o[c]=s,r[s++]=c)}return t}var r=[],o=Object.create(null);r[0]="";var s=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,a=n(e),l=n(t);return{chars1:a,chars2:l,lineArray:r}},n.prototype.diff_charsToLines_=function(e,t){for(var i=0;i<e.length;i++){for(var n=e[i][1],r=[],o=0;o<n.length;o++)r[o]=t[n.charCodeAt(o)];e[i][1]=r.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var i=0,n=Math.min(e.length,t.length),r=n,o=0;i<r;)e.substring(o,r)==t.substring(o,r)?(i=r,o=i):n=r,r=Math.floor((n-i)/2+i);return r},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,n=Math.min(e.length,t.length),r=n,o=0;i<r;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?(i=r,o=i):n=r,r=Math.floor((n-i)/2+i);return r},n.prototype.diff_commonOverlap_=function(e,t){var i=e.length,n=t.length;if(0==i||0==n)return 0;i>n?e=e.substring(i-n):i<n&&(t=t.substring(0,i));var r=Math.min(i,n);if(e==t)return r;for(var o=0,s=1;;){var a=e.substring(r-s),l=t.indexOf(a);if(l==-1)return o;s+=l,0!=l&&e.substring(r-s)!=t.substring(0,s)||(o=s,s++)}},n.prototype.diff_halfMatch_=function(e,t){function i(e,t,i){for(var n,r,o,a,l=e.substring(i,i+Math.floor(e.length/4)),c=-1,u="";(c=t.indexOf(l,c+1))!=-1;){var h=s.diff_commonPrefix(e.substring(i),t.substring(c)),d=s.diff_commonSuffix(e.substring(0,i),t.substring(0,c));u.length<d+h&&(u=t.substring(c-d,c)+t.substring(c,c+h),n=e.substring(0,i-d),r=e.substring(i+h),o=t.substring(0,c-d),a=t.substring(c+h))}return 2*u.length>=e.length?[n,r,o,a,u]:null}if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var o,s=this,a=i(n,r,Math.ceil(n.length/4)),l=i(n,r,Math.ceil(n.length/2));if(!a&&!l)return null;o=l?a&&a[4].length>l[4].length?a:l:a;var c,u,h,d;e.length>t.length?(c=o[0],u=o[1],h=o[2],d=o[3]):(h=o[0],d=o[1],c=o[2],u=o[3]);var f=o[4];return[c,u,h,d,f]},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,i=[],n=0,a=null,l=0,c=0,u=0,h=0,d=0;l<e.length;)e[l][0]==s?(i[n++]=l,c=h,u=d,h=0,d=0,a=e[l][1]):(e[l][0]==o?h+=e[l][1].length:d+=e[l][1].length,a&&a.length<=Math.max(c,u)&&a.length<=Math.max(h,d)&&(e.splice(i[n-1],0,[r,a]),e[i[n-1]+1][0]=o,n--,n--,l=n>0?i[n-1]:-1,c=0,u=0,h=0,d=0,a=null,t=!0)),l++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),l=1;l<e.length;){if(e[l-1][0]==r&&e[l][0]==o){var f=e[l-1][1],p=e[l][1],g=this.diff_commonOverlap_(f,p),v=this.diff_commonOverlap_(p,f);g>=v?(g>=f.length/2||g>=p.length/2)&&(e.splice(l,0,[s,p.substring(0,g)]),e[l-1][1]=f.substring(0,f.length-g),e[l+1][1]=p.substring(g),l++):(v>=f.length/2||v>=p.length/2)&&(e.splice(l,0,[s,f.substring(0,v)]),e[l-1][0]=o,e[l-1][1]=p.substring(0,p.length-v),e[l+1][0]=r,e[l+1][1]=f.substring(v),l++),l++}l++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var i=e.charAt(e.length-1),r=t.charAt(0),o=i.match(n.nonAlphaNumericRegex_),s=r.match(n.nonAlphaNumericRegex_),a=o&&i.match(n.whitespaceRegex_),l=s&&r.match(n.whitespaceRegex_),c=a&&i.match(n.linebreakRegex_),u=l&&r.match(n.linebreakRegex_),h=c&&e.match(n.blanklineEndRegex_),d=u&&t.match(n.blanklineStartRegex_);return h||d?5:c||u?4:o&&!a&&l?3:a||l?2:o||s?1:0}for(var i=1;i<e.length-1;){if(e[i-1][0]==s&&e[i+1][0]==s){var r=e[i-1][1],o=e[i][1],a=e[i+1][1],l=this.diff_commonSuffix(r,o);if(l){var c=o.substring(o.length-l);r=r.substring(0,r.length-l),o=c+o.substring(0,o.length-l),a=c+a}for(var u=r,h=o,d=a,f=t(r,o)+t(o,a);o.charAt(0)===a.charAt(0);){r+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var p=t(r,o)+t(o,a);p>=f&&(f=p,u=r,h=o,d=a)}e[i-1][1]!=u&&(u?e[i-1][1]=u:(e.splice(i-1,1),i--),e[i][1]=h,d?e[i+1][1]=d:(e.splice(i+1,1),i--))}i++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,i=[],n=0,a=null,l=0,c=!1,u=!1,h=!1,d=!1;l<e.length;)e[l][0]==s?(e[l][1].length<this.Diff_EditCost&&(h||d)?(i[n++]=l,c=h,u=d,a=e[l][1]):(n=0,a=null),h=d=!1):(e[l][0]==r?d=!0:h=!0,a&&(c&&u&&h&&d||a.length<this.Diff_EditCost/2&&c+u+h+d==3)&&(e.splice(i[n-1],0,[r,a]),e[i[n-1]+1][0]=o,n--,a=null,c&&u?(h=d=!0,n=0):(n--,l=n>0?i[n-1]:-1,h=d=!1),t=!0)),l++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push([s,""]);for(var t,i=0,n=0,a=0,l="",c="";i<e.length;)switch(e[i][0]){case o:a++,c+=e[i][1],i++;break;case r:n++,l+=e[i][1],i++;break;case s:n+a>1?(0!==n&&0!==a&&(t=this.diff_commonPrefix(c,l),0!==t&&(i-n-a>0&&e[i-n-a-1][0]==s?e[i-n-a-1][1]+=c.substring(0,t):(e.splice(0,0,[s,c.substring(0,t)]),i++),c=c.substring(t),l=l.substring(t)),t=this.diff_commonSuffix(c,l),0!==t&&(e[i][1]=c.substring(c.length-t)+e[i][1],c=c.substring(0,c.length-t),l=l.substring(0,l.length-t))),0===n?e.splice(i-a,n+a,[o,c]):0===a?e.splice(i-n,n+a,[r,l]):e.splice(i-n-a,n+a,[r,l],[o,c]),i=i-n-a+(n?1:0)+(a?1:0)+1):0!==i&&e[i-1][0]==s?(e[i-1][1]+=e[i][1],e.splice(i,1)):i++,a=0,n=0,l="",c=""}""===e[e.length-1][1]&&e.pop();var u=!1;for(i=1;i<e.length-1;)e[i-1][0]==s&&e[i+1][0]==s&&(e[i][1].substring(e[i][1].length-e[i-1][1].length)==e[i-1][1]?(e[i][1]=e[i-1][1]+e[i][1].substring(0,e[i][1].length-e[i-1][1].length),e[i+1][1]=e[i-1][1]+e[i+1][1],e.splice(i-1,1),u=!0):e[i][1].substring(0,e[i+1][1].length)==e[i+1][1]&&(e[i-1][1]+=e[i+1][1],e[i][1]=e[i][1].substring(e[i+1][1].length)+e[i+1][1],e.splice(i+1,1),u=!0)),i++;u&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var i,n=0,s=0,a=0,l=0;for(i=0;i<e.length&&(e[i][0]!==o&&(n+=e[i][1].length),e[i][0]!==r&&(s+=e[i][1].length),!(n>t));i++)a=n,l=s;return e.length!=i&&e[i][0]===r?l:l+(t-a)},n.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,a=/>/g,l=/\n/g,c=0;c<e.length;c++){var u=e[c][0],h=e[c][1],d=h.replace(i,"&amp;").replace(n,"&lt;").replace(a,"&gt;").replace(l,"&para;<br>");switch(u){case o:t[c]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case r:t[c]='<del style="background:#ffe6e6;">'+d+"</del>";break;case s:t[c]="<span>"+d+"</span>"}}return t.join("")},n.prototype.diff_prettyCompactHtml=function(e){for(var t=[],i=0;i<e.length;i++){var n=0===i,a=i===e.length-1,l=e[i][0],c=e[i][1];switch(l){case o:t[i]='<ins style="background:#e6ffe6;">'+this.prepare_text_(c)+"</ins>";break;case r:t[i]='<del style="background:#ffe6e6;">'+this.prepare_text_(c)+"</del>";break;case s:t[i]="<span>"+this.truncate_context_(c,n,a)+"</span>"}}return t.join("")},n.prototype.prepare_text_=function(e){var t=/&/g,i=/</g,n=/>/g,r=/\n/g;return e.replace(t,"&amp;").replace(i,"&lt;").replace(n,"&gt;").replace(r,"&para;<br>")},n.prototype.truncate_context_=function(e,t,i){var n=e.split(/\r\n|\r|\n/),r='<span class="dots">...</span>',o=n.length,s=4;return o<=s?this.prepare_text_(e):!t&&!i&&o<=2*s?this.prepare_text_(e):t?r+this.prepare_text_("\n"+n.slice(-s).join("\n")):i?this.prepare_text_(n.slice(0,s).join("\n")+"\n")+r:this.prepare_text_(n.slice(0,s).join("\n")+"\n")+r+this.prepare_text_("\n"+n.slice(-s).join("\n"))},n.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==o&&(t[i]=e[i][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==r&&(t[i]=e[i][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,i=0,n=0,a=0;a<e.length;a++){var l=e[a][0],c=e[a][1];switch(l){case o:i+=c.length;break;case r:n+=c.length;break;case s:t+=Math.max(i,n),i=0,n=0}}return t+=Math.max(i,n)},n.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case o:t[i]="+"+encodeURI(e[i][1]);break;case r:t[i]="-"+e[i][1].length;break;case s:t[i]="="+e[i][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var i=[],n=0,a=0,l=t.split(/\t/g),c=0;c<l.length;c++){var u=l[c].substring(1);switch(l[c].charAt(0)){case"+":try{i[n++]=[o,decodeURI(u)]}catch(h){throw new Error("Illegal escape in diff_fromDelta: "+u)}break;case"-":case"=":var d=parseInt(u,10);if(isNaN(d)||d<0)throw new Error("Invalid number in diff_fromDelta: "+u);var f=e.substring(a,a+=d);"="==l[c].charAt(0)?i[n++]=[s,f]:i[n++]=[r,f];break;default:if(l[c])throw new Error("Invalid diff operation in diff_fromDelta: "+l[c])}}if(a!=e.length)throw new Error("Delta length ("+a+") does not equal source text length ("+e.length+").");return i},n.prototype.match_main=function(e,t,i){if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},n.prototype.match_bitap_=function(e,t,i){function n(e,n){var r=e/t.length,s=Math.abs(i-n);return o.Match_Distance?r+s/o.Match_Distance:s?1:r}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),o=this,s=this.Match_Threshold,a=e.indexOf(t,i);a!=-1&&(s=Math.min(n(0,a),s),a=e.lastIndexOf(t,i+t.length),a!=-1&&(s=Math.min(n(0,a),s)));var l=1<<t.length-1;a=-1;for(var c,u,h,d=t.length+e.length,f=0;f<t.length;f++){for(c=0,u=d;c<u;)n(f,i+u)<=s?c=u:d=u,u=Math.floor((d-c)/2+c);d=u;var p=Math.max(1,i-u+1),g=Math.min(i+u,e.length)+t.length,v=Array(g+2);v[g+1]=(1<<f)-1;for(var y=g;y>=p;y--){var m=r[e.charAt(y-1)];if(0===f?v[y]=(v[y+1]<<1|1)&m:v[y]=(v[y+1]<<1|1)&m|((h[y+1]|h[y])<<1|1)|h[y+1],v[y]&l){var _=n(f,y-1);if(_<=s){if(s=_,a=y-1,!(a>i))break;p=Math.max(1,2*i-a)}}}if(n(f+1,i)>s)break;h=v}return a},n.prototype.match_alphabet_=function(e){for(var t={},i=0;i<e.length;i++)t[e.charAt(i)]=0;for(var i=0;i<e.length;i++)t[e.charAt(i)]|=1<<e.length-i-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var i=t.substring(e.start2,e.start2+e.length1),n=0;t.indexOf(i)!=t.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=t.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=t.substring(e.start2-n,e.start2);r&&e.diffs.unshift([s,r]);var o=t.substring(e.start2+e.length1,e.start2+e.length1+n);o&&e.diffs.push([s,o]),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+o.length,e.length2+=r.length+o.length}},n.prototype.patch_make=function(e,t,i){var a,l;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof i)a=e,l=this.diff_main(a,t,!0),l.length>2&&(this.diff_cleanupSemantic(l),this.diff_cleanupEfficiency(l));else if(e&&"object"==typeof e&&"undefined"==typeof t&&"undefined"==typeof i)l=e,a=this.diff_text1(l);else if("string"==typeof e&&t&&"object"==typeof t&&"undefined"==typeof i)a=e,l=t;else{if("string"!=typeof e||"string"!=typeof t||!i||"object"!=typeof i)throw new Error("Unknown call format to patch_make.");a=e,l=i}if(0===l.length)return[];for(var c=[],u=new n.patch_obj,h=0,d=0,f=0,p=a,g=a,v=0;v<l.length;v++){var y=l[v][0],m=l[v][1];switch(h||y===s||(u.start1=d,u.start2=f),y){case o:u.diffs[h++]=l[v],u.length2+=m.length,g=g.substring(0,f)+m+g.substring(f);break;case r:u.length1+=m.length,u.diffs[h++]=l[v],g=g.substring(0,f)+g.substring(f+m.length);break;case s:m.length<=2*this.Patch_Margin&&h&&l.length!=v+1?(u.diffs[h++]=l[v],u.length1+=m.length,u.length2+=m.length):m.length>=2*this.Patch_Margin&&h&&(this.patch_addContext_(u,p),c.push(u),u=new n.patch_obj,h=0,p=g,d=f)}y!==o&&(d+=m.length),y!==r&&(f+=m.length)}return h&&(this.patch_addContext_(u,p),c.push(u)),c},n.prototype.patch_deepCopy=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],o=new n.patch_obj;o.diffs=[];for(var s=0;s<r.diffs.length;s++)o.diffs[s]=r.diffs[s].slice();o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,t[i]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,a=[],l=0;l<e.length;l++){var c,u=e[l].start2+n,h=this.diff_text1(e[l].diffs),d=-1;if(h.length>this.Match_MaxBits?(c=this.match_main(t,h.substring(0,this.Match_MaxBits),u),c!=-1&&(d=this.match_main(t,h.substring(h.length-this.Match_MaxBits),u+h.length-this.Match_MaxBits),(d==-1||c>=d)&&(c=-1))):c=this.match_main(t,h,u),c==-1)a[l]=!1,n-=e[l].length2-e[l].length1;else{a[l]=!0,n=c-u;var f;if(f=d==-1?t.substring(c,c+h.length):t.substring(c,d+this.Match_MaxBits),h==f)t=t.substring(0,c)+this.diff_text2(e[l].diffs)+t.substring(c+h.length);else{var p=this.diff_main(h,f,!1);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(p)/h.length>this.Patch_DeleteThreshold)a[l]=!1;else{this.diff_cleanupSemanticLossless(p);for(var g,v=0,y=0;y<e[l].diffs.length;y++){var m=e[l].diffs[y];m[0]!==s&&(g=this.diff_xIndex(p,v)),m[0]===o?t=t.substring(0,c+g)+m[1]+t.substring(c+g):m[0]===r&&(t=t.substring(0,c+g)+t.substring(c+this.diff_xIndex(p,v+m[1].length))),m[0]!==r&&(v+=m[1].length)}}}}}return t=t.substring(i.length,t.length-i.length),[t,a]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,i="",n=1;n<=t;n++)i+=String.fromCharCode(n);for(var n=0;n<e.length;n++)e[n].start1+=t,e[n].start2+=t;var r=e[0],o=r.diffs;if(0==o.length||o[0][0]!=s)o.unshift([s,i]),r.start1-=t,r.start2-=t,r.length1+=t,r.length2+=t;else if(t>o[0][1].length){var a=t-o[0][1].length;o[0][1]=i.substring(o[0][1].length)+o[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}if(r=e[e.length-1],o=r.diffs,0==o.length||o[o.length-1][0]!=s)o.push([s,i]),r.length1+=t,r.length2+=t;else if(t>o[o.length-1][1].length){var a=t-o[o.length-1][1].length;o[o.length-1][1]+=i.substring(0,a),r.length1+=a,r.length2+=a}return i},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,i=0;i<e.length;i++)if(!(e[i].length1<=t)){var a=e[i];e.splice(i--,1);for(var l=a.start1,c=a.start2,u="";0!==a.diffs.length;){var h=new n.patch_obj,d=!0;for(h.start1=l-u.length,h.start2=c-u.length,""!==u&&(h.length1=h.length2=u.length,h.diffs.push([s,u]));0!==a.diffs.length&&h.length1<t-this.Patch_Margin;){var f=a.diffs[0][0],p=a.diffs[0][1];f===o?(h.length2+=p.length,c+=p.length,h.diffs.push(a.diffs.shift()),d=!1):f===r&&1==h.diffs.length&&h.diffs[0][0]==s&&p.length>2*t?(h.length1+=p.length,l+=p.length,d=!1,h.diffs.push([f,p]),a.diffs.shift()):(p=p.substring(0,t-h.length1-this.Patch_Margin),h.length1+=p.length,l+=p.length,f===s?(h.length2+=p.length,c+=p.length):d=!1,h.diffs.push([f,p]),p==a.diffs[0][1]?a.diffs.shift():a.diffs[0][1]=a.diffs[0][1].substring(p.length))}u=this.diff_text2(h.diffs),u=u.substring(u.length-this.Patch_Margin);var g=this.diff_text1(a.diffs).substring(0,this.Patch_Margin);""!==g&&(h.length1+=g.length,h.length2+=g.length,0!==h.diffs.length&&h.diffs[h.diffs.length-1][0]===s?h.diffs[h.diffs.length-1][1]+=g:h.diffs.push([s,g])),d||e.splice(++i,0,h)}}},n.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var i=e.split("\n"),a=0,l=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;a<i.length;){var c=i[a].match(l);if(!c)throw new Error("Invalid patch string: "+i[a]);var u=new n.patch_obj;for(t.push(u),u.start1=parseInt(c[1],10),""===c[2]?(u.start1--,u.length1=1):"0"==c[2]?u.length1=0:(u.start1--,u.length1=parseInt(c[2],10)),u.start2=parseInt(c[3],10),""===c[4]?(u.start2--,u.length2=1):"0"==c[4]?u.length2=0:(u.start2--,u.length2=parseInt(c[4],10)),a++;a<i.length;){var h=i[a].charAt(0);try{var d=decodeURI(i[a].substring(1))}catch(f){throw new Error("Illegal escape in patch_fromText: "+d)}if("-"==h)u.diffs.push([r,d]);else if("+"==h)u.diffs.push([o,d]);else if(" "==h)u.diffs.push([s,d]);else{if("@"==h)break;if(""!==h)throw new Error('Invalid patch mode "'+h+'" in: '+d)}a++}}return t},n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},n.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var i,n=["@@ -"+e+" +"+t+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case o:i="+";break;case r:i="-";break;case s:i=" "}n[a+1]=i+encodeURI(this.diffs[a][1])+"\n"}return n.join("").replace(/%20/g," ")},t.exports=n},{}],40:[function(e,t,i){var n=logger.create("electronRunner").debug,r=e("path"),o=e("child_process"),s=e("./runWorkerPool"),a=e("./browserEnvironment"),l=0,c=function(e){var t=this;t._project=e,t._screenShotReady=Q.when(!0),t._params=e.settings().env.params,t._runner=e.settings().env.runner,t._envOptions=e.settings().env.options,t._clearMemoryCache=e.settings().env.clearMemoryCache,t._host=void 0,t._callbacks=Object.create(null),t._hostPromise=Q.promise(function(e,i){try{var n=_.extend({},process.env,t._params.env?_.reduce(t._params.env.split(";"),function(e,t){var i=t.split("=");return e[i[0]]=i[1],e},{}):{});delete n.ATOM_SHELL_INTERNAL_RUN_AS_NODE,delete n.ELECTRON_RUN_AS_NODE,n.ELECTRON_DISABLE_SECURITY_WARNINGS=!0,t._host=o.fork(r.join(__dirname,"runners","browser","electronHost.js"),[],{execPath:t._runner,env:n,execArgv:t._params.runner?t._params.runner.split(" "):[]}),t._host.on("error",function(e){t._handleHostError(e)}),t._host.on("message",function(i){try{i.id?t._responseWithCorrelationId(i):"ready"===i.type?e(t._host):"error"===i.type&&t._handleHostError(i.error)}catch(n){t._handleHostError(n)}})}catch(s){i(s)}})["catch"](function(e){t._handleHostError(e)}),t._workerPool=new s(t._project,{create:_.bind(t._create,t),recycle:_.bind(t._recycle,t),healthy:function(){return!0},prepare:_.bind(t._prepare,t)}),t._browserEnvironment=new a(e,t._workerPool)};c.prototype={run:function(e){var t=this;return t._workerPool.run(e)},_handleHostError:function(e){var t=this;e=e||{},t._project._cleanStack(e);var i="Electron runner error: "+(e.message||"unknown"),n=e.stack||i;console.error(n),t._project._emitTestRunError(i)},_create:function(e,t){var i=this;i._hostPromise.then(function(){t({pageId:e})})},_recycle:function(e){var t=this;t._host&&t._host.send({type:"closePage",pageId:e.pageId})},_evaluateOnPage:function(e,t,i){var n=this,r={type:"evaluateOnPage",pageId:e,action:"("+t.toString()+")()"};n._requestWithCorrelationId(r,i||_.noop)},_openPage:function(e,t,i,n){var r=this,o={type:"openPage",pageId:e,url:t,options:i};r._requestWithCorrelationId(o,n||_.noop)},_closePage:function(e){var t=this;t._host.send({type:"closePage",pageId:e})},_capturePage:function(e,t){var i=this,n=Q.defer();try{i._requestWithCorrelationId({type:"capturePage",file:t,pageId:e},function(){n.resolve()}),i._screenShotReady=n.promise}catch(r){n.reject(new Error("Failed to render test run screen shot")),console.error("Failed to render test run screen shot",r.message)}},_prepare:function(e,t){var i=this,r=_.randomId(),o=i._browserEnvironment.sandboxName(t,r);return n("Starting sandbox [%s]",o),i._workerPool.getWorker(t).then(function(){return i._workerPool.cancelled()?Q.reject({runCancelled:!0}):(n("Preparing sandbox [%s]",o),i._browserEnvironment.prepareSandbox(e,r,t))}).then(function(e){return i._workerPool.cancelled()?Q.reject({runCancelled:!0}):(n("Prepared sandbox [%s]",o),Q.when({instance:{resume:function(){i._evaluateOnPage(t,function(){$_$tracer.resume()})},ping:function(e){i._evaluateOnPage(t,function(){},e)},close:function(e){i._closePage(t),e(!0)},closing:function(){i._screenShotReady=Q.when()},start:function(n){i._openPage(t,e,i._envOptions,function(e){n(e.status)&&i._evaluateOnPage(t,function(){$_$tracer.start()})})}},name:o,sessionId:r,workerId:t}))})},cancel:function(e){var t=this;return t._workerPool.cancel(e)},start:function(){var e=this;return e._workerPool.start(e._browserEnvironment.webApp()).then(function(t){return e._workerPool.setFileRoot(e._browserEnvironment.sandboxRootUrl()),Q.when(t)})},stop:function(){var e=this;e._host&&(e._host.send({type:"stop"}),e._host.disconnect(),delete e._callbacks,delete e._host),e._workerPool.stop()},_requestWithCorrelationId:function(e,t){var i=this,n=++l,r=i._callbacks[n]={done:t};e.id=n,i._host.send(e),r.timeout=setTimeout(function(){delete i._callbacks[n]},12e5)},_responseWithCorrelationId:function(e){var t=this._callbacks[e.id];delete this._callbacks[e.id],t&&(clearTimeout(t.timeout),t.done(e))}},t.exports=c},{"./browserEnvironment":10,"./runWorkerPool":63,child_process:void 0,path:void 0}],41:[function(e,t,i){var n=function(e){return e&&e.replace(/^\s+|\s+$/gm,"")},r=["January","February","March","April","May","June","July","August","September","October","November","December"],o="wallabyjs@gmail.com";t.exports={wallabyEmail:function(){return o},normalizePath:function(e){return"win32"===process.platform&&e?e.replace(/\\/g,"/"):e},parseKey:function(e){var t={};if(e){var i=e.split(":");2===i.length&&(e=n(i[1]))}var s=Buffer.from(e,"base64").toString().split("\n");t.licenseeName=s[0],t.licenseTags=s[1];var a=t.licenseTags.split(",")||[];t.licenseeEmail=a[0],t.licensedProduct=a[1],t.multiUserKey=a[2],t.source=a[3],t.trial="1"===a[5],t.expirationDateString=s[2],t.licenseSignature=s[3],t.freeLicense=t.licenseeEmail===o;try{var l=t.expirationDateString.split("/");t.expirationDateStringFormatted=l[0]+" "+r[parseInt(l[1],10)-1]+" "+l[2]}catch(c){t.expirationDateStringFormatted=t.expirationDateString}return t},format:function(e,t){return e.replace(/\{([0-9a-zA-Z_]+)\}/g,function(i,n,r){var o;return"{"===e[r-1]&&"}"===e[r+i.length]?n:(o=t.hasOwnProperty(n)?t[n]:null,null===o||void 0===o?"":o)})},validPackageName:function(e){if(e&&!e.match(/^\./)&&!e.match(/^_/)&&!(e.length>214||e.toLowerCase()!==e||/[~'!()*]/.test(e.split("/").slice(-1)[0]))){if(encodeURIComponent(e)===e)return e;var t=e.match(/^(?:@([^\/]+?)[\/])?([^\/]+?)$/);if(t){var i=t[1],n=t[2];if(encodeURIComponent(i)===i&&encodeURIComponent(n)===n)return e}}},withFreePort:function(t){var i=e("http"),n=i.createServer();n.listen(0),n.on("listening",function(){var e=n.address().port;n.once("close",function(){t(e)}),n.close()}),process.nextTick(function(){})},checkPort:function(t){var i=e("net"),n=function(e){return function(n){var r=i.createServer().once("error",function(e){return n(e&&"EADDRNOTAVAIL"===e.code?t:0)}).once("listening",function(){return r.once("close",function(){return n(t)}).close()}).listen(t,e)}},r=function(e){return new Promise(n(e))};return r("0.0.0.0").then(function(e){return e?r("127.0.0.1"):0}).then(function(e){return e?r("::1"):0})}}},{http:void 0,net:void 0}],42:[function(e,t,i){var n=e("path"),r=e("parseurl"),o=e("mime"),s=e("graceful-fs"),a=new Map,l=function(e,t,i){e.set({"Cache-Control":"public, max-age=86400",Expires:new Date(Date.now()+864e5).toUTCString()}),e.type(o.lookup(i,"text/plain")),e.status(200).end(t)};t.exports={create:function(e,t){var i=logger.create("middleware").trace,o=e.main.cache?e.main.cache:a;return e.main.read=e.main.read?e.main.read:s.readFile,e.alt&&(e.alt.cache||(e.alt.cache={get:function(){return null},set:function(){return null}}),e.alt.read=e.alt.read?e.alt.read:s.readFile),function(s,a){var c=decodeURI(r(s).pathname);"/"===c&&(c="");var u=e.main.root;i("Preparing to serve %s",c||u);var h=n.normalize(n.join(u,c)),d=o.get(h);if(_.isString(d)||d instanceof Buffer)i("Serving %s from cache",c||u),l(a,d,h);else{var f=function(e,r,o,s){o?e?(u=e.root,i("Serving %s from disk (alt. location)",c||u),h=n.normalize(n.join(u,c)),e.read(h,f.bind(null,null,e.cache))):(i("Error when reading file %s, %s",h,o&&o.message||"unknown"),t&&console.error("Trying to access missing resource or API: "+c),a.status(404).end()):(r.set(h,s),l(a,s,h))};i("Serving %s from disk",c||u),e.main.read(h,f.bind(null,e.alt,o))}}}}},{"graceful-fs":void 0,mime:void 0,parseurl:void 0,path:void 0}],43:[function(e,t,i){global._=e("lodash"),global.Q=e("q"),global.EventEmitter=e("events").EventEmitter,Q.longStackSupport=!1,global.Promise||(global.Promise=Q.Promise),_.extend(_,e("./utils")),_.str=e("underscore.string"),_.mixin(_.str.exports()),global.logger=e("./logger"),_["_"+["nwh","zik","jqj","6"].join("")]=["nwh","zik","jqj","6"].join("")},{"./logger":45,"./utils":72,events:void 0,lodash:void 0,q:void 0,"underscore.string":void 0}],44:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},o=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=e("acorn");a=a.Parser.extend(e("./acornTolerancePlugin"),e("./acornTopLevelAwaitPlugin"),e("./acornLogicalAssignment"),e("./acornImportMetaPlugin"),e("./acornNumericSeparatorPlugin.js"),e("acorn-jsx")());var l=e("escodegen-wallaby"),c=40,u="Babel.objectSpread",h="Babel.React.createElement",d=1,f=2,p=function(e){if(0===e.indexOf("__REGEXP ")){var t=e.split("__REGEXP ")[1].match(/\/(.*)\/(.*)?/);return new RegExp(t[1],t[2]||"")}return e},g=function(e){var t=this;if(this._autoLogHints={},this._loggedRanges={},this._liveCommentLines={},this._ignoreCoverageHints=[],this._ignoreCoverageHints.lastHintPosition=-1,this._ignoreFileCoverage=!1,this._logMarkers=e.recordValues?e.logMarkers:void 0,this._extractedComments=e.extractedComments,this._extractedComments&&this._extractedComments.isCoverageIgnored&&(this._ignoreFileCoverage=!0),e.hints&&(this._extractedComments||this._ignoreFileCoverage||(e.hints.ignoreCoverage&&(this._ignoreCoverageRegExp=p(e.hints.ignoreCoverage)),e.hints.ignoreCoverageForFile&&(this._ignoreFileCoverageRegExp=p(e.hints.ignoreCoverageForFile))),e.recordValues&&e.hints.commentAutoLog&&(_.isString(e.hints.commentAutoLog)?this._autoLogHintExpPrefix=e.hints.commentAutoLog:(this._autoLogHintExpPrefix=e.hints.commentAutoLog.value,this._autoLogHintGlobalExp=e.hints.commentAutoLog.exp)),e.hints.testFileSelection&&(e.hints.testFileSelection.include&&(this._includeTestFileRegExp=p(e.hints.testFileSelection.include)),e.hints.testFileSelection.exclude&&(this._excludeTestFileRegExp=p(e.hints.testFileSelection.exclude)))),this._opts=_.defaults(e||{},{}),this._opts.recordValues||(this._wrapExpressionStatementExpressionIntoVisitor=function(e){return e}),this._opts.test){var i=this._opts.testFileChangeStart;if(this._logMarkers){var n=t._logMarkers.find(function(e){return e["new"]&&e.range});n&&(i={line:n.range[0],column:n.range[1]})}t._containsChangePosition=i&&i.line?function(e){return e&&e.loc.start.line<=i.line&&e.loc.end.line>=i.line&&(i.line>e.loc.start.line||i.column>e.loc.start.column)&&(i.line<e.loc.end.line||i.column<e.loc.end.column)}:function(e){return e&&e.start<t._opts.testFileChangeStart&&e.end>t._opts.testFileChangeStart}}else this._containsChangePosition=function(){return!1};t._visitor=this._createVisitor(),t._opts.sequenceExpressionToDiff||(t._replaceSequenceWithDiff=function(){}),t._opts.automaticTestFileSelection&&t._visitor.CallExpression.add(function(e){e.arguments&&e.arguments[0]&&"Literal"===e.arguments[0].type&&(e.callee&&"Identifier"===e.callee.type&&"fit"===e.callee.name&&2===e.arguments.length&&(t._includedTestFile=!0),e.callee&&"Identifier"===e.callee.type&&"fdescribe"===e.callee.name&&2===e.arguments.length?t._includedTestFile=!0:e.callee&&"MemberExpression"===e.callee.type&&e.callee.property&&"Identifier"===e.callee.property.type&&"only"===e.callee.property.name&&(2===e.arguments.length||3===e.arguments.length)&&(t._includedTestFile=!0))}),t._opts.recordMatchSnapshotRanges&&(t._matchSnapshotRanges=[],t._visitor.CallExpression.add(function(e){e.callee&&"MemberExpression"===e.callee.type&&e.callee.property&&"Identifier"===e.callee.property.type&&("toMatchSnapshot"===e.callee.property.name||"toThrowErrorMatchingSnapshot"===e.callee.property.name)&&(e.callee.object=t._sequence([{type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"$_$tracer"},property:{type:"Identifier",name:"_beforeMatchSnapshot"}},arguments:[t._literal(t._opts.file),t._literal(t._matchSnapshotRanges.length)]},e.callee.object]),t._matchSnapshotRanges.push([e.loc.start.line,e.loc.start.column,e.loc.end.line,e.loc.end.column]))})),t._visitor.IfStatement.add(function(e){e.consequent&&"BlockStatement"!==e.consequent.type&&(e.consequent=t._wrapInBlock([e.consequent])),e.alternate&&"BlockStatement"!==e.alternate.type&&"IfStatement"!==e.alternate.type&&(e.alternate=t._wrapInBlock([e.alternate]))}),t._visitor.add([this._visitor.DoWhileStatement,this._visitor.WhileStatement,this._visitor.IfStatement,this._visitor.ForStatement],function(e,i){if(e.test&&(e.test=t._instructionValueSequence([t._instruction(e.test,i,"TST"),e.test],i,void 0,1)),e.update){var n=t._wrapIfMarkedForAutoLog(e.update,i);n&&(e.update=n)}}),t._visitor.add([this._visitor.ForOfStatement,this._visitor.ForInStatement],function(e,i){e.right&&(e.right=t._instructionValueSequence([t._instruction(e.right,i,"FR"),e.right],i))}),t._visitor.SwitchStatement.add(function(e,i){e.discriminant=t._instructionValueSequence([t._instruction(e.discriminant,i,"SWT"),e.discriminant],i)}),t._visitor.SwitchCase.add(function(e){e.consequent&&e.consequent.length>0&&(1!=e.consequent.length||"BlockStatement"!==e.consequent[0].type)&&(e.consequent=[t._wrapInBlock(e.consequent)])}),t._visitor.add([t._visitor.DoWhileStatement,t._visitor.ForInStatement,t._visitor.ForStatement,t._visitor.ForOfStatement,t._visitor.LabeledStatement,t._visitor.WhileStatement,t._visitor.WithStatement],function(e){e.body&&"BlockStatement"!==e.body.type&&("LabeledStatement"!==e.type||"DoWhileStatement"!==e.body.type&&"ForInStatement"!==e.body.type&&"ForStatement"!==e.body.type&&"WhileStatement"!==e.body.type)&&"ForOfStatement"!==e.body.type&&(e.body=t._wrapInBlock([e.body]))}),t._visitor.add([t._visitor.BreakStatement,t._visitor.ContinueStatement,t._visitor.ThrowStatement],function(e,i){if(!i.parentNode||"ForStatement"!==i.parentNode.type&&"ForInStatement"!==i.parentNode.type&&"ForOfStatement"!==i.parentNode.type&&"ExportDeclaration"!==i.parentNode.type){var n=[t._instructionStatement(e,i,"S"),e];i.replacement=t._wrapInBlock(n)}}),t._visitor.VariableDeclaration.add(function(e,i){if((!i.parentNode||"ForStatement"!==i.parentNode.type&&"ForInStatement"!==i.parentNode.type&&"ForOfStatement"!==i.parentNode.type&&"ExportDeclaration"!==i.parentNode.type&&"ExportNamedDeclaration"!==i.parentNode.type)&&e.declarations&&e.declarations.length&&"VariableDeclarator"===e.declarations[0].type){var n=e.declarations[0],r=t._instruction(e,i,"S");if(!n.init||"FunctionExpression"!==n.init.type&&"ArrowFunctionExpression"!==n.init.type&&"ClassExpression"!==n.init.type)if(n.init){var o=t._getNodesToCheckForAutoLogsInVariableDeclaration(e,n);n.init=t._instructionValueSequence([r,n.init],i,o)}else"var"===e.kind?n.init={type:"LogicalExpression",operator:"||",
left:r,right:{type:"Identifier",name:n.id.name}}:n.init=r;else"Literal"!==r.type&&e.declarations.unshift({type:"VariableDeclarator",id:{type:"Identifier",name:"$_$wvd"+t._ranges.length},init:r});for(var s=1;s<e.declarations.length;s++){var a=e.declarations[s];if("VariableDeclarator"===a.type&&a.init&&"FunctionExpression"!==a.init.type&&"ArrowFunctionExpression"!==a.init.type&&"ClassExpression"!==a.init.type){var o=t._getNodesToCheckForAutoLogsInVariableDeclaration(e,a),l=t._wrapIfMarkedForAutoLog(a.init,i,!1,o);l&&(a.init=l)}}}}),t._visitor.ExpressionStatement.add(function(e,i){t._replaceConsoleLog(e.expression,i);var n=[],r=e.expression,o=t._replaceSequenceWithDiff(e);if(o&&n.push(r),!e._systemJsRegisterCall)if(e.expression&&"YieldExpression"===e.expression.type){var s=t._wrapIfMarkedForAutoLog(e.expression.argument,i,void 0,[e.expression,e]);s&&(e.expression.argument=s),e.expression=t._sequence([t._instruction(e,i,"S"),e.expression])}else{var a=i.hinted?e.expression:t._wrapExpressionStatementExpressionIntoVisitor(e.expression,e);a===e.expression&&n.push(e),e.expression=t._instructionValueSequence([t._instruction(e,i,"S"),a],i,n)}}),t._visitor.ReturnStatement.add(function(e,i){t._replaceConsoleLog(e.argument,i),e.argument=e.argument?t._instructionValueSequence([t._instruction(e,i,"R"),e.argument],i,[e],-(e.end-e.start-6)):t._instruction(e,i,"R")}),t._visitor.ConditionalExpression.add(function(e,i){t._replaceConsoleLog(e.consequent,i),e.consequent=t._instructionValueSequence([t._instruction(e.consequent,i,"CDC"),e.consequent],i),t._replaceConsoleLog(e.alternate,i),e.alternate=t._instructionValueSequence([t._instruction(e.alternate,i,"CDA"),e.alternate],i)}),t._visitor.LogicalExpression.add(function(e,i){e.left=t._instructionValueSequence([t._instruction(e.left,i,"LGL"),e.left],i),e.right=t._instructionValueSequence([t._instruction(e.right,i,"LGR"),e.right],i)}),t._visitor.Program.add(function(e,i){var n;_.isEmpty(t._autoLogHints)&&(t._visitor.removeVisitorsAddedForAutoLogHintsOnly(),t._getFunctionParameterLogInstructions=function(){return[]},t._getNodesToCheckForAutoLogsInVariableDeclaration=function(){return[]}),e.body=e.body||[];var o=e.body[0],s=1===e.body.length&&t._isSystemJsModule(o),a=t._scopeStartVariableDeclaration("P");t._needsToStayFirst(o)?e.body.splice(0,1,t._firstNode(o),a):s&&s.length?(o._systemJsRegisterCall=!0,(n=e.body).splice.apply(n,r([1,0],[a,t._instructionStatement(e.body[0],i,"S")],!1))):e.body.unshift(a),e.body.push(t._instructionStatement(e,i,"PE"))}),t._visitor.add([t._visitor.FunctionDeclaration,t._visitor.FunctionExpression,t._visitor.ArrowFunctionExpression],function(e,i){var n,s;t._numberOfFunctions++,t._tryFindTestName(e,i),"ArrowFunctionExpression"===e.type&&e.expression&&(e.body=t._wrapInBlock([t._return(t._instructionValueSequence([t._instruction(e.body,i,"R"),e.body],i))]),e.expression=!1);var a=t._scopeStartVariableDeclaration("F"),l=t._getFunctionParameterLogInstructions(e,i),c=e.body.body[0],u=t._needsToStayFirst(c),h=t._isSuperCall(c);u?(e.body.body.splice(0,1,t._firstNode(c),a),(n=e.body.body).splice.apply(n,r([2,0],o(l),!1))):h?t._handleSuperCall(e.body.body,i,a,l):(s=e.body.body).unshift.apply(s,r([a],o(l),!1))}),t._visitor.ImportBatchSpecifier.add(function(e){e.type="ImportNamespaceSpecifier",e.id=e.name,delete e.name}),t._visitor.ImportSpecifier.add(function(e){e["default"]&&(e.type="ImportDefaultSpecifier")}),t._visitor.AssignmentPattern.add(function(e){"="===e.operator&&(e.type="AssignmentExpression")}),t._visitor.add([t._visitor.ExportNamedDeclaration,t._visitor.ExportDefaultDeclaration,t._visitor.ExportAllDeclaration,t._visitor.ImportDeclaration],function(){t._esm=!0}),t._visitor.CatchClause.addForAutoLogOnly(function(e,i){if(e.body&&e.body.body&&e.param&&"Identifier"===e.param.type){var n=t._getAutoLogHint(e)||t._getAutoLogHint(e.param);n&&e.param.name&&e.body.body.unshift({type:"ExpressionStatement",expression:t._generateUndefinedAutoLogNode(e.param,i,n)})}}),t._visitor.ObjectPattern.addForAutoLogOnly(function(e,t){e.properties.forEach(function(e){e.ignore=!0})}),t._visitor.Property.addForAutoLogOnly(function(e,i){if(!e.ignore&&e.value&&"ObjectPattern"!==i.parentNode.type&&!e.method){var n=[];!e.computed&&e.key&&"Identifier"===e.key.type&&n.push(e.key);var r=t._wrapIfMarkedForAutoLog(e.value,i,!1,n);r&&(e.shorthand=!1,e.value=r)}}),t._visitor.WithStatement.addForAutoLogOnly(function(e,i){if(e.object){var n=t._wrapIfMarkedForAutoLog(e.object,i,!1);n&&(e.object=n)}}),t._visitor.SpreadElement.addForAutoLogOnly(function(e,i){if(e.argument){var n=t._wrapIfMarkedForAutoLog(e.argument,i,!1,[e]);n&&(e.argument=n)}}),["ForInStatement","ForOfStatement"].forEach(function(e){t._visitor[e].addForAutoLogOnly(function(e,i){if(e.body&&"BlockStatement"===e.body.type&&e.left)if("Identifier"===e.left.type){var n=t._getAutoLogHint(e)||t._getAutoLogHint(e.left);n&&e.body.body.unshift(t._generateUndefinedAutoLogNode(e.left,i,n,!0))}else if("VariableDeclaration"===e.left.type&&1===e.left.declarations.length){var n=t._getAutoLogHint(e)||t._getAutoLogHint(e.left)||t._getAutoLogHint(e.left.declarations[0]);n&&e.body.body.unshift(t._generateUndefinedAutoLogNode(e.left.declarations[0].id,i,n,!0))}})}),t._visitor.ThrowStatement.addForAutoLogOnly(function(e,i){if(e.argument){var n=[e],r=t._wrapIfMarkedForAutoLog(e.argument,i,!1,n);r&&(e.argument=r)}}),t._visitor.MemberExpression.addForAutoLogOnly(function(e,i){if(e.object){var n=t._wrapIfMarkedForAutoLog(e.object,i);n&&(e.object=n)}if(e.property)if(e.computed){var n=t._wrapIfMarkedForAutoLog(e.property,i);n&&(e.property=n)}else if(!i.parentNode||!(t._isInstrumented(e,i)||"AssignmentExpression"===i.parentNode.type&&i.parentNode.left===e||"CallExpression"===i.parentNode.type&&i.parentNode.callee===e||"NewExpression"===i.parentNode.type&&i.parentNode.callee===e||"UpdateExpression"===i.parentNode.type&&i.parentNode.argument===e||"UnaryExpression"===i.parentNode.type&&i.parentNode.argument===e&&"delete"===i.parentNode.operator)){var n=t._wrapIfMarkedForAutoLog(e,i,!1,[e.property]);n&&(i.replacement=n)}}),t._visitor.BinaryExpression.addForAutoLogOnly(function(e,i){if(e.left){var n=t._wrapIfMarkedForAutoLog(e.left,i);n&&(e.left=n)}if(e.right){var r=t._wrapIfMarkedForAutoLog(e.right,i);r&&(e.right=r)}}),t._visitor.CallExpression.addForAutoLogOnly(function(e,i){if(e.arguments&&e.arguments.length)for(var n=0,r=e.arguments.length;n<r;n++)if("SpreadElement"!==e.arguments[n].type){var o=t._wrapIfMarkedForAutoLog(e.arguments[n],i);o&&(e.arguments[n]=o)}if(e.callee&&!t._isInstrumented(e,i)){var s=[e.callee];"MemberExpression"===e.callee.type&&e.callee.property&&s.push(e.callee.property);var o=t._wrapIfMarkedForAutoLog(e,i,!1,s);o&&(i.replacement=o)}}),t._visitor.NewExpression.addForAutoLogOnly(function(e,i){if(e.arguments&&e.arguments.length)for(var n=0,r=e.arguments.length;n<r;n++)if("SpreadElement"!==e.arguments[n].type){var o=t._wrapIfMarkedForAutoLog(e.arguments[n],i);o&&(e.arguments[n]=o)}}),t._visitor.ArrayExpression.addForAutoLogOnly(function(e,i){if(e.elements&&e.elements.length)for(var n=0,r=e.elements.length;n<r;n++){var o=e.elements[n];if(o&&"SpreadElement"!==o.type){var s=t._wrapIfMarkedForAutoLog(o,i);s&&(e.elements[n]=s)}}}),t._visitor.TemplateLiteral.addForAutoLogOnly(function(e,i){if(e.expressions&&e.expressions.length)for(var n=0,r=e.expressions.length;n<r;n++){var o=t._wrapIfMarkedForAutoLog(e.expressions[n],i);o&&(e.expressions[n]=o)}}),t._visitor.AwaitExpression.addForAutoLogOnly(function(e,i){if(e.argument){var n=t._wrapIfMarkedForAutoLog(e.argument,i);n&&(e.argument=n)}}),t._visitor.SequenceExpression.addForAutoLogOnly(function(e,i){if(e.expressions&&e.expressions.length)for(var n=0,r=e.expressions.length;n<r;n++){var o=e.expressions[n],s=t._wrapIfMarkedForAutoLog(o,i);s&&(e.expressions[n]=s)}}),t._visitor.ConditionalExpression.addForAutoLogOnly(function(e,i){if(e.test){var n=t._wrapIfMarkedForAutoLog(e.test,i);n&&(e.test=n)}}),t._visitor.AssignmentExpression.addForAutoLogOnly(function(e,i){if(e.right)if("="!==e.operator){var n=t._getAutoLogHint(e.right);if(!n){var s=[];s.push(e.left),"MemberExpression"===e.left.type&&e.left.property&&s.push(e.left.property);var a=t._wrapIfMarkedForAutoLog(e,i,!1,s);a&&(i.replacement=a)}}else{var s=[e.left];"MemberExpression"===e.left.type&&e.left.property?s.push(e.left.property):"ArrayPattern"!==e.left.type&&"ObjectPattern"!==e.left.type||s.push.apply(s,r([],o(t._findAllChildIdentifiersExceptComputedPropertyKeys(e.left)),!1));var a=t._wrapIfMarkedForAutoLog(e.right,i,!1,s);a&&(e.right=a)}}),t._visitor.UnaryExpression.addForAutoLogOnly(function(e,i){if(e.argument&&"delete"!==e.operator){var n=t._wrapIfMarkedForAutoLog(e.argument,i);n&&(e.argument=n)}})};g.prototype={instrument:function(e){var t=this;t._ranges=[],t._code=e,t._numberOfFunctions=0;var i=t._parse(e);t._postInitializeIgnoreCoverageHints(),t._postInitializeAutoLogHints(e,i);var n=t._generate(t._change(i,t._visitor));return delete t._code,{code:n.code,map:n.map.toString(),ranges:t._ranges,numberOfFunctions:t._numberOfFunctions,testName:t._testName,esm:t._esm,includedTestFile:t._includedTestFile,excludedTestFile:t._excludedTestFile,matchSnapshotRanges:t._matchSnapshotRanges,loggedRanges:t._loggedRanges,notInstrumentedLogMarkers:t._logMarkers&&t._logMarkers.filter(function(e){return!e.instrumented}),liveCommentLines:!_.isEmpty(t._liveCommentLines)&&t._liveCommentLines||void 0}},_nodeEndsBeforeSelectionStart:function(e,t,i){return e.loc.end.line<t||e.loc.end.line===t&&e.loc.end.column<i},_findBestMatchingAutoLogNode:function(e,t,i,n,r,o){var s=this._nodeEndsBeforeSelectionStart(e,i,n),a=this._nodeEndsBeforeSelectionStart(t,i,n);if(s&&!a)return t;if(a&&!s)return e;if(e.loc.start.column<=n&&t.loc.start.column>n)return e;if(t.loc.start.column<=n&&e.loc.start.column>n)return t;if(t.loc.start.column<=n&&e.loc.start.column<=n){if(e.loc.start.column>t.loc.start.column)return e;if(t.loc.start.column>e.loc.start.column)return t}else{if(e.loc.start.column<t.loc.start.column)return e;if(t.loc.start.column<e.loc.start.column)return t}var l=o-1;return(e.loc.end.line>r||e.loc.end.line===r&&e.loc.end.column>=l)&&(t.loc.end.line<r||t.loc.end.line===r&&t.loc.end.column<l)?e:(t.loc.end.line>r||t.loc.end.line===r&&t.loc.end.column>=l)&&(e.loc.end.line<r||e.loc.end.line===r&&e.loc.end.column<l)?t:(e.loc.end.line>r||e.loc.end.line===r&&e.loc.end.column>=l)&&(t.loc.end.line>r||t.loc.end.line===r&&t.loc.end.column>=l)?e.loc.end.line<t.loc.end.line||e.loc.end.line===t.loc.end.line&&e.loc.end.column<t.loc.end.column?e:t:e.loc.end.line<t.loc.end.line||e.loc.end.line===t.loc.end.line&&e.loc.end.column<t.loc.end.column?t:e},_postInitializeIgnoreCoverageHints:function(){var e,t;if(this._extractedComments&&this._extractedComments.ignoreComments)try{for(var i=s(this._extractedComments.ignoreComments),n=i.next();!n.done;n=i.next()){var r=n.value;this._ignoreCoverageHints.push(r.index)}}catch(o){e={error:o}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}this._ignoreCoverageHints.length||(this._nextHint=function(){})},_postInitializeAutoLogHints:function(e,t){var i,n,a,l,c,u,h=this;if(h._opts.recordValues){if(h._extractedComments&&h._extractedComments.liveComments)try{for(var d=s(h._extractedComments.liveComments),f=d.next();!f.done;f=d.next()){var p=f.value;h._handleLiveComment(p.index,p.exp,e)}}catch(g){i={error:g}}finally{try{f&&!f.done&&(n=d["return"])&&n.call(d)}finally{if(i)throw i.error}}if(h._logMarkers&&h._logMarkers.length){var v=void 0,y=new Map;try{for(var m=s(h._logMarkers),_=m.next();!_.done;_=m.next()){var b=_.value,k=b.range;if(k){var T=o(k,1),S=T[0];void 0===v?v=S:S>v&&(v=S),b.originalStartLine=(b.originalRange||b.range)[0],y.has(S)?y.get(S).push(b):y.set(S,[b])}}}catch(C){a={error:C}}finally{try{_&&!_.done&&(l=m["return"])&&l.call(m)}finally{if(a)throw a.error}}var L=new Set,j=new Map,w=this._getVisitor();w.ChainExpression=function(e,t,i){i(e.expression,t,"Expression")},function q(e,t,i){var n=i||e.type;if(e.loc.start.line<=v){var r=y.get(e.loc.start.line);r&&!t.has(e)&&(t.add(e),r.forEach(function(t){if(t.range){var i=o(t.range,4),n=i[1],r=i[2],s=i[3];if((e.loc.start.column<=s||e.loc.start.line!==r||e.loc.end.line>e.loc.start.line||e.loc.end.line===e.loc.start.line&&e.loc.end.column>=n)&&"EmptyStatement"!==e.type&&"DebuggerStatement"!==e.type&&"ChainExpression"!==e.type){var a=j.get(t.originalStartLine);a?j.set(t.originalStartLine,{logMarker:t,node:h._findBestMatchingAutoLogNode(a.node,e,e.loc.start.line,n,r,s)}):j.set(t.originalStartLine,{logMarker:t,node:e})}}}));var s=w[n];s&&s(e,t,q)}}(t,L);var x={};try{for(var F=s(r([],o(j.values()),!1).sort(function(e,t){return e.logMarker.originalStartLine-t.logMarker.originalStartLine})),E=F.next();!E.done;E=F.next()){var R=E.value,I=R.node,b=R.logMarker;"VariableDeclarator"===I.type&&I.init?I=I.init:"IfStatement"===I.type&&I.test?I=I.test:"RestElement"===I.type&&I.argument?I=I.argument:"AssignmentExpression"===I.type&&"="!==I.operator&&I.right&&(I=I.left);var M=I.end.toString()+":"+I.start.toString();if(!x[M]){x[M]=!0;var O=h._autoLogHints[I.end];h._autoLogHints[I.end]={start:I.start,logMarker:b,liveComment:O&&O.isLiveComment?O:void 0}}}}catch(P){c={error:P}}finally{try{E&&!E.done&&(u=F["return"])&&u.call(F)}finally{if(c)throw c.error}}}}},_getVisitor:function(){var t=e("./acornWalkJsxPlugin")(e("acorn-walk").base);return t.MemberExpression=function(e,t,i){i(e.object,t,"Expression"),i(e.property,t,"Expression")},t.MethodDefinition=t.Property=function(e,t,i){e.computed?i(e.key,t,"Expression"):i(e.key,t,"Identifier"),i(e.value,t,"Expression")},t},_findAllChildIdentifiersExceptComputedPropertyKeys:function(e){var t=[],i=this._getVisitor();return i.ObjectPattern=function(e,t,i){for(var n=0,r=e.properties;n<r.length;n+=1){var o=r[n];"Property"===o.type?(o.computed||o.method||i(o.key,t,"Identifier"),i(o.value,t,"Pattern")):"RestElement"===o.type&&i(o.argument,t,"Pattern")}},function n(e,t,r){var o=r||e.type;"Identifier"===e.type&&t.indexOf(e)<0&&t.push(e);var s=i[o];s&&s(e,t,n)}(e,t),t},_getNodesToCheckForAutoLogsInVariableDeclaration:function(e,t){var i=[e];return"VariableDeclarator"===t.type&&t.id&&("Identifier"===t.id.type?i.push(t.id):"ObjectPattern"!==t.id.type&&"ArrayPattern"!==t.id.type||i.push.apply(i,r([],o(this._findAllChildIdentifiersExceptComputedPropertyKeys(t.id)),!1))),i},_tryFindTestName:function(e,t){var i=this;if(i._containsChangePosition(e.body)&&t.parentContext&&!i._saveTestNameIfTestFunctionCall(t,e,t.parentNode)&&!i._tryFindTestNameFromWrappedFunction(e,t)&&t.parentContext.parentContext){var n=t.parentNode;if(_.isArray(n)&&(n[0]===e||n[1]===e)){var r=t.parentContext,o=r.parentNode;o&&"CallExpression"===o.type&&r.parentContext&&i._tryFindTestNameFromWrappedFunction(t.parentContext.parentNode,t.parentContext.parentContext)}}},_tryFindTestNameFromWrappedFunction:function(e,t){var i=this,n=t.parentNode;if(_.isArray(n)&&(n[0]===e||n[1]===e)){var r=t.parentContext,o=r.parentNode;if(o&&"CallExpression"===o.type&&r.parentContext)return i._saveTestNameIfTestFunctionCall(r.parentContext,o,r.parentContext.parentNode)}},_createVisitor:function(){var e=[],t={removeVisitorsAddedForAutoLogHintsOnly:function(){_.each(e,function(e){t[e].clearAutoLogHintsActions()})}};return t.add=function(e,t){for(var i=0,n=e.length;i<n;i++)e[i].add(t)},_.each(["AssignmentExpression","AssignmentPattern","ArrayExpression","ArrayPattern","ArrowFunctionExpression","AwaitExpression","BlockStatement","BinaryExpression","BreakStatement","CallExpression","CatchClause","ClassBody","ClassDeclaration","ClassExpression","ComprehensionBlock","ComprehensionExpression","ConditionalExpression","ContinueStatement","DoWhileStatement","DebuggerStatement","EmptyStatement","ExportBatchSpecifier","ExportDeclaration","ExportSpecifier","ExportNamedDeclaration","ExportDefaultDeclaration","ExportAllDeclaration","ExpressionStatement","FieldDefinition","ForOfStatement","ForStatement","ForInStatement","FunctionDeclaration","FunctionExpression","GeneratorExpression","Identifier","IfStatement","ImportBatchSpecifier","ImportDeclaration","ImportSpecifier","Literal","LabeledStatement","LogicalExpression","MemberExpression","MethodDefinition","ModuleDeclaration","NewExpression","ObjectExpression","ObjectPattern","Program","Property","ReturnStatement","SequenceExpression","SpreadElement","SwitchStatement","SwitchCase","Super","TaggedTemplateExpression","TemplateElement","TemplateLiteral","ThisExpression","ThrowStatement","TryStatement","UnaryExpression","UpdateExpression","VariableDeclaration","VariableDeclarator","WhileStatement","WithStatement","YieldExpression","JSXIdentifier","JSXNamespacedName","JSXMemberExpression","JSXElement","JSXOpeningElement","JSXClosingElement","JSXEmptyExpression","JSXExpressionContainer","JSXSpreadAttribute","JSXAttribute"],function(i){var n=[];t[i]=function(e,t){for(var i=0,r=n.length;i<r;i++)n[i](e,t)};var r=t[i];r.add=function(e){n.push(e)},r.addForAutoLogOnly=function(t){t.removeIfNoAutoLogHints=!0,e.push(i),n.push(t)},r.clearAutoLogHintsActions=function(){n=_.filter(n,function(e){return!e.removeIfNoAutoLogHints})},r.clear=function(){n.length=0}}),t},_change:function(e,t,i){var n,r,o=this;if(i||(i={}),e.type){if(e.loc){var s=t[e.type];if(s){if(i.hinted||(i.hinted=o._nextHint(e)),i.hinted)return e;t[e.type](e,i)}}if("Identifier"===e.type||"Literal"===e.type||"ThisExpression"===e.type||"DebuggerStatement"===e.type||"EmptyStatement"===e.type||"BreakStatement"===e.type||"ContinueStatement"===e.type)return}for(var a in e)e.hasOwnProperty(a)&&"loc"!==a&&"type"!==a&&"start"!==a&&"end"!==a&&"name"!==a&&(n=e[a],n&&_.isObject(n)&&(r={parentContext:i,parentNode:e,hinted:i.hinted},o._change(n,t,r),r.replacement&&(e[a]=r.replacement)));return e},_handleLiveComment:function(e,t,i){var n=this,r=this._autoLogHints[e]={exp:t,isLiveComment:!0},o=function(e,t,o,s){for(var a,l=e;l>=0;l--)if(a=i[l],!o.test(a)){l++;break}return l<t&&!n._autoLogHints[l]&&(n._autoLogHints[l]=r,s&&s(l)),l};o(o(e-1,e,/\s/)-1,e,/[\s,)]/,function(e){return r.bracelessIndex=e})},_parse:function(e){var t=this,i={locations:!0,ecmaVersion:"latest",allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,allowAwaitOutsideFunction:!0,plugins:{jsx:!0,objectSpread:!0,dynamicImport:!0,topLevelAwait:!0,tolerance:!0}},n=[];if(t._ignoreCoverageRegExp&&n.push(function(e,i,n,r){i&&i.match(t._ignoreCoverageRegExp)&&t._ignoreCoverageHints.push(r)}),t._ignoreFileCoverageRegExp&&n.push(function(e,i){!t._ignoreFileCoverage&&i&&i.match(t._ignoreFileCoverageRegExp)&&(t._ignoreFileCoverage=!0,t._wrapExpressionStatementExpressionIntoVisitor=function(e){return e},t._autoLogHints={})}),t._includeTestFileRegExp&&n.push(function(e,i){!t._includedTestFile&&i&&i.match(t._includeTestFileRegExp)&&(t._includedTestFile=!0)}),t._excludeTestFileRegExp&&n.push(function(e,i){!t._excludedTestFile&&i&&i.match(t._excludeTestFileRegExp)&&(t._excludedTestFile=!0)}),!t._opts.recordValues||!t._autoLogHintExpPrefix||t._ignoreFileCoverage||t._extractedComments&&t._extractedComments.liveComments||n.push(function(i,n,r){if(n&&!t._ignoreFileCoverage){var o=n.indexOf(t._autoLogHintExpPrefix);if(0===o||1===o&&" "===n[0]){var s=n.substr(t._autoLogHintExpPrefix.length+o).trim();t._handleLiveComment(r,s,e)}}}),t._opts.preserveComments){i.ranges=!0,i.onComment=[],i.onToken=[];var r=a.parse(e,i);return _.each(i.onComment,function(e){_.each(n,function(t){t("Block"===e.type,e.value,e.start,e.end,e.loc.start)})}),l.attachComments(r,i.onComment,i.onToken)}return n.length&&(i.onComment=function(e,t,i,r,o){_.each(n,function(n){n(e,t,i,r,o)})}),a.parse(e,i)},_nextHint:function(e,t){var i=this,n=e.start,r=e.end;!t&&_.isNumber(i._ignoreCoverageHints.prevLastHintPosition)&&(i._ignoreCoverageHints.lastHintPosition=i._ignoreCoverageHints.prevLastHintPosition,delete i._ignoreCoverageHints.prevLastHintPosition);for(var o=i._ignoreCoverageHints.lastHintPosition,s=i._ignoreCoverageHints.lastHintPosition+1,a=!1,l=!1,c=!1;s<i._ignoreCoverageHints.length;){var u=i._ignoreCoverageHints[s];if(u<=n||c&&u<r)a=!0,i._ignoreCoverageHints.lastHintPosition=s,s++,c=!0;else{if(!(t&&u<r))break;l=!0,i._ignoreCoverageHints.lastHintPosition=s,s++}}return l&&(i._ignoreCoverageHints.prevLastHintPosition=o),a},_generate:function(e){var t={sourceMap:this._opts.fileName||"original",sourceMapWithCode:!0};return this._opts.preserveComments&&(t.comment=!0),l.generate(e,t)},_wrapInBlock:function(e){return{type:"BlockStatement",body:e}},_instructionValueSequence:function(e,t,i,n){var r=e[1],o=this._wrapIfMarkedForAutoLog(r,t,!0,i,n);return o&&(e[1]=o),_.isEmpty(this._autoLogHints)&&(this._instructionValueSequence=_.bind(this._sequence,this),this._getNodesToCheckForAutoLogsInVariableDeclaration=function(){return[]}),this._sequence(e)},_wrapIfMarkedForAutoLog:function(e,t,i,n,r){if(e&&!t.hinted){var o=this._getAutoLogHint(e,r);if(!o&&n&&n.length)for(var s=0;s<n.length&&!(o=this._getAutoLogHint(n[s]));s++);if(o&&(!e.tracerLog||"."===o.exp||o.logMarker&&"time"===o.logMarker.action))return i?this._wrapIntoVisitor(e,this._generateNodeContext(e),!1,o):this._generateUndefinedAutoLogNode(e,t,o)}},_isInstrumented:function(e,t){return t.parentNode&&(t.parentNode[5]===e||t.parentNode[6]===e)},_generateUndefinedAutoLogNode:function(e,t,i,r){var o=this._ranges.length-1,s=this._instruction(e,n(n({},t),{disallowValueLoggingInOrAfterCurrentDebuggerFrame:r}),"U",function(e){o=e}),a=this._wrapIntoVisitor(e,this._generateNodeContext(e),!1,i,function(){return o});return this._sequence([s,a])},_getAutoLogHint:function(e,t){var i=e.end+(t||0),n=this._autoLogHints[i];n&&n.start>=0&&e.start!==n.start&&(n=void 0);try{if(n)return n.bracelessIndex&&delete this._autoLogHints[n.bracelessIndex],n;if(t)return n=this._getAutoLogHint(e)}finally{n&&n.isLiveComment&&(this._liveCommentLines[e.loc.start.line]=e.loc.start.column)}},_sequence:function(e){return{type:"SequenceExpression",expressions:e}},_literal:function(e){return{type:"Literal",value:e}},_delayedLiteral:function(e){return{type:"Literal",get value(){return _.isUndefined(this._value)?(this._value=e(),this._value):this._value}}},_return:function(e){return{type:"ReturnStatement",argument:e}},_firstNode:function(e){return{type:"ExpressionStatement",expression:{type:"Literal",value:e&&e.expression&&e.expression.value||""}}},_handleSuperCall:function(e,t,i,n){var s=e[0],a=this._instructionStatement(s,t,"S");delete s.loc,delete s.expression.loc,e.splice.apply(e,r([1,0],o([i,a].concat(n)),!1))},_replaceConsoleLog:function(e,t){var i=this;e&&!t.hinted&&("CallExpression"===e.type&&e.callee&&"MemberExpression"===e.callee.type&&e.callee.object&&"Identifier"===e.callee.object.type&&"console"===e.callee.object.name&&e.callee.property&&"Identifier"===e.callee.property.type&&"log"===e.callee.property.name?(e.tracerLog=!0,e.callee.object.name="$_$tracer",e.arguments||(e.arguments=[]),e.arguments.push(i._literal(i._generateNodeContext(e.arguments[0]))),e.arguments.push(i._literal(i._opts.file)),e.arguments.push(i._literal(i._ranges.length))):e.arguments&&e.arguments.length&&i._replaceConsoleLog(e.arguments[0],t))},_generateNodeContext:function(e){if(e&&"Literal"!==e.type)try{var t=_.truncate(l.generate(e,{}),c).toString().replace("$_$tracer.log","console.log");return~t.indexOf("$_$tracer")?"":t}catch(i){}return""},_replaceSequenceWithDiff:function(e){var t=this,i=e;if(e=i.expression,e&&"SequenceExpression"===e.type&&e.expressions&&2===e.expressions.length){var n=e.expressions[0],r=e.expressions[1],o="";if(n&&"Literal"!==n.type)try{o=_.truncate(l.generate(n,{}),c).toString()+" vs "+_.truncate(l.generate(r,{}),c).toString()}catch(s){}return i.expression={type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:"$_$tracer"},property:{type:"Identifier",name:"diff"}},arguments:[n,r,t._literal(o),t._literal(t._opts.file),t._literal(t._ranges.length)]},!0}},_needsToStayFirst:function(e){return e&&"ExpressionStatement"===e.type&&e.expression&&"Literal"===e.expression.type&&("use strict"===e.expression.value||"use babel"===e.expression.value||"ngInject"===e.expression.value)},_isSystemJsModule:function(e){return e&&"ExpressionStatement"===e.type&&e.expression&&"CallExpression"===e.expression.type&&e.expression.callee&&"MemberExpression"===e.expression.callee.type&&e.expression.callee.object&&e.expression.callee.property&&"Identifier"===e.expression.callee.object.type&&"Identifier"===e.expression.callee.property.type&&"System"===e.expression.callee.object.name&&"register"===e.expression.callee.property.name&&e.expression.arguments},_isSuperCall:function(e){return e&&"ExpressionStatement"===e.type&&e.expression&&"CallExpression"===e.expression.type&&e.expression.callee&&"Super"===e.expression.callee.type},_instruction:function(e,t,i,n){var r=this,o=e.loc,s="",a=[];switch(i){case"PE":a=[this._literal(this._opts.file)];case"FE":s=i.toLowerCase();break;default:if(this._ignoreFileCoverage||t.hinted||this._nextHint(e,!0))return{type:"Literal",value:1};s="";var l=function(){var t=[o.start.line,o.start.column,o.end.line,o.end.column];if("R"===i){var n=1;if(e.argument&&"CallExpression"===e.argument.type&&e.argument.callee){var s=e.argument.callee;"SequenceExpression"===s.type&&s.expressions&&s.expressions.length&&(s=s.expressions[s.expressions.length-1]),"Identifier"===s.type?n=r._isObjectSpread(s)?u:s.name:"MemberExpression"===s.type&&(s.property&&"Identifier"===s.property.type&&"createElement"===s.property.name&&s.object&&(r._isReactObject(s.object)||"MemberExpression"===s.object.type&&r._isReactObject(s.object.object))?n=h:s.object&&r._isObjectSpread(s.object)&&(n=u))}t.push(n)}r._ranges.push(t)};"U"!==i?(a=[this._literal(this._opts.file),this._literal(this._ranges.length)],l(),a.push({type:"Identifier",name:"$_$c"})):(s="_",a=[this._literal(this._opts.file),this._delayedLiteral(function(){var e=r._ranges.length;return l(),n&&n(e),e})],a.push({type:"Identifier",name:"$_$c"}),t.disallowValueLoggingInOrAfterCurrentDebuggerFrame&&a.push(this._literal(!0)))}var c=this._instructionCallExpression(s,a);return e.loc&&(c.loc=e.loc,c.callee.loc=e.loc),c},_isReactObject:function(e){return e&&"Identifier"===e.type&&e.name&&~e.name.toLowerCase().indexOf("react")},_isObjectSpread:function(e){return e&&"Identifier"===e.type&&e.name&&~e.name.toLowerCase().indexOf("objectspread")},_wrapExpressionStatementExpressionIntoVisitor:function(e,t){if(!e||"Identifier"!==e.type)return e;var i=this._getAutoLogHint(t);return i||(i=this._getAutoLogHint(e)),this._wrapIntoVisitor(e,void 0,{hasAutoLogHint:!!i},i||{exp:""})},_autoHintDetails:function(e,t){var i=this._autoLogHintGlobalExp&&!e&&t.isLiveComment||this._autoLogHintGlobalExp&&e&&e.hasAutoLogHint,n=t.logMarker?t.logMarker.exp:t.exp;i&&(n="");var r=n&&"?"===n[0],o=n&&("."===n[0]||".+"===n.substr(0,2)||"+."===n.substr(0,2)),s=n&&("+"===n[0]||".+"===n.substr(0,2)||"+."===n.substr(0,2));return r&&(n=n.substr(1).trim()),o&&(n=n.substr(1).trim()),s&&(n=n.substr(1).trim()),t.logMarker&&(s=t.logMarker.expanded),{hasGlobalExp:i,exp:n,isProxyExp:r,isTimeDiffExp:o,isAutoExpandExp:s}},_wrapIntoVisitor:function(e,t,i,r,o,s){var a=this,l=this._autoHintDetails(i,r),u=l.hasGlobalExp,h=l.exp,p=l.isProxyExp,g=l.isTimeDiffExp,v=l.isAutoExpandExp,y=r.logMarker&&"time"!==r.logMarker.action&&r.logMarker,m=r.logMarker&&"time"===r.logMarker.action&&r.logMarker;if(m)if(r.liveComment){var b=this._autoHintDetails(i,r.liveComment);b.isTimeDiffExp&&(m.instrumented=!0,m=void 0),u=b.hasGlobalExp,h=b.exp,p=b.isProxyExp,g=b.isTimeDiffExp,v=b.isAutoExpandExp}else g=!0;var k=a._ranges.length-(i?0:1),T=[a._literal(a._opts.file)];if(o?(T.push(a._delayedLiteral(function(){var e=o();return a._loggedRanges[e]=!0,e})),T.push(a._delayedLiteral(function(){return a._opts.file+","+o()}))):(a._loggedRanges[k]=!0,T.push(a._literal(k)),T.push(a._literal(a._opts.file+","+k))),T.push({type:"Identifier",name:"$_$c"}),g&&!h){if(T.push(a._literal(t||e.name||"")),T.push(a._tracerMethodCall("_time")),T.push(e),T.push(a._tracerMethodCall("_time")),m){var S={type:"ObjectExpression",properties:[]};m.traceId&&S.properties.push(a._propertyNode("traceId",m.traceId)),m.changeId&&S.properties.push(a._propertyNode("changeId",m.changeId)),(m.traceId||m.changeId)&&T.push(S),m.instrumented=!0}return this._tracerMethodCall("_logTime",T)}if(T.push(a._literal(h?_.truncate(h,c):t||e.name||"")),m){var C=n({},m);delete C.liveComment,T.push(a._wrapIntoVisitor(e,t,!!i,{exp:".",logMarker:C}))}else g?T.push(a._wrapIntoVisitor(e,t,!!i,{exp:"."})):T.push(e);u?T.push(a._evalExpressionNode(a._autoLogHintGlobalExp)):T.push(h?a._evalExpressionNode(h):a._literal("$_$ne")),T.push(a._literal(!i||a._autoLogHintExpPrefix&&i&&i.hasAutoLogHint?0:1));var L=0;if(v&&(L|=d),p&&(L|=f),T.push(a._literal(L)),y){var S={type:"ObjectExpression",properties:[]},j=r.liveComment&&""===r.liveComment.exp||!r.liveComment&&i;return j&&S.properties.push(a._propertyNode("permanent",1)),y.traceId&&S.properties.push(a._propertyNode("traceId",y.traceId)),y.changeId&&S.properties.push(a._propertyNode("changeId",y.changeId)),(y.traceId||y.changeId||j)&&T.push(S),y.instrumented=!0,!j&&r.liveComment?a._wrapIntoVisitor(a._instructionCallExpression("v",T),t,i,r.liveComment,o,!0):a._instructionCallExpression("v",T)}return s&&T.push({type:"ObjectExpression",properties:[a._propertyNode("permanent",1)]}),a._instructionCallExpression("v",T)},_propertyNode:function(e,t){return{type:"Property",key:{type:"Identifier",name:e},value:{type:"Literal",value:t}}},_tracerMethodCall:function(e,t){return{type:"CallExpression",callee:{type:"MemberExpression",computed:!1,object:{type:"Identifier",name:"$_$tracer"},property:{type:"Identifier",name:e}},arguments:t||[]}},_evalExpressionNode:function(e){return{type:"FunctionExpression",id:null,params:[{type:"Identifier",name:"$"}],body:{type:"BlockStatement",body:[{type:"TryStatement",block:{type:"BlockStatement",body:[{type:"ReturnStatement",argument:{type:"CallExpression",callee:{type:"Identifier",name:"eval"},arguments:[{type:"Literal",value:e}]}}]},handler:{type:"CatchClause",param:{type:"Identifier",name:"__e"},body:{type:"BlockStatement",body:[{type:"ReturnStatement",argument:{type:"Literal",value:"✗"}}]}},finalizer:null}]},generator:!1,expression:!1}},_instructionCallExpression:function(e,t){return{type:"CallExpression",callee:{type:"Identifier",name:"$_$w"+e},arguments:t}},_getFunctionParameterLogInstructions:function(e,t){var i=[],n=this;return e.params.forEach(function(e){if("Identifier"===e.type){var r=n._getAutoLogHint(e);r&&e.name&&i.push(n._generateUndefinedAutoLogNode(e,t,r))}else if("AssignmentPattern"===e.type&&e.left&&e.right&&e.left.name){var r=[n._getAutoLogHint(e.left),n._getAutoLogHint(e.right),n._getAutoLogHint(e)].find(function(e){return e});r&&i.push(n._generateUndefinedAutoLogNode(e.left,t,r))}else if("ObjectPattern"===e.type&&e.properties){var o=n._getAutoLogHint(e);e.properties.forEach(function(e){if(e&&e.key&&e.value&&e.value.name){var r=[n._getAutoLogHint(e.value),n._getAutoLogHint(e.key),n._getAutoLogHint(e),o].find(function(e){return e});r&&i.push(n._generateUndefinedAutoLogNode(e.value,t,r))}})}else if("ArrayPattern"===e.type&&e.elements){var s=n._getAutoLogHint(e);e.elements.forEach(function(e){if(e&&e.name){var r=[n._getAutoLogHint(e),s].find(function(e){return e});r&&i.push(n._generateUndefinedAutoLogNode(e,t,r))}})}else if("RestElement"===e.type&&e.argument&&e.argument.name){var r=n._getAutoLogHint(e);r&&i.push(n._generateUndefinedAutoLogNode(e.argument,t,r))}}),i.map(function(e){return{type:"ExpressionStatement",expression:e}})},_instructionStatement:function(e,t,i){return{type:"ExpressionStatement",expression:this._instruction(e,t,i)}},_scopeStartVariableDeclaration:function(e){return{type:"VariableDeclaration",kind:"var",declarations:[{type:"VariableDeclarator",id:{type:"Identifier",name:"$_$c"},init:{type:"CallExpression",callee:{type:"Identifier",name:"$_$w"+e.toLowerCase()},arguments:[this._literal(this._opts.file)]
}}]}},_saveTestNameIfTestFunctionCall:function(e,t,i){var n=this;if(_.isArray(i)&&i.length>=2&&i[1]===t&&i[0]){var r=void 0;if("Literal"===i[0].type)r=i[0].value;else{if("TemplateLiteral"!==i[0].type)return;var o=i[0];if(o.expressions&&o.expressions.length)return;if(!o.quasis||1!==o.quasis.length)return;var s=o.quasis[0];if(!s||!s.value)return;r=s.value.cooked}var a=e.parentContext.parentNode;if(a&&"CallExpression"===a.type){var l=a.callee;if("SequenceExpression"===l.type&&l.expressions&&(l=l.expressions[l.expressions.length-1]),l&&("it"===l.name||"test"===l.name||"asyncTest"===l.name||l.property&&"Identifier"===l.property.type&&("it"===l.property.name||"test"===l.property.name||"asyncTest"===l.property.name)))return n._testName=r,!0}}}},t.exports=function(e,t){return new g(t).instrument(e)}},{"./acornImportMetaPlugin":1,"./acornLogicalAssignment":2,"./acornNumericSeparatorPlugin.js":3,"./acornTolerancePlugin":4,"./acornTopLevelAwaitPlugin":5,"./acornWalkJsxPlugin":6,acorn:void 0,"acorn-jsx":void 0,"acorn-walk":void 0,"escodegen-wallaby":void 0}],45:[function(e,t,i){function n(e){var t=this.namespace;e[0]=r()+t+" "+e[0]}function r(){return g.inspectOpts.hideDate?"":(new Date).toISOString()+" "}function o(e){return process.stdout.write(e)}function s(e){function t(e,i){function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(n.enabled){var o=n,s=Number(new Date),u=s-(r||s);o.diff=u,o.prev=r,o.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var h=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;h++;var r=t.formatters[n];if("function"==typeof r){var s=e[h];i=r.call(o,s),e.splice(h,1),h--}return i}),t.formatArgs.call(o,e);var p=c.format.apply(c,l([],a(e),!1))+"\n";o.isDebug?(d.add(p),f&&t.log.call(o,p)):t.log.call(o,p)}}var r;return n.isDebug="debug"===i,n.isTrace="trace"===i,n.namespace=e,n.enabled=n.isTrace&&p||n.isDebug,t.instances.push(n),n}function i(e){return e instanceof Error?e.stack||e.message:e}return t.debug=t,t["default"]=t,t.coerce=i,t.instances=[],Object.keys(e).forEach(function(i){t[i]=e[i]}),t.formatters={},t}var a=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},l=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},c=e("util"),u=new(e("lru-cache"))({max:1048576,length:function(e){return e.length}}),h=0,d={add:function(e){u.set(h++,e)},values:function(){var e=u.values();return e.reverse(),e}},f=process.env.WALLABY_DEBUG_ENABLED||!1,p=process.env.WALLABY_TRACE_ENABLED||!1,g={};g.log=o,g.formatArgs=n,g.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var i=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[i]=n,e},{depth:25,maxArrayLength:100,breakLength:200});var v=s(g),y=v.formatters;y.o=function(e){return c.inspect(e,g.inspectOpts).replace(/\s*\n\s*/g," ")},y.O=function(e){return c.inspect(e,g.inspectOpts)},t.exports={create:function(e){return{debug:v(e,"debug"),trace:v(e,"trace")}},enableDebug:function(){f||(process.env.WALLABY_DEBUG_ENABLED="true",f=!0,d.values().forEach(function(e){g.log(e)}))},getDebugLog:function(){return d.values()},enableTrace:function(){p||(process.env.WALLABY_TRACE_ENABLED="true",p=!0,v.instances.forEach(function(e){e.isTrace&&(e.enabled=!0)})),this.enableDebug()}}},{"lru-cache":void 0,util:void 0}],46:[function(e,t,i){var n=(e("fs"),e("path")),r=e("child_process").spawn,o=logger.create("nodeRunner").debug,s=e("./runWorkerPool"),a=e("./utils"),l="###wpm###",c=function(e){var t=this;t._project=e,t._nodePath=e.settings().env.runner,t._initializer=e.settings().bootstrap,t._teardown=e.settings().teardown,t._slowTestThreshold=e.settings().slowTestThreshold,t._zeroConfigJest=e.isZeroConfigJest(),t._vitest=e.isVitest(),t._nodeModules=n.join(e._localRoot,"node_modules");try{t._regeneratorRuntime=n.join(n.dirname(a.resolveModulePathFrom(t._nodeModules,"regenerator-runtime")),"runtime.js")}catch(i){}t._params=e.settings().env.params,t._recycle=e.settings().workers.recycle,t._testFramework=e.settings().testFramework,t._cwd=process.env.quokka||t._zeroConfigJest||t._vitest?process.cwd():e._instrumentedRoot,t._localProjectDir=e._localProjectDir,t._originalCacheRoot=e._originalRoot,t._reportUnhandledPromises=!!e.settings().reportUnhandledPromises,t._maxLogEntrySize=e.settings().maxLogEntrySize,t._maxTraceSteps=e.settings().maxTraceSteps,t._workerPool=new s(t._project,{create:_.bind(t._createNodeInstance,t),recycle:_.bind(t._recycleNodeInstance,t),healthy:_.bind(t._isNodeInstanceHealthy,t),prepare:_.bind(t._prepare,t)}),t._workerPool.setFileRoot(t._cwd)};c.prototype={run:function(e){var t=this;return t._workerPool.run(e)},cancel:function(e){var t=this;return t._workerPool.cancel(e)},start:function(){var e=this;return e._workerPool.start()},stop:function(){var e=this;e._workerPool.stop()},mapStack:function(e,t){return this._workerPool._mapStackEntries(e,t)},_createNodeInstance:function(e,t){var i=this;setImmediate(function(){try{process.env.quokka&&(i._params=i._project.settings().env.params,i._recycle=i._project.settings().workers.recycle);var n=(i._params.runner?_.map(i._params.runner.replace(/"([^"]+)"/g,function(e){return e.replace(/\s/g,"_space_token_")}).split(" "),function(e){return _.trim(e.replace(/_space_token_/g," "),'"')}):[]).concat([process.mainModule.filename,"runner",e,i._workerPool.receiverPort(),i._testFramework.version+(i._testFramework.autoDetected?",autoDetected":""),i._testFramework.path||"",i._nodeModules,i._originalCacheRoot,process.env.BABEL_ENV&&i._regeneratorRuntime||"",i._testFramework.configFile||"",JSON.stringify(i._project.settings().logLimits)]),s=_.extend({},process.env,i._params.env?_.reduce(i._params.env.split(";"),function(e,t){var i=t.split("="),n=_.trimLeft(i[0]);return e[n]=t.substring(i[0].length+1),e},{}):{});if(process.env.WALLABY_PNP){var a="";s.NODE_OPTIONS?a=s.NODE_OPTIONS:process.env.NODE_OPTIONS&&(a=process.env.NODE_OPTIONS),a.indexOf("--require")===-1&&(a=a+(a?" ":"")+process.env.WALLABY_PNP),s.NODE_OPTIONS=a}delete s.ATOM_SHELL_INTERNAL_RUN_AS_NODE,s.WALLABY_ELECTRON_RUN_AS_NODE||delete s.ELECTRON_RUN_AS_NODE,process.env.WALLABY_INTEGRATION_TEST_RUN&&delete s.CI;var l={process:r(i._nodePath,n,{cwd:i._cwd,env:s}),onConnected:function(e){_.isFunction(e)?this._onConnected=e:this._onConnected&&(this._onConnected(e),delete this._onConnected,delete this.onConnected)}};l.process.stderr.on("data",function(e){var t=e.toString("utf8");t=t.split("\n").filter(function(e){return e.indexOf("ExperimentalWarning:")===-1&&e.indexOf("node --trace-warnings")===-1}).join("\n"),t&&(o("Error in worker: %s",t),console.error(t))}),t(l)}catch(c){o("Error while creating worker #%s: %s",e,c&&(c.stack||c.message)),t()}})},_recycleNodeInstance:function(e){try{e.process.stdout.removeAllListeners("data"),e.process.stderr.removeAllListeners("data")}finally{e.process.kill()}},_isNodeInstanceHealthy:function(e){return e.process&&e.process.pid&&!e.process.killed&&!e.process.signal&&null===e.process.exitCode},_prepare:function(e,t){var i=this,n=_.randomId(),r=i._sandboxName(t,n),s={};return o("Starting sandbox [%s]",r),Q.when().then(function(){return i._workerPool.cancelled()?Q.reject({runCancelled:!0}):(o("Preparing sandbox [%s]",r),i._workerPool.getWorker(t))}).then(function(a){return o("Prepared sandbox [%s]",r),Q.when({instance:{resume:function(){a.channel.send(JSON.stringify({type:"in:tracer.resume",data:{}}))},ping:function(e){var t=_.uniqueId(),i=function(n){var r;try{r=JSON.parse(n)}catch(o){return}"pong"===r.type&&r.data===t&&(a.channel.removeListener("message",i),e())};a.channel.on("message",i),a.channel.send(JSON.stringify({type:"in:ping",data:t}))},teardown:function(){a.channel.send(JSON.stringify({type:"in:teardown",data:{}}))},close:function(e){if(i._recycle&&!i._teardown)i._workerPool.recycleWorker(t),i._workerPool.getWorker(t).then(_.noop),e(!0);else{if(i._teardown){if(s._closing)return;s._closing=!0;var n=_.uniqueId(),r=function(o){var l;try{l=JSON.parse(o)}catch(c){return}"closed"===l.type&&l.data&&l.data.requestId===n&&(a.channel.removeListener("message",r),delete s._closing,i._recycle&&(i._workerPool.recycleWorker(t),i._workerPool.getWorker(t).then(_.noop)),e(!l.data.error))};a.channel.on("message",r)}a.channel.send(JSON.stringify({type:"in:stop",data:n})),i._teardown||e(!0)}},closing:_.noop,start:function(t,r){if(t("success")){try{a.process.stdout.removeAllListeners("data"),a.process.stdout.on("data",function(e){try{e=e&&e.toString("utf8"),~e.indexOf(l)&&(e=e.split("\n"),_.each(e,function(e){if(~e.indexOf(l))try{JSON.parse(e);a.channel.emit("message",e)}catch(t){o("Error while processing STDOUT message: "+t.message)}}))}catch(t){o("Error while processing STDOUT message: "+t.message)}})}catch(s){o("Error while subscribing to process STDOUT: "+s.message)}a.process.stderr.removeAllListeners("data"),a.process.stderr.on("data",function(e){if(e=e&&e.toString("utf8"),!e||0!==e.indexOf("Debugger listening on port")){var t="";if(~e.indexOf(l)){var i;e=e.split("\n"),_.each(e,function(e){if(~e.indexOf(l))try{i=JSON.parse(e)}catch(t){o("Error while processing STDERR message: "+t.message)}}),i&&r(i.message,i.stack,i.actual,i.expected)}else{if(e){var n=e.split("\n"),s=[];_.each(n,function(e){return!_.startsWith(_.trimLeft(e),"at")&&void s.push(e)}),t=s.join("\n")}r(t,e)}}});var c={sessionId:n,tests:e.tests,files:_.reduce(e.allFiles.concat(e.allTestFiles),function(t,n){if(_.isNumber(n.id)){var r={id:n.id,rangesLength:n.rangesLength};if(t.push(r),(i._zeroConfigJest||i._vitest)&&(r.path=n.normalizedRelativePath,r.parentFilePath=n.parentFilePath,r.childFilePath=n.childFilePath,r.numberOfFunctions=n.numberOfFunctions,r.ts=n.ts,r.runnerCacheKey=n.runnerCacheKey,r.inOriginalFilesCache=n.inOriginalFilesCache,r.instrument=n.instrument,r.logMarkers=n.logMarkers,r.extractedComments=n.extractedComments,n.test)){r.test=!0;var o=!(n.relatedFilesWithTests||i._project.hadGlobalErrorsPreviousRun()||i._project.settings().runAllTestsInAffectedTestFile||e.fullRun),s=n.changeStart&&n.changePosition&&o;r.allowedToRunSingleTestOnly=o||void 0,s&&(r.changeStart=n.changeStart,r.changePosition=n.changePosition)}}return t},[]),testFiles:_.map(e.testFilesToLoad,function(e){var t;if(0===i._testFramework.version.indexOf("jest")){var n=i._project._getFileMetadataById(e.originalId||e.id);t=n&&n.getFileLineMap()}return{path:e.path,id:e.originalId||e.id,type:e.type,originalType:e.originalType,content:process.env.quokka?e.content:void 0,lineMap:t}}),root:i._cwd,localProjectDir:i._localProjectDir,flushCache:!1,initializer:i._initializer,teardown:i._teardown,slowTestThreshold:i._slowTestThreshold,manualTestRun:e.manualRun,updateSnapshotsRun:e.updateSnapshotsRun,profileRun:e.profileRun||void 0,reportUnhandledPromises:i._reportUnhandledPromises,maxLogEntrySize:i._maxLogEntrySize,maxTraceSteps:i._maxTraceSteps,expressionsToEvaluate:e.expressionsToEvaluate,hints:i._project.settings().hints,autoConsoleLog:i._project.settings().autoConsoleLog,preserveComments:i._project.settings().preserveComments,reportConsoleErrorAsError:i._project.settings().reportConsoleErrorAsError,suppressClearingRequireCache:i._zeroConfigJest||void 0,traceContext:e.traceContext||void 0,suppressCallStackEval:!!process.env.quokka||void 0,updateNoMoreThanOneSnapshotPerTestFileRun:i._project.settings().updateNoMoreThanOneSnapshotPerTestFileRun||void 0,runGlobals:e.runGlobals||!1,processEnvUpdates:e.processEnvUpdates,customJestConfig:i._project.settings().customJestConfig||void 0,logsSuppressions:e.logsSuppressions,symlinkNodeModules:i._project.settings().symlinkNodeModules,resolveGetters:i._project.settings().resolveGetters};a.channel.send(JSON.stringify({type:"in:run",data:c}))}}},name:r,sessionId:n,workerId:t})})},_sandboxName:function(e,t){return"worker #"+e+", session #"+t}},t.exports=c},{"./runWorkerPool":63,"./utils":72,child_process:void 0,fs:void 0,path:void 0}],47:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},o=e("path"),s=e("util"),a=e("ws"),l=e("./utils"),c=e("./utils/remapComments");l.remapComments=c;var u=JSON.stringify,h=JSON.parse,d=process.stderr.write.bind(process.stderr),f=function(e){e||(e="");var t="";"string"!=typeof e?(t=e.stack||e.message||e.toString&&e.toString()||"",e.message&&!~t.indexOf(e.message)&&(t=e.message+"\n"+t)):t=e,d(t)},p=process.stdout.write.bind(process.stdout),g={send:function(e){p(e)}};process.exit=function(){};var v=e("module").Module,y=v._cache,m=process.cwd(),_=[],b=[],k=e("timers").setTimeout,T=e("timers").setInterval,S=process.nextTick;e("timers").setTimeout=global.setTimeout=function(){var e=k.apply(this,arguments);return _.push(e),e},process.env.quokka&&(e("timers").setInterval=global.setInterval=function(){var e=T.apply(this,arguments);return b.push(e),e});try{s.promisify.custom&&s.promisify.custom&&(global.setTimeout[s.promisify.custom]=k[s.promisify.custom])}catch(C){}var L=function(){_.forEach(function(e){clearTimeout(e)}),_.length=0,b.forEach(function(e){clearInterval(e)}),b.length=0},j=function(e){if("string"==typeof e)f(e);else{var t="";e||f("");try{global.$_$tracer&&(e.stack||e.message)&&(t=JSON.stringify(global.$_$tracer.setAssertionData({actual:e.actual,expected:e.expected,showDiff:!0},{message:e.message,stack:e.stack,_p:"###wpm###"})))}catch(i){}f(t||e&&(e.stack||e.message||e.toString())||"")}},w=function(e){j(e),process.env.quokka&&process.emit("beforeExit")},x=function(){~process.listeners("uncaughtException").indexOf(w)||process.on("uncaughtException",w)};x();var F=function(){process.on("unhandledRejection",function(e){throw e})},E=function(t,i,n,r,o,a,c,u,h){var d=this;d._port=i,d._id=parseInt(t,10),global.$_$logLimits=JSON.parse(h),d._connect(function(){global.$_$reuseableTracer=!0,e("./tracer"),global.$_$tracer._utils=l,global.$_$tracer._handleUncaughtException=x,(~n.indexOf("jest")||~n.indexOf("vitest"))&&(global._=e("lodash"),global._.extend(global._,e("./utils")),global._.str=e("underscore.string"),global._.mixin(global._.str.exports()),l.instrument=e("./instrumentor"),global.$_$tracer.workerId=d._id,process.exit=function(e){e&&~n.indexOf("jest")&&j(new Error("process.exit called with "+e))}),global.wallaby._frameworks={chai:{},sinon:{},quibble:{}},global.wallaby._originalCacheRoot=a,global.wallaby._localNodeModules=o,global.wallaby._testFrameworkPath=r,global.wallaby._testConfigFile=u,global.wallaby._fileExtensionsAdded=!1,global.wallaby._regeneratorRuntime=c,d.profileRunInTestWorker=!~n.indexOf("vitest"),process.stderr.write=function(e){"string"==typeof e&&(e=e.trimEnd()),console.error(e)},d._testFrameworkInitializer=e("./runners/node/"+n.split(",")[0]+"/initializer.js")}),global.$_$tracer._highPriorityReceiver=g,global.$_$tracer._onReceiverClosed=function(e){e?global.$_$tracer._onReceiverClosedCallback=e:global.$_$tracer._onReceiverClosedCallback&&(global.$_$tracer._onReceiverClosedCallback(),delete global.$_$tracer._onReceiverClosedCallback)},global.$_$tracer.unrefWebSocket=function(){d._channel._socket.unref()},global.$_$tracer.refWebSocket=function(){d._channel._socket.ref()},global.$_$tracer._nodeUtil=s,d._patchFrameworks()};E.prototype={send:function(e){var t=this;t._channel.send(u(e))},_connect:function(e){var t=this;t._channel=new a("ws://127.0.0.1:"+t._port),global.$_$receiver=t._channel,e&&e(),t._channel.on("open",function(){t.send({worker:t._id.toString()})}),t._channel.on("message",function(e){e=h(e),t[e.type](e.data)})},"in:connected":function(){this._onConnected&&this._onConnected(),delete this._onConnected},"in:teardown":function(){return n(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return global.wallaby.teardown?[4,global.wallaby.teardown()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},"in:run":function(t){var i=this;t.reportUnhandledPromises&&F&&(F(),F=void 0),global.$_$coverage=[],t.suppressClearingRequireCache||Object.keys(y).forEach(function(e){var i=y[e];(i.filename&&~i.filename.indexOf(t.root)||t.flushCache)&&delete y[e]}),global.$_$logsSuppressions=t.logsSuppressions,global.$_$tracer._filePathToFileData={},global.$_$tracer._hints=t.hints,global.$_$tracer._autoConsoleLog=t.autoConsoleLog,global.$_$tracer._preserveComments=t.preserveComments,global.$_$tracer._reportConsoleErrorAsError=t.reportConsoleErrorAsError,global.$_$tracer._suppressCallStackEval=t.suppressCallStackEval,global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun=t.updateNoMoreThanOneSnapshotPerTestFileRun;for(var n=0,r=t.files.length;n<r;n++){for(var s=t.files[n],a=global.$_$coverage[s.id]=[],l=0;l<s.rangesLength;l++)a[l]={};s.path&&(global.$_$tracer._filePathToFileData[s.path]=s)}global.$_$baseDir=t.root+o.sep,global.$_$slow=t.slowTestThreshold,global.$_$tests=t.tests;var c=(t.testFiles||[]).map(function(e){return e.path});global.$_$testFiles=t.testFiles,global.wallaby.tests=c,global.$_$session=t.sessionId,global.$_$initialSpecId=1e5*(i._id+1)||1,global.$_$traceContext=t.traceContext,global.$_$profileRun=t.profileRun,global.$_$resolveGetters=t.resolveGetters,global.$_$tracer._shouldReportProgramScope=!0,global.$_$tracer.initLoadingPhase(),global.$_$tracer._maxLogEntrySize=t.maxLogEntrySize||global.$_$tracer._maxLogEntrySize,global.$_$tracer._maxTraceSteps=t.maxTraceSteps||global.$_$tracer._maxTraceSteps;try{global.wallaby.testFramework=i._testFrameworkInitializer.init(c)}catch(u){j(u)}if(global.$_$tracer.reportGlobalError=f,global.wallaby.localProjectDir=t.localProjectDir,global.wallaby.projectCacheDir=m,global.wallaby.sessionId=t.sessionId,global.wallaby.workerId=i._id,global.wallaby.runGlobals=t.runGlobals,global.wallaby.customJestConfig=t.customJestConfig,global.$_$tracer._manualTestRun=t.manualTestRun,global.$_$tracer._updateSnapshotsRun=t.updateSnapshotsRun,global.$_$tracer._expressionsToEvaluate=t.expressionsToEvaluate||{},t.processEnvUpdates&&(t.processEnvUpdates.updates&&t.processEnvUpdates.updates.forEach(function(e){process.env[e.variable]=e.value}),t.processEnvUpdates.deletions&&t.processEnvUpdates.deletions.forEach(function(e){delete process.env[e]})),t.symlinkNodeModules)try{var h=e("fs");h.existsSync(o.join(process.cwd(),"node_modules"))||h.symlinkSync(o.join(t.localProjectDir,"node_modules"),"node_modules","dir")}catch(u){}try{console._times&&console._times.clear()}catch(u){}try{if(e("./runners/node/bootstrap")(t.initializer),global.$_$profileRun&&i.profileRunInTestWorker){var d=e("inspector"),p=new d.Session;p.connect(),p.post("Profiler.enable",function(){p.post("Profiler.start",function(){global.$_$tracer.start()})}),global.$_$tracer._profileSession=p}else global.$_$tracer.start();i._teardown=t.teardown}catch(u){j(u)}},"in:stop":function(t){var i=this;global.$_$profileRun&&(global.$_$tracer._profileSession?(global.$_$tracer._profileSession.post("Profiler.stop",function(e,t){var n=t.profile;e?j(e):i.send({type:"profile",data:n})}),delete global.$_$tracer._profileSession):global.$_$tracer._profileResult&&(this.send({type:"profile",data:global.$_$tracer._profileResult}),delete global.$_$tracer._profileResult));var n;try{process.nextTick!==S&&(process.nextTick=S),global.$_$tracer.reset(),global.$_$tracer.resetEnvGlobal();try{console._times&&console._times.clear()}catch(r){}n=e("./runners/node/teardown")(this._teardown),delete this._teardown}catch(r){j(r)}var o=function(e){L(),delete global.$_$coverage,delete global.$_$tests,delete global.$_$session,delete global.$_$initialSpecId,delete global.$_$profileRun,i.send({type:"closed",data:{requestId:t,error:e}})};n instanceof Promise?n.then(function(){return o(!1)})["catch"](function(e){j(e),o(!0)}):o(!1)},"in:ping":function(e){var t=this,i=function(){return t.send({type:"pong",data:e})};process.env.quokka&&global.$_$tracer._asyncCodeMayBeExecuting?global.$_$tracer._pong=i:i()},"in:tracer.resume":function(){global.$_$tracer.resume()},_patchFrameworks:function(){l.patchModule("resolve",function(e){var t=e("resolve"),i=t.sync;return t.sync=function(){var e=arguments[1]=arguments[1]||{};return e.paths=e.paths||[],Array.isArray(e.paths)&&(e.paths=e.paths.concat([global.wallaby._localNodeModules]).concat(process.env.NODE_PATH?process.env.NODE_PATH.split(o.delimiter):[])),i.apply(this,arguments)},t}),l.patchModule("./util/core/wrap-method",function(e){var t=e("./util/core/wrap-method");return t&&t.toString&&~t.toString().indexOf("sinon")?function(e){var i=t.apply(this,arguments);return wallaby._frameworks.sinon.stubs.push(i),i}:t}),l.patchModulesCode([{files:["@testing-library/dom/dist/pretty-dom.js"],replacements:[{from:"highlight: inNode()",to:"highlight: false",optional:!0},{from:"const logDOM = (...args) =>",to:"const logDOM = (...args) => (console.log(prettyDOM(...args)), prettyDOM(...args));const logDOM_ = (...args) =>",optional:!0}]},{files:["@testing-library/react/dist/pure.js"],replacements:[{from:"el.forEach(e => console.log((0, _dom.prettyDOM)(e, maxLength, options)))",to:"el.map(e => (console.log((0, _dom.prettyDOM)(e, maxLength, options)), _dom.prettyDOM(e, maxLength, options)))",optional:!0},{from:"console.log((0, _dom.prettyDOM)(el, maxLength, options))",to:"(console.log((0, _dom.prettyDOM)(el, maxLength, options)), _dom.prettyDOM(el, maxLength, options))",optional:!0}]},{files:["@testing-library/react-native/build/helpers/format.js"],replacements:[{from:"highlight: true",to:"highlight: false",optional:!0}]},{files:["@testing-library/react-native/build/helpers/debugDeep.js"],replacements:[{from:"console.log((0, _format.default)(instance));",to:"return (console.log((0, _format.default)(instance)), _format.default(instance));",optional:!0}]}])}},t.exports=function(e,t,i,n,r,o,s,a,l){new E(e,t,i,n,r,o,s,a,l)}},{"./instrumentor":44,"./tracer":66,"./utils":72,"./utils/remapComments":73,fs:void 0,inspector:void 0,lodash:void 0,module:void 0,path:void 0,timers:void 0,"underscore.string":void 0,util:void 0,ws:void 0}],48:[function(e,t,i){var n=logger.create("phantomRunner").debug,r=e("phantom"),o=e("./runWorkerPool"),s=e("./browserEnvironment"),a=!1,l=function(e){var t=this;t._project=e,t._screenShotReady=Q.when(!0),t._params=e.settings().env.params,t._viewportSize=e.settings().env.viewportSize,t._clearMemoryCache=e.settings().env.clearMemoryCache,t._phantomjsPath=e.settings().env.runner,t._workerPool=new o(t._project,{create:_.bind(t._createPhantomInstance,t),recycle:_.bind(t._recyclePhantomInstance,t),healthy:_.bind(t._isPhantomInstanceHealthy,t),prepare:_.bind(t._prepare,t)}),t._browserEnvironment=new s(e,t._workerPool)};l.prototype={run:function(e){var t=this;return t._workerPool.run(e)},_createPhantomInstance:function(e,t){var i=this;try{var o={dnodeOpts:{weak:!1}};i._phantomjsPath&&(o.binary=i._phantomjsPath),o.onExit=function(t,i){return"SIGSEGV"!==i||a||(console.error("Looks like the PhantomJs version being used is not supported on your OS.\nTry using a different PhantomJs version (https://wallabyjs.com/docs/integration/phantomjs2.html)\nor Chromium/V8 via Electron runner (https://wallabyjs.com/docs/integration/electron.html)"),a=!0),n("Signal killed phantomjs #%s: %s, exit code: %s",e,i,t)};var s=["--disk-cache=yes","--web-security=false"];i._params.runner&&(s=s.concat(_.filter(i._params.runner.split(" "),function(e){return e&&!(~e.indexOf("--disk-cache=")||~e.indexOf("--web-security="))})));var l=!1;s.push(function(r){if(!l){if(!r)return l=!0,n("Additional attempt to create phantom instance #%s",e),i._createPhantomInstance(e,t);r.set("onError",function(t){n("PhantomJs failure: %s, recycling phantom instance #%s",t,e),i._workerPool.recycleWorker(e)}),l=!0,t(r)}}),s.push(o),r.create.apply(r,s)}catch(c){n("Error while creating worker #%s: %s",e,c&&(c.stack||c.message)),t()}},_recyclePhantomInstance:function(e){e.exit(),e.process.kill()},_isPhantomInstanceHealthy:function(e){return e.process&&e.process.pid&&!e.process.killed&&!e.process.signal&&null===e.process.exitCode},_prepare:function(t,i){var r=this,o=_.randomId(),s=r._browserEnvironment.sandboxName(i,o);return n("Starting sandbox [%s]",s),Q.when().then(function(){return r._workerPool.cancelled()?Q.reject({runCancelled:!0}):(n("Preparing sandbox [%s]",s),Q.all([r._getPage(i),r._browserEnvironment.prepareSandbox(t,o,i)]))}).then(function(a){n("Prepared sandbox [%s]",s);var l=a[0],c=a[1];return Q.when({instance:{resume:function(){l.evaluate(function(){$_$tracer.resume()})},ping:function(e){l.evaluate(function(){},e)},close:function(e){t=null,l.stop&&l.stop(),l.close(),e(!0)},closing:function(){r._captureScreenShot(t.screen,l)},start:function(i,n){r._clearMemoryCache&&l.onResourceRequested(function(t,i,n){try{var r=global._urlUtil=global._urlUtil||e("url"),o=t.url;if(!o)return;if(0===o.indexOf("data:"))return;if(~o.indexOf("wallabyFileId"))return;var s=r.parse(t.url),a="/"===s.pathname.charAt(0)?s.pathname.substr(1):s.pathname,c=a&&n[a];if(!c)return;var u=s.search&&s.search.length;i.changeUrl(o+(u?"&":"?")+c.ts+"&wallabyFileId="+c.id),l.clearMemoryCache()}catch(h){console.log(h&&h.message)}},_.noop,t.allFilesHash),l.set("onError",n),l.open(c,function(e){i(e)&&l.evaluate(function(){$_$tracer.start()})})}},name:s,sessionId:o,workerId:i})})},cancel:function(e){var t=this;return t._workerPool.cancel(e)},start:function(){var e=this;return e._workerPool.start(e._browserEnvironment.webApp())},stop:function(){var e=this;e._workerPool.stop()},_captureScreenShot:function(e,t){var i=this;if(e){var n=Q.defer();try{t.render(e,function(){n.resolve()}),i._screenShotReady=n.promise}catch(r){n.reject(new Error("Failed to render test run screen shot")),console.error("Failed to render test run screen shot",r.message)}}},_getPage:function(e){var t=this;return t._workerPool.getWorker(e).then(function(i){return t._workerPool.cancelled()?Q.reject({runCancelled:!0}):(n("Creating page for worker #"+e),t._createPage(i,e))})},_createPage:function(e,t){var i=this;return Q.promise(function(r,o){var s=!1,a=setTimeout(function(){s||(l(),i._workerPool.recycleWorker(t),n("Phantom page is not created in time, recycling it"),o({runCancelled:!0,rerun:!0}))},400),l=function(){s=!0,clearTimeout(a)};try{e.createPage(function(e){s||(l(),n("Phantom page created"),e.set("viewportSize",i._viewportSize||{width:800,height:600}),r(e))})}catch(c){l(),o(c)}})}},t.exports=l},{"./browserEnvironment":10,"./runWorkerPool":63,phantom:void 0,url:void 0}],49:[function(e,t,i){t.exports=function(){function e(e,t){this._read=e,this._fs=t}return e.prototype.stat=function(){return this._fs.stat.apply(this._fs,arguments)},e.prototype.statSync=function(){return this._fs.statSync.apply(this._fs,arguments)},e.prototype.readdir=function(){return this._fs.readdir.apply(this._fs,arguments)},e.prototype.readdirSync=function(){return this._fs.readdirSync.apply(this._fs,arguments)},e.prototype.readlink=function(){return this._fs.readlink.apply(this._fs,arguments)},e.prototype.readlinkSync=function(){return this._fs.readlinkSync.apply(this._fs,arguments)},e.prototype.readFile=function(e,t,i){var n=this._read(e);n?("function"==typeof t&&(i=t,t=null),n.getContent().then(function(e){t?i(null,e):i(null,Buffer.from(e))})["catch"](function(e){i(e)})):this._fs.readFile.apply(this._fs,arguments)},e.prototype.readFileSync=function(e,t){var i=this._read(e);if(i){var n=i.getContentSync();return t?n:Buffer.from(n)}return this._fs.readFileSync.apply(this._fs,arguments)},e.prototype.readJson=function(e,t){this.readFile(e,function(e,i){if(e)t(e);else{var n=void 0;try{n=JSON.parse(i.toString("utf-8"))}catch(r){return void t(r)}t(null,n)}})},e.prototype.readJsonSync=function(e){var t=this.readFileSync(e);return JSON.parse(t.toString("utf-8"))},e.prototype.purge=function(){return this._fs.purge.apply(this._fs,arguments)},e}()},{}],50:[function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=e("path"),a=e("os"),l=e("util.promisify"),c=e("./InputFileSystem"),u=e("./loader"),h=e("../../utils"),d="WallabyPlugin",f=process.cwd();f.endsWith("/")&&(f=f.substring(0,f.length-1));var p="wallaby-webpack-entry.js",g=s.join(process.cwd(),p),v=function(){function e(e,t,i){var o=this;if(!e)throw new Error("webpack parameter is mandatory.");this._webpack=e,this._configuration=t||{},i=i||{},Array.isArray(i.setupFiles)||(i.setupFiles=[]),this._setupFiles=[],this._setupFileByFullPath=new Map;for(var a=function(e){var t=i.setupFiles[e];if("string"==typeof t){if(!l._setupFileByFullPath.get(t)){var a=s.resolve(t);l._setupFiles.push(a),l._setupFileByFullPath.set(a,a);
}}else if(t.code&&t.path){var c={fullPath:s.resolve(t.path),getContent:function(){return n(o,void 0,void 0,function(){return r(this,function(e){return[2,t.code]})})},getContentSync:function(){return t.code}};l._setupFileByFullPath.get(c.fullPath)||(l._setupFiles.push(c),l._setupFileByFullPath.set(c.fullPath,c))}},l=this,c=0;c<i.setupFiles.length;c++)a(c);i.mapResourceToPath&&(this._mapResourceToPath=i.mapResourceToPath)}return e.prototype.process=function(e){return n(this,void 0,void 0,function(){function t(e){return e.buildMeta&&e.buildMeta["aurelia-id"]?e.buildMeta["aurelia-id"]:e.id}var i,n,c,u,h,d,p,v,y,m,_,b,k,T,S,C,L,j,w,x,F,E,R,I,M,T,O,P,q,N,A,D=this;return r(this,function(r){switch(r.label){case 0:return this._logger=e.logger,this._logger.debug("Processing started."),this._settings=e.settings,i=new Map,this._deletedFilePaths=new Set,n=!!this._compilation,n?(e.anyFilesAdded||e.anyFilesDeleted?(this._dependecyFileIdsByFileId={},this._moduleIdByFileFullPath=new Map,this._filePathByModuleId={},this._testFilePathByModuleId={},this._testFileModuleIdByPath={},this._initializeEntry(e.allTestFiles),e.allFiles.forEach(function(e){return i.set(e.fullPath,e)}),e.anyFilesDeleted&&this._fileByFullPath.forEach(function(e,t){return i.has(t)?{}:D._deletedFilePaths.add(t)}),this._fileByFullPath=i,this._affectedFileByFullPath=i,u=this._compilation.compiler.inputFileSystem,e.affectedFiles.forEach(function(e){return u.purge(e.fullPath)}),this._deletedFilePaths.forEach(function(e){return u.purge(e)})):(e.affectedFiles.forEach(function(e){return i.set(e.fullPath,e)}),this._affectedFileByFullPath=i),c=this._compilation.compiler):(this._logger.debug("Initializing."),e.allFiles.forEach(function(e){return i.set(e.fullPath,e)}),this._fileByFullPath=i,this._affectedFileByFullPath=i,this._dependecyFileIdsByFileId={},this._moduleIdByFileFullPath=new Map,this._filePathByModuleId={},this._testFilePathByModuleId={},this._testFileModuleIdByPath={},this._compilation=null,this._initializeEntry(e.allTestFiles),this._sanitizeConfiguration(),this._adjustConfiguration(e.timestamp),c=this._createCompiler(),this._customizeCompiler(c)),this._prepareCompiler(n,e.anyFilesAdded,e.anyFilesDeleted,e.affectedFiles,c),h=l(c.compile).bind(c),this._logger.debug("Compilation started%s.",n?" (incremental)":""),[4,h()];case 1:if(r.sent(),d=this._compilation,d.errors.length){p=void 0;try{p=this._formatErrors(d)}catch(B){throw d.errors[0]}throw new Error(p)}this._logger.debug("Compilation finished."),v=!n||e.anyFilesAdded||e.anyFilesDeleted?d.modules:d.wallaby.modules,y=[];try{for(m=o(v),_=m.next();!_.done;_=m.next())b=_.value,"runtime"!==b.type&&b.resource!==g&&(k=this._mapResourceToPath?this._mapResourceToPath(b):b.resource,this._deletedFilePaths.has(k)||(this._logger.trace("Processing module %s (%s).",b.id,b.resource||b.userRequest),"string"==typeof k&&(k.startsWith(f)?this._filePathByModuleId[b.id]="."+k.substring(f.length):this._filePathByModuleId[b.id]=k),T=this._affectedFileByFullPath.get(k)||this._fileByFullPath.get(k),S=b.wallaby||{},C=this._renderModule(d,b),C?(L=b.resourceResolveData&&b.resourceResolveData.patch,j=L?L(C.source()):C.source(),w=C.map(),x=t(b),T&&T.test&&(F=[],this._traverseDependencies(d,b,F),this._dependecyFileIdsByFileId[T.id]=F),y.push(e.createFile({path:T?""+T.path+(T.test?"":"."+b.id)+".wbp.js":s.join("__modules",b.id+".js"),original:T,content:"window.__moduleBundler.modules["+JSON.stringify(x)+"] = function(module, exports, __webpack_exports__, __webpack_require__) {"+(b.strict?'"use strict";':"")+j+a.EOL+"};",sourceMap:w,ranges:S.ranges,extra:{sourceMap:S.map,testName:S.testName,loggedRanges:S.loggedRanges,numberOfFunctions:S.numberOfFunctions,includedTestFile:S.includedTestFile,excludedTestFile:S.excludedTestFile,notInstrumentedLogMarkers:S.notInstrumentedLogMarkers,liveCommentLines:S.liveCommentLines}})),T||(T=this._setupFileByFullPath.get(k),T&&"string"==typeof T&&(T={fullPath:T})),T&&(this._moduleIdByFileFullPath.set(T.fullPath,x),T.test&&(this._testFilePathByModuleId[b.id]=T.path,this._testFileModuleIdByPath[T.path]=b.id))):this._logger.trace("Ignoring module %s (%s).",b.id,b.resource||b.userRequest)))}catch(U){P={error:U}}finally{try{_&&!_.done&&(q=m["return"])&&q.call(m)}finally{if(P)throw P.error}}if(!n||e.anyFilesAdded||e.anyFilesDeleted){y.push(e.createFile({order:-1,path:"____wallaby-webpack.js",content:this._templates.webpack()})),y.push(e.createFile({order:-.99,path:"____wallaby-webpack-bootstrapper.js",content:this._templates.bootstrapper(this._testFileModuleIdByPath,this._testFilePathByModuleId,this._filePathByModuleId)})),E=[];try{for(R=o(this._setupFiles),I=R.next();!I.done;I=R.next())M=I.value,T=void 0,"string"==typeof M?(T=this._fileByFullPath.get(M),T||(T={fullPath:M})):T=M,T&&!T.test&&(O=this._moduleIdByFileFullPath.get(T.fullPath),O&&E.push("window.__moduleBundler.require("+JSON.stringify(O)+");"))}catch(V){N={error:V}}finally{try{I&&!I.done&&(A=R["return"])&&A.call(R)}finally{if(N)throw N.error}}E.length&&y.push(e.createFile({path:"____wallaby-webpack-setup.js",order:1/0,content:E.join(a.EOL)}))}return this._logger.debug("Emitting %s files.",y.length),[4,Promise.all(y)];case 2:return r.sent(),this._logger.debug("Processing finished."),[2,{testDependencies:this._dependecyFileIdsByFileId}]}})})},Object.defineProperty(e.prototype,"_templates",{get:function(){throw new Error("Not implemented abstract member.")},enumerable:!1,configurable:!0}),e.prototype._initializeEntry=function(e){var t,i,n,r;this._logger.debug("Initializing entry.");var s=[];try{for(var l=o(this._setupFiles),c=l.next();!c.done;c=l.next()){var u=c.value,d=void 0;"string"==typeof u?(d=this._fileByFullPath.get(u),d||(d={fullPath:u})):d=u,d&&!d.test&&s.push("require('"+h.normalizePath(d.fullPath)+"');")}}catch(f){t={error:f}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(t)throw t.error}}try{for(var p=o(e),v=p.next();!v.done;v=p.next()){var d=v.value;s.push("require('./"+d.path+"');")}}catch(y){n={error:y}}finally{try{v&&!v.done&&(r=p["return"])&&r.call(p)}finally{if(n)throw n.error}}this._entry={path:g,ts:(new Date).getTime(),content:s.join(a.EOL)}},e.prototype.shutdown=function(){return n(this,void 0,void 0,function(){var e;return r(this,function(t){return this._compilation&&(e=this._compilation.compiler,e&&e.close)?[2,new Promise(function(t,i){e.close(function(e){e?i(e):t()})})]:[2,Promise.resolve()]})})},e.prototype._sanitizeConfiguration=function(){this._logger.debug("Sanitizing configuration.");var e=this._configuration;e.module||(e.module={}),e.plugins||(e.plugins=[]),e.resolve||(e.resolve={}),e.resolveLoader||(e.resolveLoader={}),e.resolve.plugins||(e.resolve.plugins=[]),e.resolveLoader.plugins||(e.resolveLoader.plugins=[]),e.optimization||(e.optimization={}),e.entry={main:g},e.mode="none",e.devtool="source-map"},e.prototype._adjustConfiguration=function(){var e=this;this._logger.debug("Adjusting configuration.");var t=this._configuration,i=t.plugins,o=function(t){if(t===g)return{getContent:function(){return n(e,void 0,void 0,function(){return r(this,function(e){return[2,this._entry.content]})})},getContentSync:function(){return e._entry.content}};var i=e._setupFileByFullPath.get(t);return i&&"string"!=typeof i?i:e._affectedFileByFullPath.get(t)||e._fileByFullPath.get(t)};i.unshift(function(e){e.inputFileSystem=new c(o,e.inputFileSystem)}),i.unshift(new this._webpack.DefinePlugin({"process.env.NODE_ENV":JSON.stringify("development")})),t.resolve.plugins.unshift(new y(this._setupFileByFullPath)),t.resolveLoader.plugins.unshift(new m);var s=t.optimization;void 0===s.removeAvailableModules&&(s.removeAvailableModules=!1),void 0===s.removeEmptyChunks&&(s.removeEmptyChunks=!1),void 0===s.mergeDuplicateChunks&&(s.mergeDuplicateChunks=!1),void 0===s.providedExports&&(s.providedExports=!1),void 0===s.splitChunks&&(s.splitChunks=!1)},e.prototype._createCompiler=function(){return this._logger.debug("Creating compiler."),this._webpack(this._configuration)},e.prototype._customizeCompiler=function(e){var t=this;this._logger.debug("Customizing compiler."),e.hooks.normalModuleFactory.tap(d,function(e){t._customizeNormalModuleFactory(e)}),e.hooks.thisCompilation.tap(d,function(e){t._initializeCompilation(e),t._customizeCompilation(e)})},e.prototype._customizeNormalModuleFactory=function(e){e.hooks.createModule.tap(d,function(e){if("stylable"!==e.type){var t=e.loaders;if(e.loaders.length>0){var i=t[0].loader,n=t[t.length-1].loader;i!==u.post.id&&t.unshift({loader:u.post.id,options:null}),n!==u.pre.id&&t.push({loader:u.pre.id,options:null})}else t.push({loader:u.single.id,options:null})}})},e.prototype._initializeCompilation=function(e){throw new Error("Not implemented abstract member.")},e.prototype._customizeCompilation=function(e){var t=this;e.wallaby={load:function(e){var i=t._mapResourceToPath?t._mapResourceToPath(e):e.resource;return t._affectedFileByFullPath.get(i)||t._fileByFullPath.get(i)},settings:this._settings,logger:this._logger,files:new Set,modules:[]},e.hooks.buildModule.tap(d,function(i){t._logger.trace("Compiled %s.",i.resource||i.userRequest),e.wallaby.modules.push(i)}),e.hooks.shouldGenerateChunkAssets.tap(d,function(){return!1})},e.prototype._prepareCompiler=function(e,t,i,n,r){},e.prototype._renderModule=function(e,t){throw new Error("Not implemented abstract member.")},e.prototype._traverseDependencies=function(e,t,i,n){throw new Error("Not implemented abstract member.")},e.prototype._formatErrors=function(e){throw new Error("Not implemented abstract member.")},e}(),y=function(){function e(e){this._setupFileByFullPath=e}return e.prototype.apply=function(e){var t=this,i=e.ensureHook("file");i.tapAsync(d,function(e,i,n){if(e.path===g)return n(null,{path:g});var r=t._setupFileByFullPath.get(e.path);return r&&"string"!=typeof r?n(null,{path:r.fullPath}):void n()})},e}(),m=function(){function e(){}return e.prototype.apply=function(e){var t="./node_modules/"+u.pre.id,i="./node_modules/"+u.post.id,n="./node_modules/"+u.single.id,r=e.ensureHook("file");r.tapAsync(d,function(e,r,o){return e.relativePath===t?o(null,{path:u.pre.id}):e.relativePath===i?o(null,{path:u.post.id}):e.relativePath===n?o(null,{path:u.single.id}):void o()})},e}();t.exports=v},{"../../utils":72,"./InputFileSystem":49,"./loader":52,os:void 0,path:void 0,"util.promisify":void 0}],51:[function(e,t,i){e("./modulePatch");var n=e("semver"),r=e("../../utils"),o=e("./loader"),s=e("./locator"),a="4.36.1";t.exports=function(t){return function(i,l,c){c=c?c:s.load(t),r.patchModule(o.single.id,function(){return o.single}),r.patchModule(o.pre.id,function(){return o.pre}),r.patchModule(o.post.id,function(){return o.post});var u=c.version;if(!n.valid(u)||n.lt(u,a))throw new Error("Only Webpack v"+a+" or higher is supported.");var h=n.major(u),d=e(4===h?"./v4/Postprocessor":"./v5/Postprocessor"),f=new d(c,i,l),p=f.process.bind(f);return p.owner=f,p.bundler={"native":!0},p}}},{"../../utils":72,"./loader":52,"./locator":53,"./modulePatch":54,"./v4/Postprocessor":55,"./v5/Postprocessor":57,semver:void 0}],52:[function(e,t,i){function n(e,t,i,n){if(!this._compilation||!this._compilation.wallaby)return void this.callback(null,e,t,i);var l=this._compilation.wallaby,c=l.load,u=l.settings,h=l.logger,d=l.files,f=c(this);if(f&&f.instrument)if(n||this.cacheable.verified)if(d.has(f.id))h.trace("Skipping instrumentation of '%s': file is already instrumented.",f.path);else{Buffer.isBuffer(e)&&(e=e.toString("utf-8"),65279===e.charCodeAt(0)&&(e=e.substr(1))),h.trace("Instrumenting '%s' [content %s, source-map %s].",f.path,!!e,!!t);var p=r.extend({},u.hints);f.test?(p.allowIgnoringCoverageInTests||(p=r.omit(p,"ignoreCoverage","ignoreCoverageForFile")),u.extractComments&&(p=r.omit(p,"testFileSelection"))):p=r.omit(p,"testFileSelection");var g=void 0;try{var v;t&&(f.changeStart||f.logMarkers&&f.logMarkers.length||f.extractedComments&&!f.extractedComments.isCoverageIgnored)&&(v=new o.SourceMapConsumer(t));var y=f.logMarkers||[];g=a(e,{file:f.id,test:f.test,testFileChangeStart:t?o.mapTextPosition(f.changeStart&&f.changePosition,v):f.changeStart,logMarkers:y.map(function(e){return{originalRange:e.range,range:o.mapOriginalRangeToTransformed(v,e.range),changeId:e.id,traceId:e.traceId,expanded:e.expanded,"new":e["new"],exp:e.exp,action:e.action}}),extractedComments:s(f.extractedComments,e,v),hints:p,recordValues:u.autoConsoleLog,preserveComments:u.preserveComments||!1,automaticTestFileSelection:f.test&&!u.extractComments&&u.automaticTestFileSelection,sequenceExpressionToDiff:!1}),g.liveCommentLines&&t?(v||(v=new o.SourceMapConsumer(t)),g.liveCommentLines=r.chain(g.liveCommentLines).map(function(e,t){return{line:parseInt(t,10),column:e+1}}).map(function(e){var t=e.line,i=e.column;return o.mapTransformedRangeToOriginal(v,[t,i,t,i])}).filter(function(e){return e&&e.length}).map(function(e){return e[0]}).value()):g.liveCommentLines&&(g.liveCommentLines=Object.keys(g.liveCommentLines).map(function(e){return parseInt(e,10)}).filter(function(e){return e}).map(function(e){return e}))}catch(m){throw o.formatInstrumentationError(m,e,f.path)}d.add(f.id),this._module.wallaby={ranges:g.ranges,loggedRanges:g.loggedRanges,map:t,testName:g.testName,numberOfFunctions:g.numberOfFunctions,includedTestFile:g.includedTestFile,excludedTestFile:g.excludedTestFile,notInstrumentedLogMarkers:g.notInstrumentedLogMarkers,liveCommentLines:g.liveCommentLines},e=g.code,t=t?o.combineSourceMaps(t,g.map):g.map,h.trace("Instrumented '%s'.",f.path)}else h.trace("Skipping instrumentation of '%s': file is wrapped by some loader.",f.path);this.callback(null,e,t,i)}var r=e("lodash"),o=e("../../utils"),s=e("../../utils/remapComments"),a=e("../../instrumentor");t.exports.pre=function(e,t,i){this.callback(null,e,t,i)},t.exports.pre.pitch=function(){this.cacheable.verified=!0},t.exports.pre.id="wallaby-pre-loader",t.exports.pre.raw=!0,t.exports.post=function(e,t,i){n.apply(this,[e,t,i,!1])},t.exports.post.id="wallaby-post-loader",t.exports.post.raw=!0,t.exports.single=function(e,t,i){n.apply(this,[e,t,i,!0])},t.exports.single.id="wallaby-loader",t.exports.single.raw=!0},{"../../instrumentor":44,"../../utils":72,"../../utils/remapComments":73,lodash:void 0}],53:[function(e,t,i){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=e("path"),o=e("../../utils");t.exports={load:function(e){var t,i,s=[];s.length||(s.push(r.join(e,"node_modules/@angular-devkit/build-angular")),s.push(r.join(e,"node_modules/react-scripts")),s.push(r.join(e)));var a;try{for(var l=n(s),c=l.next();!c.done;c=l.next()){var u=c.value,h=o.tryRequireModuleWithPathFrom(u,"webpack");if(h&&(a=h.module))return a}}catch(d){t={error:d}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(t)throw t.error}}throw new Error("Unable to load webpack module.")}}},{"../../utils":72,path:void 0}],54:[function(e,t,i){var n=e("../../utils");n.patchModulesCode([{files:["thread-loader/dist/index.js"],replacements:[{from:"function pitch() {",to:"function pitch() { this.loaders.slice(this.loaderIndex + 1); return;"}]}],"Possibly incompatible/unsupported thread-loader version")},{"../../utils":72}],55:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=e("../Postprocessor"),s=e("./templates"),a=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}return n(t,e),Object.defineProperty(t.prototype,"_templates",{get:function(){return s},enumerable:!1,configurable:!0}),t.prototype._adjustConfiguration=function(){e.prototype._adjustConfiguration.call(this);var t=this._configuration;t.cache=!1,void 0===t.module.unsafeCache&&(t.module.unsafeCache=!0)},t.prototype._initializeCompilation=function(e){var t=this;if(this._compilation)e.cache=this._compilation.cache;else{e.cache={};var i=e.fileTimestamps.get.bind(e.fileTimestamps);e.fileTimestamps.get=function(e){var t=i(e);return t?t:1};var n=e.contextTimestamps.get.bind(e.contextTimestamps);e.contextTimestamps.get=function(e){var t=n(e);return t?t:1}}var r=new Date(864e13).getTime();this._deletedFilePaths.forEach(function(t){e.fileTimestamps.set(t,r),e.contextTimestamps.set(t,r)});var o=(new Date).getTime();this._affectedFileByFullPath.forEach(function(t){e.fileTimestamps.set(t.fullPath,o),e.contextTimestamps.set(t.fullPath,o)}),e.fileTimestamps.set(this._entry.path,this._entry.ts),e.createHash=function(){return t.hash=""},e.sortItemsWithModuleIds=function(){},e.sortItemsWithChunkIds=function(){},this._compilation=e},t.prototype._renderModule=function(e,t){var i,n=e.moduleTemplates.javascript,r=n.render(t,e.dependencyTemplates,{});return i=3===r.children.length?r.children[1]:r.children[2]},t.prototype._traverseDependencies=function(e,t,i,n){var o,s;if(n||(n=new Set),t.dependencies)try{for(var a=r(t.dependencies),l=a.next();!l.done;l=a.next()){var c=l.value;if(c&&c.module&&c.module.resource){var u=c.module.resource;if(!n.has(u)){n.add(u);var h=this._fileByFullPath.get(u);h&&(i.push(h.id),this._traverseDependencies(e,c.module,i,n))}}}}catch(d){o={error:d}}finally{try{l&&!l.done&&(s=a["return"])&&s.call(a)}finally{if(o)throw o.error}}},t.prototype._formatErrors=function(e){var t,i,n=e.errors[0],o=e.requestShortener,s="";if("string"==typeof n&&(n={message:n}),n.file&&(s+=n.file+"\n"),n.module&&n.module.readableIdentifier&&"function"==typeof n.module.readableIdentifier){if(s+=this._formatFilePath(n.module.readableIdentifier(o)),"object"==typeof n.loc){var a=this._formatLocation(n.loc);a&&(s+=" "+a)}s+="\n"}if(s+=n.message,n.origin){if(s+="\n @ "+this._formatFilePath(n.origin.readableIdentifier(o)),"object"==typeof n.originLoc){var a=this._formatLocation(n.originLoc);a&&(s+=" "+a)}if(n.dependencies)try{for(var l=r(n.dependencies),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.loc&&"string"!=typeof u.loc){var a=this._formatLocation(u.loc);a&&(s+=" "+a)}}}catch(h){t={error:h}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(t)throw t.error}}for(var d=n.origin;d.issuer;)d=d.issuer,s+="\n @ "+d.readableIdentifier(o)}return s},t.prototype._formatFilePath=function(e){var t=/^(\s|\S)*!/;return e.includes("!")?e.replace(t,"")+" ("+e+")":""+e},t.prototype._formatLocation=function(e){return null===e?"":"string"==typeof e?e:"number"==typeof e?""+e:"object"==typeof e?"start"in e&&e.start&&"end"in e&&e.end?"object"==typeof e.start&&"number"==typeof e.start.line&&"object"==typeof e.end&&"number"==typeof e.end.line&&"number"==typeof e.end.column&&e.start.line===e.end.line?this._formatPosition(e.start)+"-"+e.end.column:this._formatPosition(e.start)+"-"+this._formatPosition(e.end):"start"in e&&e.start?this._formatPosition(e.start):"name"in e&&"index"in e?e.name+"["+e.index+"]":"name"in e?e.name:this._formatPosition(e):""},t.prototype._formatPosition=function(e){return null===e?"":"string"==typeof e?e:"number"==typeof e?""+e:"object"==typeof e?"line"in e&&"column"in e?e.line+":"+e.column:"line"in e?e.line+":?":"index"in e?"+"+e.index:"":""},t}(o);t.exports=a},{"../Postprocessor":50,"./templates":56}],56:[function(e,t,i){t.exports={webpack:function(){return"\n    window.__moduleBundler = {};\n    window.__moduleBundler.modules = {};\n    window.__moduleBundler.installedModules = {};\n    window.__moduleBundler.assert = function(moduleId, suppressTestVerification) {};\n    window.__moduleBundler.require = function(moduleId, suppressTestVerification) {    \n      // Check if module is in cache\n      if(window.__moduleBundler.installedModules[moduleId]) {\n          return window.__moduleBundler.installedModules[moduleId].exports;\n      }\n      \n      window.__moduleBundler.assert(moduleId, suppressTestVerification);\n      \n      // Create a new module (and put it into the cache)\n      var module = window.__moduleBundler.installedModules[moduleId] = {\n          i: moduleId,\n          l: false,\n          exports: {}\n      };\n \n      const executor = window.__moduleBundler.modules[moduleId];\n \n      if(!executor) {\n        throw new Error('Cannot find module ' + moduleId + '.');\n      }\n \n      // Execute the module function\n      try {\n        executor.call(module.exports, module, module.exports, module.exports, window.__moduleBundler.require);\n      } catch (err) {\n        if (err && !err.moduleLoadError) {\n          if (window.__moduleBundler.filePathByModuleId[moduleId]) {\n            err.moduleLoadError = true;\n            err.message = window.__moduleBundler.filePathByModuleId[moduleId] + ' : ' + err.message;\n          }\n        }\n        throw err;\n      }      \n  \n      // Flag the module as loaded\n      module.l = true;\n  \n      // Return the exports of the module\n      return module.exports;\n    };\n    \n    // expose the modules object (__webpack_modules__)\n    window.__moduleBundler.require.m = window.__moduleBundler.modules;\n    \n    // expose the module cache\n    window.__moduleBundler.require.c = window.__moduleBundler.installedModules;\n    \n    (function() {  \n      var hasOwnProperty = Object.prototype.hasOwnProperty;\n        \n      // define getter function for harmony exports\n      window.__moduleBundler.require.d = function(exports, name, getter) {\n        if(!hasOwnProperty.call(exports, name)) {\n            Object.defineProperty(exports, name, { enumerable: true, get: getter });\n        }\n      };\n    })();\n    \n    // define __esModule on exports\n    window.__moduleBundler.require.r = function(exports) {\n      if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n          Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n      }\n      Object.defineProperty(exports, '__esModule', { value: true });\n    };\n\n    // create a fake namespace object\n    // mode & 1: value is a module id, require it\n    // mode & 2: merge all properties of value into the ns\n    // mode & 4: return value when already ns object\n    // mode & 8|1: behave like require\n    window.__moduleBundler.require.t = function(value, mode) {\n      if(mode & 1) value = window.__moduleBundler.require(value);\n      if(mode & 8) return value;\n      if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n      var ns = Object.create(null);\n      window.__moduleBundler.require.r(ns);\n      Object.defineProperty(ns, 'default', { enumerable: true, value: value });\n      if(mode & 2 && typeof value != 'string') for(var key in value) window.__moduleBundler.require.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n      return ns;\n    };\n    \n    // getDefaultExport function for compatibility with non-harmony modules\n    window.__moduleBundler.require.n = function(module) {\n        var getter = module && module.__esModule ?\n            function getDefault() { return module['default']; } :\n            function getModuleExports() { return module; };\n        window.__moduleBundler.require.d(getter, 'a', getter);\n        return getter;\n    };\n\n    window.__moduleBundler.require.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n        \n    // __webpack_public_path__\n    window.__moduleBundler.require.p = \"\";\n    \n    // on error function for async loading\n    window.__moduleBundler.require.oe = function(err) { console.error(err); throw err; };\n    \n    window.__moduleBundler.require.i = function(value) { return value; };\n    \n    window.__moduleBundler.require.e = function() { return Promise.resolve(); };\n  "},bootstrapper:function(e,t,i){return"\n    window.__moduleBundler.testFileModuleIdByPath = "+JSON.stringify(e)+";\n    window.__moduleBundler.testFilePathByModuleId = "+JSON.stringify(t)+";\n    window.__moduleBundler.filePathByModuleId = "+JSON.stringify(i)+';\n    window.__moduleBundler.assert = function(moduleId, suppressTestVerification) {\n      if(!suppressTestVerification) {\n        var path = window.__moduleBundler.testFilePathByModuleId[moduleId];\n        if(path) {\n          throw new Error("Test file " + path + " is being imported from other test files.\\nThis may cause tests in the file to be executed more than once (when the test file runs and every time it gets imported).\\nIf the test file contains some test helper code, try refactoring the reused code into a file of its own and use it by importing the new helper file where required.");\n        }\n      }\n    };\n    window.__moduleBundler.loadTests = function () { \n      window.wallaby._startWhenReceiverIsReady(function() {\n        for(var i = 0, len = wallaby.loadedTests.length; i < len; i++)\n        {\n          var path = wallaby.loadedTests[i];\n          if (path && path.length > 7 && path.substr(-7) === ".wbp.js") {\n            window.__moduleBundler.require(window.__moduleBundler.testFileModuleIdByPath[path.substr(0, path.length - 7)], true);      \n          }\n        }\n      });\n    };    \n  '}}},{}],57:[function(e,t,i){var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},s=e("../Postprocessor"),a=e("./templates"),l=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}return n(t,e),Object.defineProperty(t.prototype,"_templates",{get:function(){return a},enumerable:!1,configurable:!0}),t.prototype._adjustConfiguration=function(t){e.prototype._adjustConfiguration.call(this,t);var i=this._configuration;i.cache&&"filesystem"===i.cache.type?i.cache.version=""+t:i.cache||(i.cache={type:"memory"})},t.prototype._initializeCompilation=function(e){var t,i,n,s;if(!this._compilation){var a=this._webpack.javascript.JavascriptModulesPlugin;this._javascriptModulesPluginClass=a,this._javascriptModulesPluginInstance=new a}if(e.fileSystemInfo._fileTimestamps.map){e.compiler.fileTimestamps=new Map;try{for(var l=r(e.fileSystemInfo._fileTimestamps),c=l.next();!c.done;c=l.next()){var u=o(c.value,2),h=u[0],d=u[1];e.compiler.fileTimestamps.has(h)||e.compiler.fileTimestamps.set(h,d)}}catch(f){t={error:f}}finally{try{c&&!c.done&&(i=l["return"])&&i.call(l)}finally{if(t)throw t.error}}e.fileSystemInfo._fileTimestamps.stack=[e.compiler.fileTimestamps]}else e.compiler.fileTimestamps=e.fileSystemInfo._fileTimestamps;if(e.fileSystemInfo._contextTimestamps.map){e.compiler.contextTimestamps=new Map;try{for(var p=r(e.fileSystemInfo._contextTimestamps),g=p.next();!g.done;g=p.next()){var v=o(g.value,2),h=v[0],d=v[1];e.compiler.contextTimestamps.has(h)||e.compiler.contextTimestamps.set(h,d)}}catch(y){n={error:y}}finally{try{g&&!g.done&&(s=p["return"])&&s.call(p)}finally{if(n)throw n.error}}e.fileSystemInfo._contextTimestamps.stack=[e.compiler.contextTimestamps]}else e.compiler.contextTimestamps=e.fileSystemInfo._contextTimestamps;var m=new Date(864e13).getTime();e.compiler.modifiedFiles=new Set,e.compiler.removedFiles=new Set,this._deletedFilePaths.forEach(function(t){e.compiler.removedFiles.add(t),e.compiler.fileTimestamps.set(t,{safeTime:m,timestamp:m}),e.compiler.contextTimestamps.set(t,{safeTime:m,timestamp:m})}),this._affectedFileByFullPath.forEach(function(t){e.compiler.modifiedFiles.add(t.fullPath),e.compiler.fileTimestamps.set(t.fullPath,{safeTime:t.id+"_"+t.ts,timestamp:t.id+"_"+t.ts})}),e.compiler.fileTimestamps.set(this._entry.path,{safeTime:this._entry.ts,timestamp:this._entry.ts}),this._compilation=e},t.prototype._renderModule=function(e,t){var i={dependencyTemplates:e.dependencyTemplates,runtimeTemplate:e.runtimeTemplate,moduleGraph:e.moduleGraph,chunkGraph:e.chunkGraph,codeGenerationResults:e.codeGenerationResults,chunk:{}};if(!e.codeGenerationResults.map.has(t))return null;var n=this._javascriptModulesPluginClass.getCompilationHooks(e),r=this._javascriptModulesPluginInstance.renderModule(t,i,n,!0);if(!r)return null;var o,s=r.original(),a=s.getChildren();return o=3===a.length?a[1]:a[2]},t.prototype._traverseDependencies=function(e,t,i,n){var o,s;n||(n=new Set);try{for(var a=r(e.moduleGraph.getOutgoingConnections(t)),l=a.next();!l.done;l=a.next()){var c=l.value;if(c.module&&c.module.resource){var u=c.module.resource;if(!n.has(u)){n.add(u);var h=this._fileByFullPath.get(u);h&&(i.push(h.id),this._traverseDependencies(e,c.module,i,n))}}}}catch(d){o={error:d}}finally{try{l&&!l.done&&(s=a["return"])&&s.call(a)}finally{if(o)throw o.error}}},t.prototype._formatErrors=function(e){var t=e.requestShortener,i=e.errors[0],n=[];if("string"!=typeof i&&i.module)for(var r=e.moduleGraph,o=new Set,s=i.module;s&&!o.has(s);){o.add(s);var a=r.getIssuer(s);if(!a)break;n.push({origin:a,module:s}),s=a}return"string"==typeof i&&(i={message:i}),n.length&&(i.message=""+i.message+n.map(function(e){return"\n@ "+e.module.readableIdentifier(t)}).join()),i.message},t}(s);t.exports=l},{"../Postprocessor":50,"./templates":58}],58:[function(e,t,i){t.exports={webpack:function(){return"\n    window.__moduleBundler = {};\n    window.__moduleBundler.modules = {};\n    window.__moduleBundler.installedModules = {};\n    window.__moduleBundler.assert = function(moduleId, suppressTestVerification) {};\n    window.__moduleBundler.require = function(moduleId, suppressTestVerification) {    \n\n      if(window.__moduleBundler.installedModules[moduleId]) {\n          return window.__moduleBundler.installedModules[moduleId].exports;\n      }\n      \n      window.__moduleBundler.assert(moduleId, suppressTestVerification);\n      \n      var module = window.__moduleBundler.installedModules[moduleId] = {\n          id: moduleId,\n          loaded: false,\n          exports: {}\n      };\n \n      const executor = window.__moduleBundler.modules[moduleId];\n \n      if(!executor) {\n        throw new Error('Cannot find module ' + moduleId + '.');\n      }\n      \n      // Execute the module function\n      try {\n        executor.call(module.exports, module, module.exports, module.exports, window.__moduleBundler.require);\n      } catch (err) {\n        if (err && !err.moduleLoadError) {\n          if (window.__moduleBundler.filePathByModuleId[moduleId]) {\n            err.moduleLoadError = true;\n            err.message = window.__moduleBundler.filePathByModuleId[moduleId] + ' : ' + err.message;\n          }\n        }\n        throw err;\n      }\n      \n      module.loaded = true;\n      \n      return module.exports;\n    };\n        \n    (function() {  \n      var hasOwnProperty = Object.prototype.hasOwnProperty;\n      window.__moduleBundler.require.d = function(exports, definition) {\n        for(var key in definition) {\n          if(hasOwnProperty.call(definition, key) && !hasOwnProperty.call(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n          }\n        }\n      };\n    })();\n    \n    window.__moduleBundler.require.r = function(exports) {\n      if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n          Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n      }\n      Object.defineProperty(exports, '__esModule', { value: true });\n    };\n    \n    window.__moduleBundler.require.p = \"\";\n    \n    window.__moduleBundler.require.e = function() { return Promise.resolve(); };\n    \n    window.__moduleBundler.require.oe = function(err) { console.error(err); throw err; };\n    \n    window.__moduleBundler.require.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n    \n    window.__moduleBundler.require.i = [];\n    \n    window.__moduleBundler.require.c = window.__moduleBundler.installedModules;\n    \n    window.__moduleBundler.require.m = window.__moduleBundler.modules;\n    \n    window.__moduleBundler.require.n = function(module) {\n      var getter = module && module.__esModule ?\n        function getDefault() { return module['default']; } :\n        function getModuleExports() { return module; };\n      window.__moduleBundler.require.d(getter, { a: getter });\n      return getter;\n    };\n    \n    window.__moduleBundler.require.t = function(value, mode) {\n      if(mode & 1) value = this(value);\n      if(mode & 8) return value;\n      if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n      var ns = Object.create(null);\n      window.__moduleBundler.require.r(ns);\n      var def = {};\n      if(mode & 2 && typeof value == 'object' && value) {\n        for(const key in value) def[key] = function() { return value[key]; };\n      }\n      def['default'] = function() { return value; };\n      window.__moduleBundler.require.d(ns, def);\n      return ns;\n    };\n    \n    window.__moduleBundler.require.nmd = function(module) {\n      module.paths = [];\n      if (!module.children) module.children = [];\n      return module;\n    }\n\n    window.__moduleBundler.require.hmd = function(module) {\n      module = Object.create(module);\n      if (!module.children) module.children = [];\n      Object.defineProperty(module, 'exports', {\n        enumerable: true,\n        set: function() {\n          throw new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n        }\n      });\n      return module;\n    }\n    \n    window.__moduleBundler.require.g = (function() {\n      if (typeof globalThis === 'object') return globalThis;\n      try {\n        return this || new Function('return this')();\n      } catch (e) {\n        if (typeof window === 'object') return window;\n      }\n    })();\n    \n    window.__moduleBundler.require.v = function() {\n      throw new Error('WASM modules are not supported yet.');\n    }\n  ";
},bootstrapper:function(e,t,i){return"\n    window.__moduleBundler.testFileModuleIdByPath = "+JSON.stringify(e)+";\n    window.__moduleBundler.testFilePathByModuleId = "+JSON.stringify(t)+";\n    window.__moduleBundler.filePathByModuleId = "+JSON.stringify(i)+';\n    window.__moduleBundler.assert = function(moduleId, suppressTestVerification) {\n      if(!suppressTestVerification) {\n        var path = window.__moduleBundler.testFilePathByModuleId[moduleId];\n        if(path) {\n          throw new Error("Test file " + path + " is being imported from other test files.\\nThis may cause tests in the file to be executed more than once (when the test file runs and every time it gets imported).\\nIf the test file contains some test helper code, try refactoring the reused code into a file of its own and use it by importing the new helper file where required.");\n        }\n      }\n    };\n    window.__moduleBundler.loadTests = function () { \n      window.wallaby._startWhenReceiverIsReady(function() {\n        for(var i = 0, len = wallaby.loadedTests.length; i < len; i++)\n        {\n          var path = wallaby.loadedTests[i];\n          if (path && path.length > 7 && path.substr(-7) === ".wbp.js") {\n            window.__moduleBundler.require(window.__moduleBundler.testFileModuleIdByPath[path.substr(0, path.length - 7)], true);      \n          }\n        }\n      });\n    };    \n  '}}},{}],59:[function(e,t,i){"use strict";var n=function(){function e(e,t,i){this.type=e.type,this.path=e.path,this.content=t,this.maps=[],this.config=i}return e.prototype.rename=function(e){return this.newPath=e,this},e.prototype.changeExt=function(e){var t=this.newPath||this.path;return this.newPath=t.substr(0,t.lastIndexOf(".")+1)+e,this},e}();t.exports=n},{}],60:[function(e,t,i){function n(e){this.process=o.fork(e,["worker"]),this.pid=this.process.pid,this.status=WorkerState.STARTING,this.process.once("message",this.onReady.bind(this)),s.EventEmitter.call(this)}function r(e,t){function i(){var t=new n(e);t.on("ready",r._run.bind(r)),t.process.on("exit",function(e){if(0!==e){for(var n=0;n<r.workers.length;n++)r.workers[n].pid===t.pid&&r.workers.splice(n,1);i()}}),r.workers.push(t)}this.workers=[],this.queue=[];var r=this;t=t||a.cpus().length;for(var o=0;o<t;o++)i()}var o=e("child_process"),s=e("events"),a=e("os"),l=e("util");WorkerState={STARTING:"STARTING",READY:"READY",BUSY:"BUSY"},l.inherits(n,s.EventEmitter),n.prototype.onReady=function(){this.status===WorkerState.STARTING&&(this.status=WorkerState.READY,this.emit("ready",this))},n.prototype.onMessage=function(e,t){e(t),this.status=WorkerState.READY,this.emit("ready",this)},n.prototype.send=function(e,t){this.status=WorkerState.BUSY,this.emit("busy"),this.process.once("message",this.onMessage.bind(this,t)),this.process.send(e)},r.prototype.enqueue=function(e,t){this.queue.push({task:e,callback:t}),process.nextTick(this._run.bind(this))},r.prototype.stop=function(){_.each(this.workers,function(e){e.process.send({type:"exit"})})},r.prototype._run=function(e){if(0!==this.queue.length){if(!e)for(var t=0;t<this.workers.length;t++)if(this.workers[t].status===WorkerState.READY){e=this.workers[t];break}if(e){var i=this.queue.shift();e.send(i.task,i.callback)}}},t.exports={_queue:void 0,start:function(e){this._queue||(this._queue=new r(e))},started:function(){return!!this._queue},run:function(e){var t=this;return t._queue?Q.promise(function(i,n){try{t._queue.enqueue(e,function(e){i(e)})}catch(r){n(r)}}):Q.reject(new Error("Processor pool is not started"))},stop:function(){this._queue&&(this._queue.stop(),delete this._queue)}}},{child_process:void 0,events:void 0,os:void 0,util:void 0}],61:[function(e,t,i){"use strict";var n,r=e("path"),o=e("minimatch"),s=e("./config"),a=e("./utils"),l=e("./preprocessedFile"),c=logger.create("processor"),u=c.debug,h=c.trace,d=!1,f="Processor must pass a string, an object with code property or an error to done function.",p="Processor must be an async function with two params, where last param is done callback, or sync function with one param and returning the result.",g=function(){function e(e,t){this._config=e,this._settingsAreReady=_.isObject(this._config),this._root=t,this._localRoot=this._settingsAreReady?process.cwd():r.dirname(e)}return e.prototype.run=function(e,t,i){var n=this,r=this;return(this._settingsAreReady?Q.when(this._config):s(this._config,this._root)).then(function(o){var s=r._processors(o,t,i);if(!s.length)return h("No %s found for %s",i?"compilers":"preprocessors",t.path),Q.when({content:e,noProcessors:!0});i&&(s=[s[0]]);var a=new l(t,e,o);a.additionalPreset=n._additionalPreset(o);var c=Q.when(a);return h("Running %s processor(s) for %s",s.length,t.path),s.forEach(function(e){c=c.then(function(i){return Q.promise(function(n,r){try{var o=function(e){h("Finished running one processor for %s",t.path);var o;if(e instanceof Error)return void r(e);if(_.isObject(e)){if(!_.isString(e.code))return void r(new Error(f));o=e.code;var s=e.map||e.sourceMap;s&&(!s.version&&s._mappings&&s.toString&&(s=s.toString()),i.maps.push(s)),e.ranges&&(i.ranges=e.ranges),e.scriptRange&&(i.scriptRange=e.scriptRange),e.noScript&&(i.noScript=e.noScript)}else{if(!_.isString(e))return void r(new Error(f));o=e}i.content=o,n(i)};if(1===e.length){var s=void 0;try{s=e(i)}catch(a){s=a}finally{o(s)}}else 2===e.length?e(i,o):r(new Error(p))}catch(l){r(l)}})})}),c})},e.prototype._additionalPreset=function(e){if(!d){if(e.testFramework&&e.testFramework.version&&0===e.testFramework.version.indexOf("jest"))try{n=a.requireModuleFrom(this._localRoot,"babel-preset-jest")}catch(t){try{n=a.requireModuleFrom(this._localRoot,"react-scripts/node_modules/babel-preset-jest")}catch(i){u("WARNING: could not find and load babel-preset-jest preset, it is required for correct jest.mock(...) calls hoisting")}}d=!0}return n},e.prototype._processors=function(e,t,i){var n=[],s=i?e.compilers:e.preprocessors;return _.each(s,function(i,s){if(!_.isString(s))throw new Error("Processor patterns object keys must be strings.");if(!_.isArray(i)&&!_.isFunction(i))throw new Error('Processor(s) for "'+s+'" is specified incorrectly, must be an array of functions or a function.');_.isFunction(i)&&(i=[i]),o(0===(t.path||"").indexOf("..")?r.basename(t.path):t.path,s,{dot:e.dot})&&(n=n.concat(_.map(i,function(e){if(!_.isFunction(e))throw new Error('Processor for "'+s+'" is specified incorrectly, must be an array of functions or a function.');return e})))}),n},e}();t.exports=function(e){return new g(e.config,e.root).run(e.content,e.file,"compiler"===e.type)}},{"./config":14,"./preprocessedFile":59,"./utils":72,minimatch:void 0,path:void 0}],62:[function(require,module,exports){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},path=require("path"),url=require("url"),semver=require("semver"),configure=require("./config"),utils=require("./utils"),sharedUtils=require("./extension/shared/utils"),remapComments=require("./utils/remapComments"),instrument=require("./instrumentor"),processor=require("./processor"),TestTask=require("./testTask").TestTask,Tracker=require("./tracking"),runPriority=require("./testTask").runPriority,_a=logger.create("project"),debug=_a.debug,trace=_a.trace,ProfileViewer=require("./chromeProfileViewer"),cp=require("child_process"),spawn=cp.spawn,spawnedProcesses={};cp.spawn=function(){"cmd"===arguments[0]&&arguments[1]&&arguments[1].length>=3&&"/d"===arguments[1][0]&&"/c"===arguments[1][1]&&(arguments[0]=arguments[1][2],arguments[1].splice(0,3));var e=spawn.apply(this,arguments);try{var t=e.pid;e.on("exit",function(){t&&delete spawnedProcesses[t]}),spawnedProcesses[t]=e}catch(i){}return e};var testPathSeparator="^#^",runAlways=1,runOneTime=2,bundleFileId="bundle",suggestConfigAutoDetectionNotificationIdBase="suggestConfigAutoDetection",Project=function(e){var t=this;t._structureFileFormatVersion=23,t._wallabyEmail=sharedUtils.wallabyEmail(),t._diffMatchPatch=e.diffMatchPatch,t._processorPool=e.processorPool,t._runnerResolver=e.runnerResolver,t._fileStructureCachePromise=e.fileStructureCachePromise,t._fileStatPromise=e.fileStatPromise,t._readFilePromise=e.readFilePromise,t._writeFilePromise=e.writeFilePromise,t._unlinkFilePromise=e.unlinkFilePromise,t._unlinkFileSync=e.unlinkFileSync,t._readFileSync=e.readFileSync,t._writeFileSync=e.writeFileSync,t._fileExistsSync=e.fileExistsSync,t._dirRemovePromise=e.dirRemovePromise,t._dirRemoveSync=e.dirRemoveSync,t._dirEnsurePromise=e.dirEnsurePromise,t._dirEnsureSync=e.dirEnsureSync,t._lruCache=require("lru-cache")({max:52428800,length:function(e){return e.length}});var i,n;t._configFile=e.configPath,t._structureFile="structure.json",t._allowAutomaticConfigNotification=!0;var r=suggestConfigAutoDetectionNotificationIdBase+"_"+(e.projectCachePath&&path.basename(e.projectCachePath)),o=e.homeDir||require("os").homedir();if(t._globalSettingsDir=path.join(o,process.env.quokka?".quokka":".wallaby"),e.dirEnsureSync(t._globalSettingsDir),t._notificationSettingsFile=path.join(t._globalSettingsDir,"notifications.json"),t._fileExistsSync(t._notificationSettingsFile))t._allowAutomaticConfigNotification=!t.isNotificationMuted(r),t.muteNotification(r);else{var s={};s[r]={},t._writeFileSync(t._notificationSettingsFile,JSON.stringify(s))}if(process.env.quokka){var a,l,c;try{t._globalSettingsDir=path.join(e.homeDir,".quokka"),t._quokkaTempDir=path.join(t._globalSettingsDir,"data",utils.randomId()),t._quokkaGlobalSettingsFile=path.join(t._globalSettingsDir,"config.json"),t._quokkaGlobalPackageFile=path.join(t._globalSettingsDir,"package.json"),a=!0,t._root="quokka_fake_path",t._quokkaFileName=e.quokka,t._localRoot=process.cwd(),t._useMemoryFs=e.useMemoryFs,t._originalLocalRoot=t._localRoot;for(var u=path.dirname(path.join(t._localRoot,t._quokkaFileName));u.length>t._localRoot.length;){if(e.fileExistsSync(path.join(u,"package.json"))){t._originalLocalRoot=t._localRoot,t._originalQuokkaFileName=t._quokkaFileName,t._quokkaFileName=path.join(t._localRoot,t._quokkaFileName).substring(u.length+1),e.quokka=t._quokkaFileName,t._localRoot=u,process.chdir(t._localRoot);break}u=path.dirname(u)}for(var h=t._localRoot;h.length>=t._originalLocalRoot.length&&(t._quokkaLocalSettingsFile=path.join(h,".quokka"),!e.fileExistsSync(t._quokkaLocalSettingsFile));)h=path.dirname(h);t._originalRoot=path.join("quokka_fake_path","original"),t._instrumentedRoot=path.join("quokka_fake_path","instrumented"),t._editorTypeScript=e.editorTypeScript,l=!0,e.useMemoryFs(t._root),e.useMemoryFs(t._originalRoot),e.useMemoryFs(t._instrumentedRoot),e.useMemoryFs(path.join(t._root,t._structureFile));var d=path.join(t._localRoot,t._quokkaFileName),f=path.join(t._originalRoot,path.basename(t._quokkaFileName));e.useMemoryFs(d),e.useMemoryFs(f,utils.isLevelUpRelativePath(t._quokkaFileName)),c=!0;var p="// This is an empty file waiting for changes";t._writeFileSync(d,p),t._writeFileSync(f,p),e.useMemoryFs(path.join(t._instrumentedRoot,t._quokkaFileName)),t._fullInstrumentedPathForTestRunner=function(e){return utils.isLevelUpRelativePath(t._quokkaFileName)?path.relative(t._localRoot,t._quokkaFileName):e.instrumentedPath.replace(t._instrumentedRoot,t._localRoot)}}catch(g){throw new Error("Failed to initialize Quokka paths\n    homeDir: "+e.homeDir+", \n    cwd: "+process.cwd()+"\n    globalSettingsDir: "+t._globalSettingsDir+"\n    localSettingsFile: "+t._quokkaLocalSettingsFile+"\n    quokkaFileName: "+e.quokka+"\n    init status: "+a+", "+l+", "+c+"\n"+g.stack)}}else t._root=e.projectCachePath,t._configFile=e.configPath,t._testsPath=e.testsPath,t._localRoot=path.dirname(t._configFile),t._originalRoot=path.join(t._root,"original"),t._instrumentedRoot=path.join(t._root,"instrumented");if(i=path.join(t._localRoot,"node_modules"),t._nodeModules=t._fileExistsSync(i)?i:void 0,t._packageJson=path.join(t._localRoot,"package.json"),t._babelrc=path.join(t._localRoot,".babelrc"),t._babelrcjs=path.join(t._localRoot,".babelrc.js"),t._localProjectDir=t._localRoot+path.sep,n=path.join(t._instrumentedRoot,"node_modules"),t._screenPath=path.join(t._instrumentedRoot,"screen.png"),t._profilePath=path.join(t._globalSettingsDir,"test.cpuprofile"),!process.env.quokka&&t._nodeModules&&e.nodeModulesLookup(function(e){e.push(i)},function(e){return e.replace(n,i)}),process.env.quokka){var v=path.join(t._globalSettingsDir,"node_modules");e.dirEnsureSync(t._quokkaTempDir),t._writeFileSync(path.join(t._quokkaTempDir,"package.json"),"{}"),e.dirEnsureSync(path.join(t._quokkaTempDir,"node_modules")),e.cidFile=path.join(t._globalSettingsDir,".qid"),e.lkp=path.join(t._globalSettingsDir,".qlc"),t._fileExistsSync(t._quokkaGlobalSettingsFile)||t._writeFileSync(t._quokkaGlobalSettingsFile,"{}"),t._fileExistsSync(t._quokkaGlobalPackageFile)||t._writeFileSync(t._quokkaGlobalPackageFile,"{}"),t._loadQuokkaSettings(e.quokkaSettingsOverride),e.edition=t._quokkaSettings.quokka.edition||"",e.nodeModulesLookup(function(e){e.push(v)})}t._live=!1,t._sourceFileCache={},t._changeQueue={},t._testTask=new TestTask(t),t._tracker=new Tracker(e,process.env.quokka?path.dirname(process.mainModule.filename):t._root),t._init=e._init,t._coreVersion=e.coreVersion,t._allowedToSendBusy=!0};Project.prototype=_.extend(Object.create(EventEmitter.prototype),{configure:function(){var e=this,t=this;return(process.env.quokka?Q.when(t._quokkaSettings):configure(t._configFile,t._instrumentedRoot,{forceUpdate:t._forceConfigUpdate})).then(function(i){if(t._settings=i,process.env.quokka)t._settings.extensions={};else{var n=process.version;if(process.env.WALLABY_ELECTRON_RUN_AS_NODE&&(n+=" - Electron"),debug("Wallaby Node version: %s",process.version),debug("Wallaby config: %s",t._configFile),t.runOnSave="onsave"===t._settings.runMode,t._settings.screenshot||(t._screenPath=void 0),t._testsPath){var r=void 0!==t._testsPath&&t._testsPath.length?e._validatePaths(t._testsPath):void 0;r&&r.length&&(t._settings.smartStart=t._settings.smartStart.filter(function(e){return"always"!==e.startMode}),r.forEach(function(e){t._settings.smartStart.unshift({test:!0,source:!1,path:e,startMode:"always"})}))}else delete t._settings.smartStart;if(t._testLocations&&t._updateSettingsTestLocations(),!t.isNativeBundler()){var o=i.postprocessor;_.isArray(i.postprocessor)?(o=i.postprocessor[0],i.postprocessor=t.isZeroConfigJest()?i.postprocessor[1]:t._combinePostprocessors(i.postprocessor)):t.isZeroConfigJest()&&delete i.postprocessor,t.isVitest()&&delete i.postprocessor,o&&o.ts&&o.filePatterns&&_.filter(o.filePatterns,function(e){return e&&!_.endsWith(e,"*.ts?(x)")&&!_.endsWith(e,"*.ts")}).length>0&&(t._overrideFileTypesIncludedInTypeScriptCompiler=!0,t._overrideFileType=function(e,i,n){if("ts"!==e&&"tsx"!==e&&t._overrideFileTypesIncludedInTypeScriptCompiler&&i!==n)return o.filePatterns&&_.find(o.filePatterns,function(e){return utils.pathMatchesPattern(0===i.indexOf("..")?path.basename(i):i,e,{dot:t._settings.dot,micromatch:t._settings.micromatch})})?"ts":void 0})}if(i.configCode=t._fileExistsSync(t._configFile)&&t._readFileSync(t._configFile)||"auto.detect","auto.detect"===i.configCode)try{i.configCode+="#"+utils.quickHash(JSON.stringify({files:i.files,tests:i.tests}))}catch(s){}}if(i.telemetry&&(t._tracker.start(i),t._testLocations?t._tracker.featureUsed("exclusive.run"):process.env.f4b4b415f5452454&&t._tracker.featureUsed("quokka.treasure")),i.env.phantomDefault)throw new Error("Your wallaby.js configuration is using a deprecated default `env.kind` setting of `phantomjs`.\nTo continue using PhantomJs you must configure this setting explicitly.\nPlease refer to our PhantomJs docs at https://wallabyjs.com/docs/integration/phantomjs2.html for more information.");var a=i.files.length;t._emit({type:"projectConfigured",name:i.name,browser:"browser"===i.env.type,kind:i.env.kind,phantomDefault:i.env.phantomDefault,screenshot:!!i.screenshot,editDelay:i.delays.edit,runOnSave:"onsave"===t._settings.runMode,files:_.map(i.files.concat(i.tests),function(e,t){return t>=a&&(e.test=!0),e})})})["catch"](function(e){t._cleanStack(e,t._fileExistsSync(t._configFile)&&t._configFile),console.error("Failed to load configuration file:",e&&(e.stack||e.message)),console.error("Please refer to our docs: https://wallabyjs.com/docs/config/overview.html"),t._emitTestRunError(e&&(e.stack||e.message))})},profilingSupportedByRunner:function(){return"node"===this._settings.env.type||"chrome"===this._settings.env.kind||void 0},updateTrackingClient:function(e){this._tracker.appendToTrackingClient(e)},reloadQuokkaSettings:function(){this._settings&&this._settings.quokka&&this._settings.quokka.reloadSettingsOnPackageInstall===!1||(this._loadQuokkaSettings((this._settings||{})._currentInlineQuokkaConfig),this._settings=this._quokkaSettings),this._recycleRunner=!0},_mergeQuokkaSettingsFromQuokkaSettingsFile:function(e,t){try{var i=this._readFileSync(t);try{var n=JSON.parse(i);try{_.merge(e,n)}catch(r){return"Error merging Quokka settings from: "+t+"."}}catch(r){return'Error parsing Quokka settings "'+t+'"; make sure that contents are valid JSON.\n\n'+r}}catch(r){}},_loadQuokkaSettings:function(e){var t=this;try{var i,n={globalConfigFile:this._quokkaGlobalSettingsFile,tempDir:this._quokkaTempDir,autoDetect:!0},r=this._mergeQuokkaSettingsFromQuokkaSettingsFile(n,this._quokkaGlobalSettingsFile);if(!r){try{i=JSON.parse(this._readFileSync(this._packageJson)),_.merge(n,i.quokka)}catch(o){i={}}r=this._mergeQuokkaSettingsFromQuokkaSettingsFile(n,this._quokkaLocalSettingsFile)}e&&_.merge(n,e),n.node&&(n.node=n.node.replace(/^~(?=$|\/|\\)/,process.env.HOME));var s=process.versions&&process.versions.pnp;if("module"===i.type&&n.stdEsm!==!0&&(n.stdEsm=!1,n.nativeEsm=!0),this._quokkaSettings={quokka:{globalSettingsDir:this._globalSettingsDir,globalSettingsFile:this._quokkaGlobalSettingsFile,edition:n.pro?"pro":"",installPackage:{command:n.installPackageCommand||(s?"yarn add {packageName}":"npm install {packageName}"),dir:n.tempDir,allowToInstallImportedModules:!0},ignoreExternalFileChanges:n.ignoreExternalFileChanges,autoLog:!!n.autoLog,showSingleInlineValue:n.showSingleInlineValue,reloadSettingsOnPackageInstall:n.reloadSettingsOnPackageInstall,allowDebuggerEditAndContinue:!0},files:[],tests:[{pattern:this._quokkaFileName,ignore:!1,instrument:!0,trigger:!0,load:!0}],env:{type:"node",runner:process.execPath,params:n.env&&n.env.params||{}},compilers:{},preprocessors:{},testFramework:{version:"quokka@1.0.0",configurator:"",reporter:"",starter:""},delays:{run:n.delay||0,edit:0},workers:{recycle:!!n.recycle,regular:1,initial:1},maxConsoleMessagesPerTest:1/0,autoConsoleLog:!0,debug:n.debug,reportConsoleErrorAsError:!0,telemetry:!0,hints:{ignoreCoverage:"ignore coverage"},dot:!0,unresponsiveStandardTimeout:n.unresponsiveStandardTimeout||500,logLimits:{inline:{depth:5,elements:5e3},values:{"default":{stringLength:200},autoExpand:{elements:5e3,stringLength:8192,depth:10}}}},r)return void(this._quokkaSettings.error=r);if("string"==typeof this._quokkaSettings.env.params.env&&_.each(this._quokkaSettings.env.params.env.split(";"),function(e){var t=e.split("="),i=t[0];process.env[i]=e.substring(i.length+1)}),n.builtInPlugins=[],n.autoDetect!==!1){var a=path.join(this._localRoot,"node_modules","react-scripts","scripts","utils","createJestConfig.js");try{a=require.resolve("react-scripts/scripts/utils/createJestConfig",{paths:[this._localRoot]})}catch(o){}this._fileExistsSync(a)&&(delete n.ts,n.builtInPlugins.push("auto-detect:create-react-app"),n.babel={ts:!0,presets:["react-app"]},n.plugins=n.plugins||[],i.scripts&&i.scripts.test&&i.scripts.test.indexOf("--env")===-1&&n.plugins.push("jsdom-quokka-plugin"))}var l=function(e){if(!e&&(n.stdEsm!==!1||n.nativeEsm!==!1)||e&&(n.stdEsm===!0||n.nativeEsm===!0)){if(n.stdEsm=n.stdEsm!==!1,n.nativeEsm){n.stdEsm=!1;var i;if(n.node)try{var r=cp.spawnSync(""+n.node,["-v"]);i=(r.stdout||"").toString()}catch(o){debug("An error occurred detecting runner nodejs version: %s",o)}else i=process.version;if(i)if(i=semver.clean(i),semver.gte(i,"12.0.0")){t._quokkaSettings.env.params.runner=t._quokkaSettings.env.params.runner?t._quokkaSettings.env.params.runner+" ":"",semver.gte(i,"14.3.0")&&semver.lt(i,"18.0.0")&&(t._quokkaSettings.env.params.runner+="--experimental-top-level-await ");var s=semver.gte(i,"16.12.0")?"hooks-v2.mjs":"hooks.mjs";t._quokkaSettings.env.params.runner+='--experimental-loader "'+url.pathToFileURL(path.join(path.dirname(process.mainModule.filename),"runners/node/"+t._quokkaSettings.testFramework.version+"/"+s))+'"'}else n.stdEsm=!0,n.nativeEsm=!1;else n.stdEsm=!0,n.nativeEsm=!1}n.stdEsm&&(t._quokkaSettings.env.params.runner=t._quokkaSettings.env.params.runner?t._quokkaSettings.env.params.runner+" ":"",t._quokkaSettings.env.params.runner+='-r "'+path.join(path.dirname(process.mainModule.filename),"node_modules/esm-wallaby")+'"',t._quokkaSettings.env.params.env+=";ESM_OPTIONS="+JSON.stringify({await:!0}))}t._quokkaSettings.quokka.nativeEsm=n.nativeEsm},c=function(e){var i=path.join(t._globalSettingsDir,"node_modules",e),n=path.join(t._localRoot,"node_modules",e);try{if(n=require.resolve(e,{paths:[t._localRoot]}))for(var r=n;path.dirname(r)!==r;){if(path.basename(r)===e){n=r;break}r=path.dirname(r)}}catch(o){}return t._globalSettingsDir!==t._localRoot&&t._fileExistsSync(n)?n:t._fileExistsSync(i)?i:path.join(path.dirname(process.mainModule.filename),"node_modules",e)},u=n.babel&&n.babel.ts===!0,h=_.endsWith(this._quokkaFileName,".ts")||_.endsWith(this._quokkaFileName,".tsx");if(h&&!u)delete n.babel,n.ts=n.ts||{},l(!0);else if(n.babel){delete n.babel.ts,delete n.ts,process.env.VUE_CLI_BABEL_TRANSPILE_MODULES=!0,_.isObject(n.babel)||(n.babel={}),process.env.BABEL_ENV||(process.env.BABEL_ENV=n.babel.env||"test");var d;try{var f=[path.join(this._localRoot,"node_modules","@babel/core"),path.join(this._localRoot,"node_modules","babel-core"),path.join(this._globalSettingsDir,"node_modules","@babel/core"),path.join(this._globalSettingsDir,"node_modules","babel-core")];try{var p=require.resolve("@babel/core",{paths:[this._localRoot]});f.unshift(p)}catch(o){}try{var g=require.resolve("babel-core",{paths:[this._localRoot]});f.unshift(g)}catch(o){}n.babel.path&&path.resolve(n.babel.path)&&f.unshift(path.resolve(n.babel.path));var v=_.find(f,function(e){return t._fileExistsSync(e)});if(!v)throw new Error("Babel core is not found");~v.indexOf("@babel")&&utils.patchBabelResolve(v),d=require(v),n.babel.path=v,u&&h&&(n.babel.tsconfigPaths={path:c("tsconfig-paths")}),n.babel.registerPath=c("@babel/register")}catch(o){return void(this._quokkaSettings.error="Configured to use babel, but can not find babel-core or @babel/core module\n"+o.message+"\n\nTried to search for babel core in these folders:\n"+_.map(f,function(e){return"  "+e}).join("\n"))}this._quokkaSettings.compilers[this._quokkaFileName]=require("./babelCompiler")(this._localRoot)(_.extend({babel:d,renameTypeScriptFiles:!1,asyncTransform:n.nativeEsm},_.omit(n.babel,"env","path","polyfill","ignore","tsconfigPaths","registerPath"))),n.babel.version=d.version,l(!0)}else l();if(n.ts){var y=path.join(this._instrumentedRoot,this._quokkaFileName).replace(/\.[^\/.]+$/,"");this._useMemoryFs(y+".js"),this._useMemoryFs(y+".jsx"),delete n.js,_.isObject(n.ts)||(n.ts={});var m,b=n.ts.compilerOptions||{},k=n.ts.path;if(k){k=path.resolve(k);try{m=require(k),n.ts.path=k}catch(o){return void(this._quokkaSettings.error='Configured to use "'+k+'" as TypeScript path, but can not find the `typescript` module')}}if(!m)try{k=path.join(this._localRoot,"node_modules","typescript");try{k=require.resolve("typescript",{paths:[this._localRoot]})}catch(o){}m=require(k)}catch(T){try{k=path.join(this._globalSettingsDir,"node_modules","typescript"),m=require(k)}catch(S){try{k=path.resolve(this._editorTypeScript),m=require(k)}catch(C){m=require("typescript"),k=path.join(path.dirname(process.mainModule.filename),"node_modules/typescript")}}}for(var L={},j=path.join(this._localRoot,this._quokkaFileName),w=!0;w&&j!==path.dirname(j);){j=path.dirname(j);var x=path.join(j,"tsconfig.json");if(this._fileExistsSync(x)){try{L=require("./typeScriptUtils").getCompilerOptions(m,x)}catch(o){throw new Error("Error while loading "+x+":\n"+o.message)}w=!1}j.length===this._originalLocalRoot.length&&(w=!1)}b=__assign(__assign({},L),b),b.module=n.nativeEsm?"esnext":"commonjs",b.jsx="react",b.noEmit=!1,b.noEmitOnError=!1,b.emitDeclarationOnly=!1,void 0===b.target&&(b.target="ES6"),delete b.removeComments,process.env.TS_NODE_COMPILER=k,process.env.TS_NODE_COMPILER_OPTIONS=JSON.stringify(__assign(__assign({jsx:"react"},n.ts.compilerOptions),{module:n.nativeEsm?"esnext":"commonjs"}));var F={typescript:m,files:{"**/*.ts?(x)":b}};this._quokkaSettings.postprocessor=require("./typeScriptPostprocessor")(this._localRoot)(F),n.ts.path=k,n.ts.version=m.version,n.ts.tsNode={path:c("ts-node")},b&&b.baseUrl&&(n.ts.tsconfigPaths={path:c("tsconfig-paths")}),n.ts.tsNode.path===path.join(path.dirname(process.mainModule.filename),"node_modules","ts-node")&&(process.env.TS_NODE_TRANSPILE_ONLY=!0)}else{var E=path.join(this._localRoot,this._quokkaFileName),R=!0,I=n.js&&n.js.compilerOptions||null;if(!I)for(;R&&E!==path.dirname(E);){E=path.dirname(E);var M=path.join(E,"jsconfig.json");if(this._fileExistsSync(M)){try{I=require("./typeScriptUtils").getCompilerOptions(require("typescript"),M)}catch(o){throw new Error("Error while loading "+M+":\n"+o.message)}R=!1}E.length===this._originalLocalRoot.length&&(R=!1)}I?n.js={compilerOptions:I,tsconfigPaths:{path:c("tsconfig-paths")}}:delete n.js}n.plugins&&n.plugins.length&&(n.plugins=_.uniq(n.plugins)),process.env.quokka=JSON.stringify(n)}catch(o){this._quokkaSettings=this._quokkaSettings||{},this._quokkaSettings.error=o.message}var O=process.version;process.env.WALLABY_ELECTRON_RUN_AS_NODE&&(O+=" - Electron"),this._emitInternal(_.extend({type:"configChanged",settings:this._quokkaSettings},n,{nodeVersion:O}))},_combinePostprocessors:function(e){var t=this;if(2!==e.length)throw new Error("Only TypeScript postprocessor chaining is supported.");var i=e[0],n=e[1];return function(e){return _.each(e.affectedFiles,function(e){var i=t._structure.filesById[e.id];i&&!t._isOriginallyVue(i)&&t._deleteDependantFilesMetadata(i)}),i(e).then(function(i){if(i.removePostprocessor)t._settings.postprocessor=n,debug("TypeScript postprocessor is removed as requested by itself"),t._overrideFileTypesIncludedInTypeScriptCompiler=!1;else{var r=function(e){var i=t._createPostProcessorInputFile(!1,e);return e.originalId&&(i.id=e.originalId,i.originalType=e.originalType),i},o=function(e){return e&&(_.isEmpty(e.dependant)&&(!e.tmp||e.originalId&&!t._isOriginallyVue(t._structure.filesById[e.originalId]))||t._isOriginallyVue(e))},s=function(e){var i=t._structure.filesById[e.id];return!i||_.isEmpty(i.dependant)||t._isOriginallyVue(i)?i:_.values(i.dependant)[0]};t._updateFileOrder();var a=_.chain(t._structure.testFilesInOrder).filter(o).map(r).value(),l=_.chain(t._structure.sourceFilesInOrder).filter(o).map(r).value().concat(a),c=_.chain(e.affectedFiles).map(s).filter(o).map(r).value(),u=_.chain(e.affectedTestFiles).map(s).filter(o).map(r).value();e=_.extend(e,{allTestFiles:a,allFiles:l,affectedFiles:c,affectedTestFiles:u})}return n(e)})}},configFilePath:function(){return this._configFile},coreVersion:function(){return this._coreVersion},projectName:function(){return this._settings.name||path.basename(this._localRoot)},preloadStructure:function(){var e=this;return this._fileStructureCachePromise(path.join(this._root,this._structureFile)).then(function(t){return e._preloadedStructure=t,t})["catch"](function(){return{}})},start:function(e){var t=this,i=t._init(e,t);return t._emitInternal({type:"starting",files:e.files}),i.then(function(){return t._live&&t.stop(),Q.when(!0)}).then(function(){return debug("File cache: %s",t._root),t._live=!1,Q.all([t._dirEnsurePromise(t._originalRoot),t._dirEnsurePromise(t._instrumentedRoot)])})["catch"](function(e){return t._cleanStack(e),t._emitTestRunError(e.stack||e.message),Q.reject({error:e})}).then(function(){return this._preloadedStructure||t._fileStructureCachePromise(path.join(t._root,t._structureFile))})["catch"](function(e){return e&&e.error?Q.reject(e.error):Q.when({})}).then(function(e){var i=function(){return t._dirRemovePromise(t._instrumentedRoot).then(function(){return t._dirEnsurePromise(t._instrumentedRoot)})};return Q.all([t._fileStatPromise(t._packageJson).then(function(e){return Q.when(e.mtime.getTime())})["catch"](function(){return Q.when(0)}),t._fileStatPromise(t._babelrc).then(function(e){return Q.when(e.mtime.getTime())})["catch"](function(){return Q.when(0)}),t._fileStatPromise(t._babelrcjs).then(function(e){return Q.when(e.mtime.getTime())})["catch"](function(){return Q.when(0)})]).then(function(n){var r=n[0],o=n[1],s=n[2];return e.invalidateCache?(debug("Invalidating local cache as requested"),delete e.timestamp,i().then(function(){return Q.when({packageJsonTimestamp:r,babelrcTimestamp:o,babelrcJsTimestamp:s})})):r!==e.packageJsonTimestamp?(debug("package.json file change detected, invalidating local cache"),delete e.timestamp,i().then(function(){return Q.when({packageJsonTimestamp:r,babelrcTimestamp:o,babelrcJsTimestamp:s})})):o!==e.babelrcTimestamp?(debug(".babelrc file change detected, invalidating local cache"),delete e.timestamp,i().then(function(){return Q.when({packageJsonTimestamp:r,babelrcTimestamp:o,babelrcJsTimestamp:s})})):s!==e.babelrcJsTimestamp?(debug(".babelrc.js file change detected, invalidating local cache"),delete e.timestamp,i().then(function(){return Q.when({packageJsonTimestamp:r,babelrcTimestamp:o,babelrcJsTimestamp:s})})):e.configCode!==t._settings.configCode||t._structureFileFormatVersion!==e.version?(debug("Config file change detected, invalidating local cache"),
delete e.timestamp,i().then(function(){return Q.when({packageJsonTimestamp:r,babelrcTimestamp:o,babelrcJsTimestamp:s})})):(e.packageJsonTimestamp=r,e.babelrcTimestamp=o,e.babelrcJsTimestamp=s,Q.when(e))})}).then(function(i){i.timestamp||(i.timestamp=Date.now()),t._structure=_.extend({filesByPath:{},filesRenamed:{},filesById:{},testFilesById:{},testFileSelectionById:{included:{},excluded:{}},awaitingFiles:[],configCode:t._settings.configCode},i),t._structure.awaitingFiles=[],t._structure.sourceFilesInOrder=[],t._structure.testFilesInOrder=[],t._structure.notifiedAboutWallabyApp||(process.env.quokka||console.log("Wallaby App (realtime reports) is available at: http://localhost:51245"),t._structure.notifiedAboutWallabyApp=!0);var n=_.reduce(e.files,function(e,t){return e[t.path]=!0,e},{});_.each(t._structure.filesByPath,function(e){if(!n[e.path]){var i=t._deleteFileMetadata(e);i&&((t.isZeroConfigJest()||t.isVitest()||t.isNativeBundler())&&!i.inOriginalFilesCache||t._unlinkFilePromise(i.originalPath),t.isZeroConfigJest()||t.isVitest()||t.isNativeBundler()||t._unlinkFilePromise(i.instrumentedPath))}});var r=[],o=!!process.env.quokka,s=[];_.each(e.files,function(e){var i=e.path,n=0===i.indexOf("..")?path.basename(e.path):e.path;if(e.test||_.find(t._settings.tests,function(e){return e.ignore&&utils.pathMatchesPattern(n,e.regexp||e.pattern,!e.regexp&&{dot:t._settings.dot,micromatch:t._settings.micromatch})}))o=!0;else{var a=_.find(t._settings.tests,function(e){return!e.ignore&&utils.pathMatchesPattern(n,e.regexp||e.pattern,!e.regexp&&{dot:t._settings.dot,micromatch:t._settings.micromatch})});a&&console.error("File/pattern "+e.path+" is specified in the files list but also found in the tests list: "+a.pattern+".\r\n\tIf it's a test, make sure to exclude it from the files list, for example by adding { pattern: '"+a.pattern+"', ignore: true } to the files list.\r\n\tIf it's not a test, remove it from the tests list.")}var l=t._structure.filesByPath[i],c=l&&l.id===e.id,u=!1;if(l?(l.includedExplicitlyTestFile=e.includedExplicitlyTestFile,l.smartModeStart=e.smartModeStart,l=t._createFileMetadata(l,e.id),e.order&&(l.order=e.order),l.ts!==e.ts&&(t._settings.extractComments&&e.coverable||!t.isZeroConfigJest()&&!t.isVitest()&&!t.isNativeBundler())&&(t._structure.awaitingFiles.push(e.id),u=!0)):(l=t._createFileMetadata(e,e.id),(t._settings.extractComments&&e.coverable||!t.isNativeBundler()&&(!t.isZeroConfigJest()&&!t.isVitest()||l.test))&&(t._structure.awaitingFiles.push(e.id),u=!0)),l.includedExplicitlyTestFile&&s.push(l.path),(t.isZeroConfigJest()||t.isVitest())&&(l.validSyntax=!0,c?e.ts!==l.ts&&(!u&&l.test&&(t._structure.awaitingFiles.push(e.id),u=!0),l.changeTs=+new Date):l.changeTs=+new Date),t.isNativeBundler()&&(l.validSyntax=!0,e.ts!==l.ts&&(l.changeTs=+new Date)),!u&&!t.isNativeBundler()&&(!t.isZeroConfigJest()&&!t.isVitest()||l.test)){var h=function(e,t){return e?t?e.toString("base64"):e.toString():""};r.push(t._fileStatPromise(l.originalPath)["catch"](function(){return trace("No cached file %s, requesting it",e.path),t._structure.awaitingFiles.push(e.id),Q.when(!1)}).then(function(i){return i===!1?Q.when(!1):(l.inOriginalFilesCache=!0,t.isZeroConfigJest()||t.isVitest()?Q.when(!1):c?t._readFilePromise(l.instrumentedPath)["catch"](function(){return trace("No instrumented file %s, re-instrumenting original file",e.path),t._readFilePromise(l.originalPath).then(function(e){return t._processFile(l,h(e,l.binary),void 0,!0,!1)})}):t._readFilePromise(l.originalPath).then(function(i){return trace("Re-instrumenting original file %s because its ID has changed",e.path),t._processFile(l,h(i,l.binary),void 0,!0,!1)}))}))}}),t._settings.smartStart&&(t._exclusiveTestRun=!0,s.length?t.setTestLocations(s):(t._tracker.featureUsed("smartStart"),t._testLocations=new Set,t._updateSettingsTestLocations())),o||console.error("No files with tests found, check your tests list patterns."),t._fileOrderUpdatePending=!0;var a=t._runnerResolver(t._settings.env.type,t._settings.env.kind);return t._testRunner=new a(t),Q.all(r.concat([t._testRunner.start()]))})["catch"](function(e){return t._signalIfBecameLive(),t._emitTestRunError(e.message),t._cleanStack(e),Q.reject(e)}).then(function(){t._signalIfBecameLive()?(debug("File cache is up-to-date, starting full test run"),t._queueTestRunFromFileChanges(null,!0),t._scheduleTestRun()):(debug("File cache requires some updates, waiting required files from IDE"),t._emit({type:"filesRequired",files:t._structure.awaitingFiles}))})},file:function(e){var t=this,i=function(e){e.isTransientChange?t._hasPendingTransientFileChangesOnly!==!1&&(t._hasPendingTransientFileChangesOnly=!0):t._hasPendingTransientFileChangesOnly=!1};if(e.tsOnlyChange){if(i(e),t._fileChangesInProcess){if(e.file&&e.file.id){var n=t._changeQueue[e.file.id];if(n&&n.length){var r=n[n.length-1];r.file.ts=e.file.ts,r.fileSystemMatchesContent=!0}}}else{var o=t._structure.filesByPath[e.file.path];o&&(o.ts=e.file.ts)}return void t._emit({type:"testRunReQueued",tsOnlyChange:!0})}return e.inEditor||(e.fileSystemMatchesContent=!0),t._emitInternal({type:"file",file:e.file,"delete":e["delete"],inEditor:e.inEditor,logMarkers:e.logMarkers,extractedComments:e.extractedComments,isTransientChange:e.isTransientChange}),process.env.quokka&&!e.inEditor?void(t._structure&&t._filesAreUpToDate([e.file.id])):((e.inEditor||process.env.WALLABY_INTEGRATION_TEST_RUN)&&(this._hasAnyPendingInEditorFileChanges=!0),i(e),Q.promise(function(i,n){try{t._isTestTriggeringFileChange(e)&&t._tryCancelActiveTestRun(runPriority.fileChangePriority),t._queueFileChange(e),t.runOnSave&&e.inEditor&&!e.isTransientChange?(debug("File changed in editor and set to only run on save, will not schedule test run"),t._emitInternal({type:"fileMarkersInvalid"})):t._scheduleChangedQueueProcessing(),i()}catch(r){n(r)}}))},scheduleChangeQueueProcessingIfPendingChanges:function(){this.hasAnyPendingInEditorFileChanges()&&this._scheduleChangedQueueProcessing()},hasAnyPendingInEditorFileChanges:function(){return this._hasAnyPendingInEditorFileChanges},runTests:function(e){this.runOnSave&&this.scheduleChangeQueueProcessingIfPendingChanges();var t=this,i=t.settings().quokka;if(i&&e.externalFileChange&&!t._expressionsToEvaluateReceived){if(i.ignoreExternalFileChanges)return;if(t._testRunInProgress)return;if(t._lastRunFinishTime&&+new Date-t._lastRunFinishTime<(i.externalFileChangeTimeout||1e3))return}if(delete t._expressionsToEvaluateReceived,t._tryCancelActiveTestRun(e.notManualRun?runPriority.fileChangePriority:runPriority.testRunPriority),e.tests)t._queueRequestedTestRun(e.tests),debug("Requested to run some tests");else if(e.catchup){if(!this._catchupTestTask)throw new Error("Invalid run tests request");if(debug("Debugger stopped"),!this.runOnSave){if(!this._catchupTestTask.hasAnyFiles()&&!this._catchupTestTask.isFullRun())return void delete this._catchupTestTask;t._testTask=this._catchupTestTask}}else t._queueFullTestRun(!0),debug("Requested to run all tests");e.notManualRun&&(debug("Editor requested test run"),t._testTask.setEditorRequestedRun()),e.evaluateExpression&&(debug("Evaluated expression test run"),t._testTask.setEvaluatedExpressionRun()),e.initialTraceRun&&(debug("Debugger start test run"),t._tracker.featureUsed("debug.start"),t._testTask.setInitialTraceRun(e.initialTraceRun)),e.codeClipSharingRun&&(debug("Code Clip sharing test run"),t._testTask.setCodeClipSharingRun(e.codeClipSharingRun)),e.profileRun&&(debug("Profiler start test run"),t._tracker.featureUsed("profile.start"),t._testTask.setProfileRun(e.profileRun)),e.updateSnapshots&&(debug("Snapshots update test run"),t._tracker.featureUsed("updateSnapshots"),t._testTask.setUpdateSnapshotsRun()),t._scheduleTestRun()},screen:function(e){var t=this;return t._settings&&"browser"===t._settings.env.type?t._testRunner._screenShotReady.then(function(){return t._readFilePromise(t._screenPath)})["catch"](function(){return trace("Unable to load test run screen shot"),Q.when(!1)}).then(function(i){i&&t._emit({type:"screen",screen:Buffer.from(i).toString("base64")},e)}):Q.when(!1)},expressionsToEvaluate:function(e){this._emitInternal({type:"expressionsToEvaluateReceived",expressionsToEvaluate:e.expressionsToEvaluate}),this._expressionsToEvaluate=e.expressionsToEvaluate,this._expressionsToEvaluateReceived=!0},traceContext:function(e){this._traceContext=e,e||delete this._catchupTestTask},stop:function(e,t){var i=this;if(i._live=!1,i._tracker.dispose(),clearTimeout(i._emitBusyTimeout),i._quokkaTempDir)try{i._dirRemoveSync(i._quokkaTempDir)}catch(n){}debug("Stopping wallaby.js");try{i._unlinkFileSync(path.join(i._root,i._structureFile))}catch(n){}if(debug("Killing %s spawned process(es)",_.keys(spawnedProcesses).length),_.each(spawnedProcesses,function(e){try{e.kill()}catch(t){}}),i._multicaster&&i._multicaster.stop(),i._wallabyAppChecker&&i._wallabyAppChecker.stop(),!e&&i._flushSourceFileCacheSync(),i._uiService&&i._uiService.stop(),debug("Stopping test runner"),i._testRunner&&i._testRunner.stop(),i._profileViewer&&i._profileViewer.stop(),!e&&i._structure){var r={version:i._structureFileFormatVersion,timestamp:i._structure.timestamp,filesByPath:i._structure.filesByPath,configCode:i._structure.configCode,packageJsonTimestamp:i._structure.packageJsonTimestamp,babelrcTimestamp:i._structure.babelrcTimestamp,babelrcJsTimestamp:i._structure.babelrcJsTimestamp,invalidateCache:i._invalidateCache,notifiedAboutWallabyApp:i._structure.notifiedAboutWallabyApp};_.each(r.filesByPath,function(e,n){delete e.changeTs,delete e.changeStart,delete e.changePosition,delete e.logMarkers,delete e.numberOfFunctionsChanged,delete e.lastChangeIsComplex,delete e.relatedFilesWithTests,delete e.lastSingleChangeTest,delete e.dependant,delete e.parentFilePath,delete e.inOriginalFilesCache,delete e.tmpLineMap,delete e.compiledTmpLineMap,delete e.noCompilers,delete e.noPreprocessors,delete e.sourceMap,delete e.testFilesLoadedFrom,delete e.tests,delete e.notInstrumentedLogMarkers,delete e.liveCommentLines,i._settings.extractComments||delete e.extractedComments,delete e.lastInstrumentedChangeId,delete e.lastSaveChangeId,t&&t[e.id]&&(e.ts=-1),e.tmp&&(delete r.filesByPath[n],e.notStored||i._unlinkFileSync(e.instrumentedPath))});var o=JSON.stringify(r);debug("Saving file structure"),i._writeFileSync(path.join(i._root,i._structureFile),o)}},idByPath:function(e){var t=this._structure.filesByPath[e];if(t)return t.id},invalidateCache:function(){this._invalidateCache=!0},settings:function(){return this._settings},setTestLocations:function(e){if(e=this._validatePaths(e),e.length)this._testLocations=new Set(e);else{if(!this._testLocations)return;delete this._testLocations}this._updateSettingsTestLocations(),this._updateIncludedExplicitlyTestFiles()},addTestLocations:function(e){var t,i;if(e=this._validatePaths(e),e.length){if(this._testLocations&&0!==this._testLocations.size)try{for(var n=__values(e),r=n.next();!r.done;r=n.next()){var o=r.value;this._testLocations.add(o)}}catch(s){t={error:s}}finally{try{r&&!r.done&&(i=n["return"])&&i.call(n)}finally{if(t)throw t.error}}else this._testLocations=new Set(e);this._updateSettingsTestLocations(),this._updateIncludedExplicitlyTestFiles()}},removeTestLocations:function(e){var t,i;if(e=this._validatePaths(e),e.length&&this._testLocations){try{for(var n=__values(e),r=n.next();!r.done;r=n.next()){var o=r.value;if(this._testLocations["delete"](o),0===this._testLocations.size){delete this._testLocations;break}}}catch(s){t={error:s}}finally{try{r&&!r.done&&(i=n["return"])&&i.call(n)}finally{if(t)throw t.error}}this._updateSettingsTestLocations(),this._updateIncludedExplicitlyTestFiles()}},hasTestLocation:function(e){return this._testLocations&&this._testLocations.has(e)},setLogsSuppressions:function(e){this._logsSuppressions=e},_validatePaths:function(e){return e?e.filter(function(e){return e.indexOf("../")===-1}):[]},_updateSettingsTestLocations:function(){var e,t;if(this._settings.runSelectedTestsOnly=!!this._testLocations,this._testLocations){this._settings.testLocations=[];try{for(var i=__values(this._testLocations),n=i.next();!n.done;n=i.next()){var r=n.value;this._settings.testLocations.push(r)}}catch(o){e={error:o}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}}else delete this._settings.testLocations},_updateIncludedExplicitlyTestFiles:function(){var e,t,i=this._structure.testFilesById;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];if(this._testLocations){var o=!1;try{for(var s=(e=void 0,__values(this._testLocations)),a=s.next();!a.done;a=s.next()){var l=a.value;if(""===l||r.path.startsWith(l)){o=!0;break}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=s["return"])&&t.call(s)}finally{if(e)throw e.error}}o?r.includedExplicitlyTestFile=!0:delete r.includedExplicitlyTestFile}else delete r.includedExplicitlyTestFile;this._updateFileStructure(r)}},_cleanStack:function(e,t){if(e){var i,n=process.mainModule&&path.dirname(process.mainModule.filename)||"";if(e.stack&&_.isString(e.stack)){i=e.stack.toString(),e.message&&!~i.indexOf(e.message)&&(i=e.message+"\n"+i),0===i.indexOf("Error: ")&&(i=i.substr(7));var r=!1;i=this._cleanMessage(_.filter(i.split("\n"),function(e,i){if(r||(r=_.contains(e,"quokkaStackTraceMarker")),!r&&!_.contains(e,"From previous event:"))return!i||!/(\s+at|^at)\s+/.test(e)||(!t&&!_.contains(e,n)||t&&_.contains(e,t))}).join("\n")),n&&(i=i.split(n).join("[wallaby core]"))}else i="";if(!_.isUndefined(i)){e.stack=i;try{Object.defineProperty(e,"stack",{value:i})}catch(o){}}return e}},_cleanMessage:function(e,t){return this._settings&&this._settings.preservePaths?e:e&&_.isString(e)?t?e.split(t).join("."):e.split(this._instrumentedRoot).join(".").split(this._localRoot).join("."):e},_startProcessorPool:function(){var e=this;trace("Starting processor pool (if not yet started)"),e._processorPool.start(process.mainModule.filename)},_tryCancelActiveTestRun:function(e){var t=this;process.env.quokka&&(e=runPriority.fileChangePriority),t._runCancelRequester=e;var i=t._testRunner&&t._testRunner.cancel(e);i?debug("Test run was cancelled"):i===!1&&debug("Test run is not cancelled because cancel requester does not have enough priority to cancel the run")},_originalLineByFileId:function(e,t,i){var n=this,r=n._structure.filesById[e];return r&&r.getFileLineMap()?utils.getOriginalLineByGeneratedLine(r.getFileLineMap(),t,i):t},_originalLineByFilePath:function(e,t,i){var n=this,r=n._structure.filesByPath[e];return r&&r.getFileLineMap()?utils.getOriginalLineByGeneratedLine(r.getFileLineMap(),t,i):t},stackEntryByFileId:function(e,t,i){var n=this;if(e===bundleFileId){var r=n._structure.filesById[bundleFileId];if(!r)return;var o=r.fileAndLineByLine(t);if(!o||!_.isNumber(o[0])||!n._structure.filesById[o[0]])return;e=o[0],t=o[1]}var s={file:e};return s.line=n._originalLineByFileId(s.file,t,i),s},stackEntryByFilePath:function(e,t,i){var n=this,r=n._structure.filesByPath[e]||n._structure.filesByPath[n._structure.filesRenamed[e]||""];if(r&&(!r.tmp||(r=n._structure.filesById[r.originalId]))&&(!r.childFilePath||(r=n.getFileMetadataByPath(r.childFilePath)))&&(!r||!r.hideFromErrorStackTrace)){e=r.path;var o={file:r.id};return o.line=n._originalLineByFilePath(e,t,i),o}},stackEntryByFileIdWithoutLineMapping:function(e,t){var i=this._structure.filesById[e];if(i)return{file:i.path,loc:""+t,line:t}},copyToClipboard:function(e){if("string"==typeof e.data)utils.copyToClipboard(e.data),this._emit({type:"copyToClipboard",data:e.data});else{var t=this._buildObject(e.data),i=require("util"),n=i.formatWithOptions?i.formatWithOptions({depth:null},t):i.format(t);utils.copyToClipboard(n),this._emit({type:"copyToClipboard",data:n})}},_buildObject:function(e){var t,i=this,n=e.type.toLowerCase();switch(n){case"date":return new Date(e.value).toJSON();case"regexp":return new RegExp(e.value.replace(/^\//,"").replace(/\/$/,""));case"symbol":case"boolean":case"string":case"number":return e.capped?e.capped+"...":e.nan?NaN:e.positiveInfinity?1/0:e.negativeInfinity?-(1/0):e.value;case"null":return null;case"undefined":return;case"array":t=[];break;default:t={}}return _.each(e.props,function(e){return i._handleProperty(e,t)}),t},_handleProperty:function(e,t){var i=this;if(e.rangeNode||e.functionsNode)return _.each(e.props,function(e){return i._handleProperty(e,t)});if(!e.getter&&e.type&&"function"!==e.type&&"symbol"!==e.type&&!e.symbol){var n=e.name.startsWith("'")&&e.name.endsWith("'")?e.name.substr(1,e.name.length-2).replace(/\\'/g,"'"):e.name;t[n]=this._buildObject(e)}},isNotificationMuted:function(e){try{return!!JSON.parse(this._readFileSync(this._notificationSettingsFile))[e]}catch(t){console.warn("Unable to read notification settings file: "+(t&&t.message))}},muteNotification:function(e){try{var t=JSON.parse(this._readFileSync(this._notificationSettingsFile));t[e]={},this._writeFileSync(this._notificationSettingsFile,JSON.stringify(t))}catch(i){console.warn("Unable to read/write notification settings file: "+(i&&i.message))}},_emit:function(e,t){t&&t.id&&(e.id=t.id),this.emit("message",e)},_emitInternal:function(e,t){e._internal=!0,this._emit(e,t)},_isJavaScript:function(e){var t=this;return this._isOriginallyJavaScript(e)||utils.isJavaScript(e.instrumentedType,this._settings&&this._settings.extensions&&this._settings.extensions.javascript)||_.find(e.dependant,function(e){return t._isJavaScript(e)})||e.instrumentedByTestingFramework},_isOriginallyJavaScript:function(e){return utils.isJavaScript(e.type,this._settings&&this._settings.extensions&&this._settings.extensions.javascript)},_isOriginallyVue:function(e){return e&&utils.isVue(e.type)},_isOriginallyCoffeeScript:function(e){return utils.isCoffeeScript(e.type,e.originalPath)},_isOriginallyTypeScript:function(e){return utils.isTypeScript(e.type)},_isOriginallySvelte:function(e){return e&&utils.isSvelte(e.type)},_runTests:function(e){var t=this;this._traceContext&&this._traceContext.test?(e.setRegularTraceRunTest(this._traceContext.test),this._catchupTestTask.mergeTask(e)):e.isInitialTraceRun()?this._catchupTestTask=new TestTask(this):delete this._catchupTestTask,t._updateFileOrder();var i=e.isFullRun(),n=e.isManualRun(),r=e.isUpdateSnapshotsRun(),o=e.isFileChangedRun(),s=e.files(),a=e.testData(),l=this._expressionsToEvaluate,c=a&&a.files,u=a&&a.names,h=e.getPriority(),d=this._hasPendingTransientFileChangesOnly;if(o&&(delete this._hasAnyPendingInEditorFileChanges,delete this._hasPendingTransientFileChangesOnly),i&&debug("Running all tests"),o&&c&&_.isEmpty(c)&&!_.find(s,function(e){return t._isJavaScript(e)}))return Q.when({queueAgain:!0});var f=t._structure.sourceFilesInOrder,p=c?t._orderFilesByConfig(t._expandDependantFiles(c)):t._structure.testFilesInOrder,g=_.find(f.concat(p),function(e){return t._isJavaScript(e)&&!e.validSyntax&&e.coverable});if(g)return Q.when({queueAgain:!0,file:g.path});var v=t._selectRunnerFiles(p),y=t._selectRunnerFiles(f);if(!v.length&&s){var m=_.map(s,function(e){return e.id});if(_.isEqual(m,t._lastChangedFileIds)||(t._lastChangedFileIds=m),t._settings.loose||t.hasSomeSelectedTestFiles())return console.log("Can't determine tests to run for the change."),Q.when({queueAgain:!0});console.log("Can't determine tests to run for the change, re-running all tests.\nTo prevent the full test run when can not determine tests to run, use `loose: true` configuration option."),v=t._selectRunnerFiles(t._structure.testFilesInOrder),u=void 0,i=!0,h=e.getFullRunPriority(),debug("Test task priority upgraded to full run")}else delete t._lastChangedFileIds;var b;process.env.quokka&&t._recycleRunner&&(delete t._recycleRunner,b=!0);var k=e.isInitialTraceRun()&&e.initialTraceRunData(),T=this.selectedTestFiles();if(this._settings.smartStart&&!T.hasSomeIncludedTestFiles&&!k)return Q.when({queueAgain:!0});this.settings().runSelectedTestsOnly&&!T.hasSomeIncludedTestFiles&&(y.length=0,v.length=0);var S=e.isInitialTraceRun()||e.isRegularTraceRun(),C=e.profileRunData();return t._emitInternal({type:"runningTests",hasPendingTransientFileChangesOnly:d,changeRun:o,fullRun:i,recordTrace:S,userRequestedInitialTraceRun:k,tests:e.tests(),codeClipSharingRun:e.isCodeClipSharingRun()&&e.codeClipSharingRunData()}),t._testRunner.run({framework:t._settings.testFramework,fullRun:i,screen:t._screenPath,filesToLoad:_.filter(y,function(e){return e.include}),allFiles:y,testFilesToLoad:_.filter(v,function(e){return e.include}),allTestFiles:v,tests:u,logsSuppressions:this._logsSuppressions,priority:h,manualRun:n,updateSnapshotsRun:r,profileRun:!!C||void 0,recycleBeforeRun:b,expressionsToEvaluate:l,traceContext:S&&(this._traceContext||{})}).then(function(e){return e.globalErrors&&e.globalErrors.length||_.each(s,function(e){delete e.testFilesLoadedFrom}),e.testFiles=_.filter(v,function(e){return!e.tmp}),e.profileRunData=C,Q.when(e)})},_expandDependantFiles:function(e){return _.each(e,function(t){_.extend(e,t.dependant||{})}),e},_fullInstrumentedPathForTestRunner:function(e){return e.instrumentedPath},_fullLocalPathForTestRunner:function(e){return path.join(this._localRoot,e.path)},_selectRunnerFiles:function(e){var t=this;return _.map(e,function(e){var i=path.relative(t._instrumentedRoot,e.instrumentedPath);return{path:t.isZeroConfigJest()||t.isVitest()?t._fullLocalPathForTestRunner(e):t._fullInstrumentedPathForTestRunner(e),relativePath:i,normalizedRelativePath:t.normalizePath(i),ts:e.changeTs,runnerCacheKey:e.runnerCacheKey,id:e.id,tmp:e.tmp,test:e.test,instrument:e.coverable,changeStart:e.changeStart,changePosition:e.changePosition,logMarkers:e.logMarkers,extractedComments:e.extractedComments,relatedFilesWithTests:e.relatedFilesWithTests,parentFilePath:e.parentFilePath,numberOfFunctions:e.numberOfFunctions,childFilePath:e.childFilePath,inOriginalFilesCache:e.inOriginalFilesCache,originalId:e.originalId,originalType:e.originalType||e.type,include:e.include,esm:e.esm,type:e.instrumentedType||e.type,rangesLength:e.ranges&&e.ranges.length||0,shadowed:!_.isEmpty(e.dependant),content:process.env.quokka?t._getInstrumentedFileContent(e):void 0}})},_queueFileChange:function(e){var t=this;if(!e.file)throw new Error("File is missing");var i=e.file.id;if(!i)throw new Error("File id is missing");var n=t._changeQueue[i]=t._changeQueue[i]||[];n.push(e),t._changeQueue.containsTestTriggeringFileChanges=t._changeQueue.containsTestTriggeringFileChanges||t._isTestTriggeringFileChange(e)},_emitBusy:function(e){var t=this;e&&(this._allowedToSendBusy=!0),this._allowedToSendBusy&&(this._emit({type:"busy"}),this._tracker.busy(),this._allowedToSendBusy=!1,this._emitBusyTimeout=setTimeout(function(){t._allowedToSendBusy=!0,clearTimeout(t._emitBusyTimeout)},100))},_scheduleChangedQueueProcessing:function(e){var t=this;e=e||t._settings.delays.update,t._emitBusy(!0),t._changedQueueTimeout&&clearTimeout(t._changedQueueTimeout),t._changedQueueTimeout=setTimeout(function(){if(t._fileChangesInProcess||t._testRunInProgress||!t._structure)return void t._scheduleChangedQueueProcessing(Math.max(e,50));t._emitBusy(),delete t._changedQueueTimeout,t._fileChangesInProcess=!0;var i=!t._live;t._processChangedQueue().then(function(e){t._fileChangesInProcess=!1;var n=i&&t._live;e.length&&(n||_.find(e,function(e){return t._isTestTriggeringFileChange(e)}))?(t._queueTestRunFromFileChanges(e,n),!t._testTriggeringPendingChanges()&&t._live&&t._scheduleTestRun()):(debug("Changes did not trigger any tests"),t._emit({type:"testRunReQueued"}))})["catch"](function(e){debug("Test queueing failure: "+e&&(e.stack||e.message)),t._cleanStack(e),t._emitTestRunError(e&&e.message)})},e)},_isTestTriggeringFileChange:function(e){var t="snap"===e.file.type&&!e.inEditor;return e.file.triggersTests&&!t},_testTriggeringPendingChanges:function(){return!_.isEmpty(this._changeQueue)&&this._changeQueue.containsTestTriggeringFileChanges},_queueTestRunFromFileChanges:function(e,t){var i=this;if(t)i._queueFullTestRun();else if(!i._testTask.isFullRun()){i._testTask.setFileChangeRunPriority(),i._traceContext&&i._traceContext.test&&i._testTask.setRegularTraceRunTest(i._traceContext.test);var n=!1,r=!1;_.each(e,function(e){n=n||e.added,r=r||e.deleted;var t=e.file;e.deleted?i._testTask.addTests(e.tests):i._testTask.addChangedFile(t,e.tests)}),n&&i._testTask.filesAdded(),r&&i._testTask.filesDeleted()}},_queueRequestedTestRun:function(e){var t=this;t._testTask.addTests(e),t._testTask.setTestRunPriority()},_queueFullTestRun:function(e){var t=this;t._testTask=new TestTask(t),t._testTask.setFullRunPriority(),e&&t._testTask.setManuallyRequestedRun()},_scheduleTestRun:function(e){var t=this;t._emitBusy(!0),void 0===e&&(!t._firstScheduleTestRunComplete&&process.env.quokka?(t._firstScheduleTestRunComplete=!0,e=0):e=t._settings.delays.run),t._testTask&&process.env.quokka&&t._testTask.setFileChangeRunPriority(),t._testRunTimeout&&clearTimeout(t._testRunTimeout),t._testRunTimeout=setTimeout(function(){if(t._fileChangesInProcess||t._testRunInProgress||!t._live)return void t._scheduleTestRun(Math.max(e,t._firstScheduleTestRunComplete?e:50));t._emitBusy(),t._emitTestRunStarted(),delete t._testRunTimeout,delete t._runCancelRequester,t._testRunInProgress=!0;var i=t._testTask;t._testTask=new TestTask(t),i&&i.anyFilesAdded()&&t._removedPostprocessor&&!t._settings.postprocessor&&_.find(i.files(),function(e){return t._isOriginallyTypeScript(e)})&&(debug("TypeScript file has been added, re-activating TypeScript postprocessor"),t._settings.postprocessor=t._removedPostprocessor,t._overrideFileTypesIncludedInTypeScriptCompiler=!0,delete t._removedPostprocessor);var n={},r=[];(t._settings.postprocessor?Q.promise(function(e,n){try{if((i.isManualRun()||i.isEditorRequestedRun())&&!i.isFullRun())return void e();debug("Running postprocessor");var o=i.testData(),s=t._settings.env.bundle&&(i.anyFilesAdded()||i.anyFilesDeleted()),a=t._createPostProcessorArgument({timestamp:t._structure.timestamp,"native":t.isNativeBundler(),bundleAllowed:s,affectedFiles:_.values(i.files()),affectedTestFiles:o&&o.files,anyFilesAdded:i.anyFilesAdded(),anyFilesDeleted:i.anyFilesDeleted(),logger:{error:function(e){var i={stack:e};t._cleanStack(i),r.push({message:i.stack})}},dot:t.settings().dot});!a.anyFilesAdded&&!a.anyFilesDeleted||t._settings.postprocessor.ts||t._deleteTmpFiles(),e(t._settings.postprocessor(a).then(function(e){return i.filesNotAdded(),i.filesNotDeleted(),s&&a.bundle.length?t._buildBundle(a.bundle).then(function(){return e}):e})["catch"](function(e){return Q.reject(e)}))}catch(l){n(l)}})["catch"](function(e){return t._runCancelRequester>=i.getPriority()?Q.reject({runCancelled:!0}):(debug("Postprocessor run failure: "+e&&(e.stack||e.message)),e.postprocessor=!0,Q.reject(e))}).then(function(e){return t._runCancelRequester>=i.getPriority()?Q.reject({runCancelled:!0}):(e&&(debug("Postprocessor execution finished"),e.removePostprocessor&&(debug("Postprocessor is removed as requested by itself"),t._removedPostprocessor=t._settings.postprocessor,t._removedPostprocessor&&t._removedPostprocessor.ts&&(t._overrideFileTypesIncludedInTypeScriptCompiler=!1),delete t._settings.postprocessor),_.isEmpty(e.testDependencies)||(n=e.testDependencies)),Q.when(!0))}):Q.when(!0)).then(function(){return t._testSelectionChanged&&(delete t._testSelectionChanged,i.isFileChangedRun()&&delete t._hasAnyPendingInEditorFileChanges,debug("Promoting test run to full run because of test selection changes"),i.setFullRunPriority()),debug("Test run started; run priority: %s",i.getPriority()),t._runTests(i)})["catch"](function(e){return e.runCancelled?(debug("Test run cancelled, re-queueing run data"),Q.when({queueAgain:!0,rerun:e.rerun})):e.postprocessor?(t.isNativeBundler()?t._emitTestRunError(t._cleanStack({stack:utils.removeAnsi(e.message)}).stack):t._emitTestRunError("Postprocessor run failure: "+e.message),Q.when({queueAgain:!0,testErrorReported:!0})):(t._emitTestRunError((process.env.quokka?"":"Test run failure: ")+(e&&e.message)),Q.when(!1))}).then(function(o){if(debug("Test run finished"),_.isEmpty(n)||_.each(o.loadingSequence,function(e,t){o.loadingSequence[t]=_.keys(_.reduce((e||[]).concat(n[t]||[]),function(e,t){return e[t]=!0,e},{}))}),delete t._runCancelRequester,o){if(r.length&&(o.globalErrors=(o.globalErrors||[]).concat(r)),o.profile){t._emit({type:"testRunReQueued",profileRun:!0});var s=t._processProfile(o.profile);if(o.profileRunData&&"editor"===o.profileRunData.target)t._writeFileSync(t._profilePath,JSON.stringify(s)),t._emit({type:"profileAvailable",path:t._profilePath});else{t._profileViewer||(t._profileViewer=new ProfileViewer(t));var a=void 0;o.tests&&o.tests[0]&&(a=o.tests[0].name);var l=void 0;o.profileRunData&&(l=o.profileRunData.file),t._profileViewer.show(s,l||"Profile",a||"Test profile")["catch"](function(e){if(e)throw t._cleanStack(e),e})}return}if(o.queueAgain)o.file&&(debug("File has invalid syntax: "+o.file),t._emitTestRunError("Test run failure: file "+o.file+" has invalid syntax"),o.testErrorReported=!0),t._testTask.mergeTask(i),debug("Test run data re-queued"),t._emit({type:"testRunReQueued",rerunScheduled:o.rerun,testErrorReported:o.testErrorReported}),o.rerun&&t._scheduleTestRun(e);else{var c=o.globalErrors&&o.globalErrors.length,u=c||t._hadGlobalErrorsPreviousRun;t._hadGlobalErrorsPreviousRun=c,c&&o.testFiles&&(t._lastAffectedTestFileIds=_.map(o.testFiles,function(e){return e.id})),o.changed=!!i.isFullRun()||_.reduce(i.files(),function(e,t){var i=!!t.lastSingleChangeTest;return delete t.lastSingleChangeTest,e[t.id]={singleTestChange:!u&&i},e},{}),t._emit(t._processCoverageResult({time:o.time,type:"testResults",fullRun:i.isFullRun(),fileChangedRun:i.isFileChangedRun()},o)),debug("Test run result processed and sent to IDE")}}})["catch"](function(e){t._testRunInProgress=!1,t._lastRunFinishTime=+new Date,t._testRunTimeout&&(clearTimeout(t._testRunTimeout),t._scheduleTestRun(100)),debug("Failed to process test run results",e.stack),console.error("Failed to process test run results",e.message)}).then(function(){t._testRunInProgress=!1,t._lastRunFinishTime=+new Date,t._testRunTimeout&&(clearTimeout(t._testRunTimeout),t._scheduleTestRun(100))})},e)},navigationRequested:function(e){var t=utils.normalizePath(e).split(":"),i=t.slice(0,t.length-1).join(":");i=path.relative(this._localRoot,i);var n=parseInt(t[t.length-1],10);n?n--:n=0,process.env.quokka&&this._originalQuokkaFileName&&i===this._quokkaFileName&&(i=this._originalQuokkaFileName),this.emit("message",{type:"navigationRequested",path:i,line:n})},_processProfile:function(e){var t=this,i=process.mainModule&&utils.normalizePath(path.dirname(process.mainModule.filename))||"";return _.each(e.nodes,function(e){if(e&&e.callFrame&&e.callFrame.url&&0!==e.callFrame.url.indexOf("node:"))if(~e.callFrame.url.indexOf(i)||0===e.callFrame.url.indexOf("http")&&~e.callFrame.url.indexOf("__wallaby__")&&!_.endsWith(e.callFrame.url,"framework.js"))e.callFrame.functionName="(worker)",e.callFrame.scriptId="0",e.callFrame.url="",e.callFrame.lineNumber=-1,e.callFrame.columnNumber=-1;else{var n=e.callFrame.lineNumber+1;if(n){var r={stack:e.callFrame.url+":"+n+":"+e.callFrame.columnNumber,suppressErrorReporting:!0};if(t._testRunner.mapStack(r),r.stack.length){var o=__read(r.stack[0],2),s=o[0],a=o[1],l=t._getFileMetadataById(s);l&&(e.callFrame.lineNumber=a,e.callFrame.columnNumber=0,e.callFrame.url=utils.fileUrl(t._fullLocalPathForTestRunner(l)))}else e.callFrame.lineNumber=n}e.positionTicks&&_.each(e.positionTicks,function(i){if(i.line>=1){var n={stack:e.callFrame.url+":"+i.line,suppressErrorReporting:!0};t._testRunner.mapStack(n),n.stack.length&&(i.line=n.stack[0][1])}})}}),e},_buildBundle:function(e){var t=this,i=1/0,n="",r=[],o=1;_.each(e,function(e){e.file.include=!1,e.file.notStored=!0;var t=e.content+"\n";i=Math.min(i,e.file.order);var s=utils.textLines(t).length,a=o,l=o-1+s-1,c=[a,l];c.file=e.file.originalId,r.push(c),o=l+1,n+=t});var s={id:bundleFileId,path:"____wallaby-bundle.js",ts:+new Date,tmp:!0,type:"js",instrumentedType:"js",include:!0,order:i-.1,test:!1},a=t._createFileMetadata(s,s.id);return a.originalId=s.id,
a.fileAndLineByLine=function(e){for(var t,i=0,n=r.length-1;i<=n;){t=Math.floor((n+i)/2);var o=r[t];if(e>=o[0]&&e<=o[1])return[o.file,e-o[0]+1];e>o[1]?i=t+1:n=t-1}},t._fileOrderUpdatePending=!0,t._doWriteFileWithLruCache(a.instrumentedPath,n)},hadGlobalErrorsPreviousRun:function(e){return void 0!==e&&(this._hadGlobalErrorsPreviousRun=e),this._hadGlobalErrorsPreviousRun},_emitTestRunError:function(e){var t=this;t._emit({type:"testRunError",message:t._cleanMessage(e)})},_emitTestRunStarted:function(){this._emit({type:"testRunStarted"})},_deleteDependantFiles:function(e,t){var i=this;return t||(t=[]),_.each(e.dependant,function(e){t.push(i._unlinkFilePromise(e.instrumentedPath)["catch"](function(){return Q.when()})),i._deleteDependantFiles(e,t)}),t},_processChangedQueue:function(){var e=this,t=[],i=[];_.each(e._changeQueue,function(n,r){r=parseInt(r,10);var o=!1,s=!1,a=e._structure.filesById[r],l=[],c=[],u=!1,h=!1;if(_.each(n,function(e){return e["delete"]?void(o=e):(l.push(e),c=c.concat(e.file.affectedTests||[]),s=e.file.test||a&&a.test,u=u||e.inEditor,void(h=h||e.suppressesSingleTestFileChangeStart))}),c.length||s&&o||(c=s?[[r]]:a&&_.map(a.tests,function(e,t){return e===runOneTime&&delete a.tests[t],t.split(testPathSeparator)})||[]),s&&(e._lastAffectedTestFileIds=o?void 0:[r]),o){var d=e._structure.filesByPath[o.file.path];if(d){if(t=t.concat(e._deleteDependantFiles(d)),e._deleteFileMetadata(o.file),s){var f=d.path;_.each(e._structure.filesById,function(e){_.each(e.tests,function(t){(t===f||_.startsWith(t,f+testPathSeparator))&&delete e.tests[t]})})}(e.isZeroConfigJest()||e.isVitest()||e.isNativeBundler())&&!d.inOriginalFilesCache||t.push(e._deleteSourceFile(d.originalPath)),e.isZeroConfigJest()||e.isVitest()||e.isNativeBundler()||t.push(e._unlinkFilePromise(d.instrumentedPath)),i.push({file:d,deleted:!0,tests:d.test?[]:c})}}else if(l.length){var p=_.last(l),g=e._getOrCreateFileMetadata(p.file);g.logMarkers=p.logMarkers,g.extractedComments=p.extractedComments,t.push(e._writeFileChanges(g,_.map(l,function(e){return e.file.content}),p.file.ts,h,p.fileSystemMatchesContent)),i.push({file:g,tests:c,added:!a,inEditor:u})}}),e._changeQueue={};var n=function(){e._filesAreUpToDate(_.map(i,function(e){return e.file.id}))};return Q.all(t).then(function(){return n(),Q.when(i)})["catch"](function(t){return debug("File system update failure: "+t&&(t.stack||t.message)),n(),e._cleanStack(t),e._emitTestRunError(t&&t.message),Q.when([])})},normalizePath:function(e){return utils.normalizePath(e)},_createPostProcessorArgument:function(e){var t=this;e=e||{};var i=t._createPostProcessorInputFile.bind(t,e["native"]),n=t._settings.testLocations?function(e){return!e.tmp&&(!e.test||e.includedExplicitlyTestFile)}:function(e){return!e.tmp};t._updateFileOrder();var r=_.chain(t._structure.testFilesInOrder).filter(n).map(i).value(),o=_.chain(t._structure.sourceFilesInOrder).filter(n).map(i).value().concat(r),s=e.affectedFiles&&e.affectedFiles.length&&_.chain(e.affectedFiles).filter(n).map(i).value()||o,a=e.affectedTestFiles&&e.affectedTestFiles.length&&_.chain(e.affectedTestFiles).filter(n).map(i).value()||r;delete e.affectedFiles,delete e.affectedTestFiles;var l=e.bundleAllowed;return _.extend({},{bundle:[],anyFilesAdded:!0,anyFilesDeleted:!1,allFiles:o,allTestFiles:r,affectedFiles:s,affectedTestFiles:a,nodeModulesDir:t._nodeModules,baseDir:e["native"]?t._localProjectDir:t._instrumentedRoot,tsPostprocessorOnly:t._settings.postprocessor.ts,settings:t._settings,setFileOrder:function(e){if(e.file&&e.file.id){t._fileOrderUpdatePending=!0;var i=t._getFileMetadataById(e.file.id);i&&(i.order=e.order)}return Q.when(e.order)},createFile:function(e){return __awaiter(this,void 0,void 0,function(){var i,n,r,o,s,a,c,u,h,d,f,p,g,v,y,m,b,k;return __generator(this,function(T){switch(T.label){case 0:return i=this,n=_.ltrim(path.extname(e.path),"."),r=t.normalizePath(e.path),o=_.extend(e,{id:r,path:r,ts:e.ts||+new Date,tmp:!0,type:n,instrumentedType:n,include:e.load!==!1,order:e.order||0,test:e.test||e.test!==!1&&e.original&&e.original.test}),s=t._getFileMetadataById(o.id)||{},a=s.includedTestFile,c=s.excludedTestFile,o.includedTestFile=!!a,o.excludedTestFile=!!c,u=t.isNativeBundler(),h=t._createFileMetadata(o,o.id),t._fileOrderUpdatePending=!0,d=!1,d=u?l&&!h.test&&"original"in e:l&&!h.test&&"original"in e&&e.content&&0===e.content.indexOf("window.__moduleBundler.cache"),u?[3,7]:(g=e.original&&e.original.id&&e.ranges&&e.sourceMap,e.original&&e.original.id&&(f=t._structure.filesById[e.original.id],f.instrumentedType=n,h.originalId=f.id,h.originalType=f.originalType||f.type,h.ranges=f.ranges,h.loggedRanges=f.loggedRanges,h.notInstrumentedLogMarkers=f.notInstrumentedLogMarkers,h.liveCommentLines=f.liveCommentLines,f.dependant||(f.dependant={}),delete f.dependant[h.id],v=_.values(f.dependant)[0],v&&(v.noCompilers===!1?t._deleteFileMetadata(v):v=void 0),f.dependant[h.id]=h,e.sourceMap&&!g&&(f.tmpLineMap=utils.updateFileMap(v&&(f.compiledTmpLineMap||f.tmpLineMap)||f.lineMap,[e.sourceMap])),g&&(h.noCompilers=!1,h.sourceMap=e.sourceMap,h.ranges=e.ranges,h.type="js",h.lineMap=utils.updateFileMap(h.lineMap,[e.sourceMap]),h.coverable=f.coverable,h.hideFromErrorStackTrace=f.hideFromErrorStackTrace,h.numberOfFunctions=f.numberOfFunctions,h.changePosition=_.textIndexPosition(t._getInstrumentedFileContent(f),f.changeStart),h.logMarkers=f.logMarkers,h.extractedComments=f.extractedComments)),g?[4,t._processFile(h,e.content,void 0,!1,!0,d)]:[3,2]);case 1:return p=T.sent(),f.tmpLineMap=h.lineMap,f.compiledTmpLineMap=h.lineMap,f.ranges=h.ranges,f.loggedRanges=h.loggedRanges,f.notInstrumentedLogMarkers=h.notInstrumentedLogMarkers,f.liveCommentLines=h.liveCommentLines,f.validSyntax=h.validSyntax,f.include=!1,f.numberOfFunctionsChanged=h.numberOfFunctionsChanged,f.numberOfFunctions=h.numberOfFunctions,f.lastSingleChangeTest=h.lastSingleChangeTest,delete h.lineMap,[3,6];case 2:return d?[3,4]:[4,t._doWriteFileWithLruCache(h.instrumentedPath,e.content)];case 3:return y=T.sent(),[3,5];case 4:y=e.content,T.label=5;case 5:p=y,T.label=6;case 6:return[3,11];case 7:if(e.original&&e.original.id&&(f=t._structure.filesById[e.original.id],h.originalId=f.id,h.originalType=f.originalType||f.type,f.dependant||(f.dependant={}),f.dependant[h.id]=h,h.ranges)){if(e.sourceMap&&(f.lineMap=utils.updateFileMap({},[e.sourceMap])),f.ranges=[],e.extra.sourceMap)try{m=new utils.SourceMapConsumer(e.extra.sourceMap),_.each(h.ranges||[],function(e){var t=utils.mapTransformedRangeToOriginal(m,e);t&&t[3]===1/0&&(t[3]=t[1]+1),f.ranges.push(t||[])})}catch(S){debug("Failed to map ranges for [%s], error: %s",f.path,S.message)}else f.ranges=h.ranges;f.instrumentedType=n,f.numberOfFunctionsChanged=f.numberOfFunctions!==e.extra.numberOfFunctions,f.numberOfFunctions=e.extra.numberOfFunctions,f.loggedRanges=e.extra.loggedRanges,f.notInstrumentedLogMarkers=e.extra.notInstrumentedLogMarkers,f.liveCommentLines=e.extra.liveCommentLines,f.lastSingleChangeTest=f.test&&!f.numberOfFunctionsChanged&&e.extra.testName,f.lastSingleChangeTest&&debug("Detected single test [%s] change",e.extra.testName),f.include=!1,h.test&&(t._settings.extractComments?(b=f.extractedComments,t._updateTestFileSelection(f,{includedTestFile:b&&b.testFileSelection&&b.testFileSelection.included,excludedTestFile:b&&b.testFileSelection&&b.testFileSelection.excluded}),b&&delete b.testFileSelection):t._updateTestFileSelection(f,{includedTestFile:e.extra.includedTestFile,excludedTestFile:e.extra.excludedTestFile}))}return d?[3,9]:[4,t._doWriteFileWithLruCache(h.instrumentedPath,e.content)];case 8:return k=T.sent(),[3,10];case 9:k=e.content,T.label=10;case 10:p=k,T.label=11;case 11:return d&&i.bundle.push({file:h,content:p}),[2]}})})}},e,{logger:t._createLogger("postprocessor",e.logger)})},_createLogger:function(e,t){t=t||{};var i=logger.create(e);return{debug:i.debug,trace:i.trace,error:t.error||console.error.bind(console),log:t.log||console.log.bind(console)}},_createPostProcessorInputFile:function(e,t){var i=this;return{path:e?t.path:i.normalizePath(path.relative(i._instrumentedRoot,t.instrumentedPath)),fullPath:e?path.resolve(path.join(i._localProjectDir,t.path)):t.instrumentedPath,binary:t.binary,ts:t.changeTs,id:t.id,type:e?t.type:t.instrumentedType||t.type,load:t.include,initialLoad:t.initialInclude,instrument:t.coverable,test:t.test,order:t.order,changeStart:t.changeStart,changePosition:t.changePosition,logMarkers:t.logMarkers,extractedComments:t.extractedComments,getContent:function(){if(e)return i.getLatestOriginalFileContentByPathAsync(t.path);var n=i._lruCache.get(t.instrumentedPath);return n?Q.when(n):i._readFilePromise(t.instrumentedPath)},getContentSync:function(){return e?i.getLatestOriginalFileContentByPath(t.path):i._getInstrumentedFileContent(t)},setOrder:function(e,n){i._fileOrderUpdatePending=!0,n&&_.each(t.dependant,function(t){t.order=e}),t.order=e}}},_getInstrumentedFileContent:function(e){var t=this,i=t._lruCache.get(e.instrumentedPath);return i||t._readFileSync(e.instrumentedPath)},getInstrumentedJavaScriptFileContentByPath:function(e){var t=this._structure.filesByPath[e];if(t){var i={};return i[t.path]=t,t=_.find(this._expandDependantFiles(i),function(e){return _.isEmpty(e.dependant)&&"js"===e.type})||t,t&&this._getInstrumentedFileContent(t)}},getLatestOriginalFileContentByPath:function(e){var t=this._structure.filesByPath[e];if(t){var i=this._sourceFileCache[t.originalPath];return i?i.content:!this.isZeroConfigJest()&&!this.isVitest()&&!this.isNativeBundler()||t.inOriginalFilesCache?this._readFileSync(t.originalPath):this._readFileSync(path.join(this._localRoot,t.path))}},getLatestOriginalFileContentByPathAsync:function(e){return __awaiter(this,void 0,void 0,function(){var t,i,n,r;return __generator(this,function(o){switch(o.label){case 0:return(t=this._structure.filesByPath[e])?(i=this._sourceFileCache[t.originalPath])?(n=i.content,[3,6]):[3,1]:[2];case 1:return(this.isZeroConfigJest()||this.isVitest()||this.isNativeBundler())&&!t.inOriginalFilesCache?[3,3]:[4,this._readFilePromise(t.originalPath)];case 2:return r=o.sent(),[3,5];case 3:return[4,this._readFilePromise(path.join(this._localRoot,t.path))];case 4:r=o.sent(),o.label=5;case 5:n=r,o.label=6;case 6:return[2,n]}})})},findTestFile:function(e){for(var t,i=this,n=e.files||[],r=0,o=n.length;r<o;r++){var s=n[r];if(t=i._structure.testFilesById[s])return t}if(e.testFile&&(t=i._structure.testFilesById[e.testFile]))return t;if(s=i._structure.filesById[n[0]]){var a=_.keys(s.testFilesLoadedFrom||{})[0];if(a)return t=i._structure.testFilesById[a],t&&debug('Test "%s" without test file id mapped to %s (%s)',e.name,t.path,JSON.stringify({log:e.log,filesInvolved:_.map(e.files,function(e){var t=i._structure.filesById[e];return t?t.path:"unknown or deleted file"})})),t}},resolveLogEntryRange:function(e){var t=this;if(("log"===e.type||"autoLog"===e.type||"diff"===e.type||"system"===e.type)&&_.isNumber(e.file)&&_.isNumber(e.range)){var i=this._getFileMetadataById(e.file),n=e.range;return i&&(e.range=i.ranges[n],e.range&&!e.range.length&&(e.range=t._findPreviousValidRange(i.ranges,n)),e.range&&e.range.length||delete e.range),!0}return!1},addTestFileWithGlobalErrorToTestTask:function(e){this._testTask&&this._testTask.addTestFileWithGlobalError(e)},_findPreviousValidRange:function(e,t){for(;t>0;){var i=e[--t];if(i&&i.length)return i}},_processValueExplorerValues:function(e){_.each(e,function(t,i){var n=t.entry;if(n.valueBag.data.proxyData){var r=e[i.split("#")[0]];if(r){r=r.entry;var o=function(e,t){t.label=__assign({name:t.proxyData.path.join(".")+" "+t.proxyData.trap.toUpperCase()},t.label),t.expressionPath=t.expressionPath.slice().concat(t.proxyData.path.map(function(e){return"."+e})),e.props.push(t)};if(r.valueBag.data.proxyContainerNode){var s=r.valueBag.data.props[0];o(s,n.valueBag.data)}else{var s={disallowToCopyPath:!0,disallowToCopyData:!0,expandable:!0,label:{name:"Accessed Members"},props:[],id:r.valueBag.data.id+",proxyNode",proxyNode:!0};o(s,n.valueBag.data),r.valueBag.data={disallowToCopyPath:!0,disallowToCopyData:!0,proxyContainerNode:!0,id:r.valueBag.data.id+",valueContainer",autoExpand:r.valueBag.data.autoExpand,changeId:r.valueBag.data.changeId,expandable:!0,label:r.valueBag.data.label,props:[s,__assign(__assign({},r.valueBag.data),{label:__assign({name:"Value"},r.valueBag.data.label)})]}}}}})},_processCoverageResult:function(e,t){var i=this;e.ts=Date.now(),e.files=[],e.tests=[],e.testMatchSnapshotCalls={},e.log=t.log,e.globalErrors=t.globalErrors,e.fileChanges=t.fileChanges,e.additionalHeaderMessage=this._additionalHeaderMessage();var n=i._settings.reportConsoleErrorAsError&&{},r={},o=e.log.slice(),s={};e.log=[],_.each(o,function(t){if(i.resolveLogEntryRange(t)||"error"!==t.type||!n){if(t&&t.valueBag&&t.valueBag.data&&t.valueBag.data.id){if(_.isNumber(t.valueBag.traceStep)&&(s[t.valueBag.traceStep]=t),t.valueBag.data.proxyData)return void(r[t.valueBag.data.id]={entry:t});var o=r[t.valueBag.data.id];if(o)return e.log[o.index]=t,void(o.entry=t);r[t.valueBag.data.id]={index:e.log.length,entry:t}}e.log.push(t)}else{var a={message:"\n"!==t.text&&t.text||"[console.error without any message]",stack:[]};if(t.spec){var l=n[t.spec]=n[t.spec]||[];l.push(a)}else e.globalErrors||(e.globalErrors=[]),e.globalErrors.push(a)}}),this._processValueExplorerValues(r),debug("Processed console.log entries"),_.each(t.loadingSequence,function(t,n){_.each(t,function(t){var r=i._structure.filesById[t];r&&!i.settings().ignoreFileLoadingDependencyTracking&&(r.testFilesLoadedFrom=r.testFilesLoadedFrom||{},r.testFilesLoadedFrom[n]=runAlways);var o=i._structure.testFilesById[t];if(n!==t&&o){var s=i._structure.testFilesById[n];s&&e.globalErrors.push({message:"Test file '"+s.path+"' is importing or is causing import of another test file '"+o.path+"'.\nThis may cause tests in the '"+o.path+"' file to be executed more than once (when the test file runs and every time it gets imported).\nIf the '"+o.path+"' test file contains some test helper code, try refactoring the reused code into a file of its own and use it by importing the new file into '"+s.path+"' and '"+o.path+"' test files."})}})}),debug("Processed loading sequences");var a={},l={},c=!1;_.each(t.tests,function(t){if("disabled"!==t.status&&!a[t.id]){if(t.matchSnapshotCalls&&_.each(t.matchSnapshotCalls,function(t){var n=i._structure.filesById[t.fileId];if(n&&n.matchSnapshotRanges){var r=n.matchSnapshotRanges[t.snapshotCallRangeId];if(r){var o=e.testMatchSnapshotCalls[t.fileId]=e.testMatchSnapshotCalls[t.fileId]||{};delete t.snapshotCallRangeId,delete t.fileId,o[r[0]]=t}}}),n){var r=n[t.id];r&&(t.log=(t.log||[]).concat(r))}for(var o=e.tests,s=e,u=0,h=t.suite.length;u<h;u++){var d=t.suite[u];s=_.find(o,function(e){return e.name===d&&e.tests}),s||(s={name:d,tests:[]},o.push(s)),o=s.tests}var f=!(!t.log||!t.log.length),p=i.findTestFile(t);if(!p)return console.warn("Test without test file id, most likely the test did not run, OR the test/test body is in the file that is not in the `tests` list in the configuration file",{testFileIdCanNotBeDetermined:t.name,id:t.id,log:t.log,filesInvolved:_.map(t.files,function(e){var t=i._structure.filesById[e];return t?t.path:"unknown or deleted file"})}),void(f&&(c=!0));var g=p.id,v=t.suite.slice();v.unshift(p.path),v.push(t.name);var y=v.join(testPathSeparator);f&&i._testTask.failingTest(g,v);var m=l[y];m?(debug("Test name duplicate: "+t.name),t.name+=" #"+m,l[y]=m+1):l[y]=1;var b={name:t.name,id:t.id,fileId:g,log:t.log,time:t.time,slow:t.slow,status:t.status,duplicateNumber:m};s.tests.push(b),a[t.id]={out:b,timeRange:t.timeRange},_.each(t.files,function(e){var t=i._structure.filesById[e];t&&(t.tests[y]=runAlways)});var k=[];_.each(b.log,function(e){e.external&&e.stack&&(_.each(e.stack,function(t){var n=i._structure.filesById[t[0]];n&&(n.tests[y]=n.tests[y]||runOneTime,n.test&&n.id!==g&&(e._global=!0))}),e._global&&k.push(e),delete e.external),e.snapshot=!(!e.message||!(~e.message.indexOf(".toMatchSnapshot(")||~e.message.indexOf(".toThrowErrorMatchingSnapshot(")||~e.message.indexOf("Snapshot name:")&&~e.message.indexOf("Received:")||e.message.startsWith("Snapshot `")&&~e.message.indexOf("mismatched")))}),k.length&&(e.globalErrors=(e.globalErrors||[]).concat(k),b.log=_.filter(b.log,function(e){return!e._global}))}}),c&&(e.globalErrors||(e.globalErrors=[]),e.globalErrors.unshift({message:"Some of the failing tests can not be reported, check the wallaby console for more details"})),debug("Processed executed tests"),i._updateFileOrder(),_.each(t.changed===!0?i._structure.sourceFilesInOrder.concat(i._structure.testFilesInOrder):_.map(t.changed,function(e,t){return i._getFileMetadataById(t)}),function(e){if(e){var n=e.id;_.isNumber(n)&&!t.coverage[n]&&i._isJavaScript(e)&&(t.coverage[n]=[])}});var u={};if(_.each(t.coverage,function(n,r){r=parseInt(r,10);var o=t.changed[r],s={id:r,ranges:[],changed:t.changed===!0||!!o,singleTestChanged:!(!o||!o.singleTestChange)||void 0};u[r]=s;var l=i._getFileMetadataById(r);l.instrumentedByTestingFramework&&(s.instrumentedByTestingFramework=!0),l.notInstrumentedLogMarkers&&(s.notInstrumentedLogMarkers=l.notInstrumentedLogMarkers),l.liveCommentLines&&(s.liveCommentLines=l.liveCommentLines);var c=l.ranges;_.each(l.loggedRanges,function(e,t){var i=c[t];i&&(i.logged=!0)});var h,d,f={},p={},g={},v={};_.each(c,function(t,o){var c=!t.length,u=!1,y=n[o],m=_.map(y,function(n,o){if(o=parseInt(o,10),!o)return null;var s=a[o];if(!s)return null;var f=s.timeRange;return f?((f[0]===n||d&&!c)&&(c?d=!0:(l.test&&i._looksLikeTestDeclarationRange(h,t)&&(e.log.push({type:"system",text:_.isNumber(s.out.time)?s.out.time+"ms":"",file:r,range:h,context:""}),s.out.declaration=h),s.out.start=t,r!==s.out.fileId&&(p[s.out.fileId]=!0),d=!1)),c||(u=!0),o):o});if(!c){h=t;var b=t.join("."),k=t[0],T=g[k];T?T.hasMultipleRanges||T.rangeKey===b||(T.hasMultipleRanges=!0):g[k]={rangeKey:b};var S=s.changed||m.length||l.relatedFilesWithTests;if(S||t.hasDuplicates){var C={items:t,hits:m},L=f[b];L?(m&&m.length||(v[b]=L),t.logged&&(L.items.logged=t.logged),t.hasDuplicates=!0,L.items.hasDuplicates=!0):(f[b]=C,S&&s.ranges.push(C))}}}),_.each(v,function(e){var t=e.items[0],i=g[t];i&&i.hasMultipleRanges&&(e.hits=[])}),_.isEmpty(p)||(l.relatedFilesWithTests=p,_.each(p,function(e,t){var n=i._getFileMetadataById(t);n&&(n.relatedFilesWithTests=n.relatedFilesWithTests||{},n.relatedFilesWithTests[l.id]=!0)})),e.files.push(s)}),_.isObject(t.changed)){var h=function(e){var t=u[e];t&&(t.changed=!0,t.singleTestChanged=void 0)},d={},f=function(e){if(!d[e]){d[e]=!0;var t=i._getFileMetadataById(e);t&&t.relatedFilesWithTests&&(h(t.id),_.each(t.relatedFilesWithTests,function(e,t){h(t),f(t)}))}};_.each(t.changed,function(e,t){f(t)})}if(debug("Processed code coverage"),t.trace){e.trace={sequence:[],callStack:t.trace.callStack,tests:t.trace.tests,files:{}};var p=_.values(t.trace.tests),g=void 0,v=p.shift(),y=[],m=_.isEmpty(s)?void 0:function(e,t){var i,n,r=s[t];if(r){delete s[t];var o=__read(r.valueBag.data.id.split(","),2),a=o[0],l=o[1];if(a=parseInt(a,10),l=parseInt(l,10),e[0]!==a||e[1]!==l){var c=y.slice().reverse();try{for(var u=__values(c),h=u.next();!h.done;h=u.next()){var d=h.value;if(d&&d.data[0]===a&&d.data[1]===l){r.valueBag.traceStep=d.index;break}}}catch(f){i={error:f}}finally{try{h&&!h.done&&(n=u["return"])&&n.call(u)}finally{if(i)throw i.error}}}_.isEmpty(s)&&(m=void 0,y.length=0)}};_.each(t.trace.sequence,function(t,n){var r=i._getFileMetadataById(t[0]);g&&g.end===e.trace.sequence.length&&(g=void 0),v&&v.start===e.trace.sequence.length&&(g=v,v=p.shift());var o=!!g;if(r&&!r.test){var s=e.trace.files[r.path];s?!s.hitFromTest&&o&&(s.hitFromTest=!0,s.start=e.trace.sequence.length):e.trace.files[r.path]={start:e.trace.sequence.length,hitFromTest:o,name:r.path}}if(m){m(t,n);var a=t[2];y[a]={data:t,index:n}}e.trace.sequence.push(t)}),debug("Processed code trace")}return e},_looksLikeTestDeclarationRange:function(e,t){return e&&t&&e[0]<=t[0]&&(e[2]>=t[2]||this.isZeroConfigJest()||this.isVitest()||this.isNativeBundler())},_filesAreUpToDate:function(e){var t=this;return t._structure.awaitingFiles=_.without.bind(null,t._structure.awaitingFiles).apply(null,e),t._signalIfBecameLive()},_filesAreRequired:function(e){var t=this;t._structure.awaitingFiles=_.union(t._structure.awaitingFiles,e),t._structure.awaitingFiles.length&&(t._live=!0,t._emit({type:"filesRequired",files:t._structure.awaitingFiles}))},_signalIfBecameLive:function(){var e=this;if(e._structure&&!e._structure.awaitingFiles.length&&!e._live){e._live=!0;var t={type:"live"};if(process.env.quokka||(t.wallabyAppPort=e._uiService&&e._uiService.port,t.projectCachePath=e._root),e._emit(t),process.env.quokka){var i=process.version;process.env.WALLABY_ELECTRON_RUN_AS_NODE&&(i+=" - Electron"),this._emitInternal(_.extend({type:"configChanged",settings:this._quokkaSettings},JSON.parse(process.env.quokka),{nodeVersion:i}))}return debug("Stopping process pool"),e._processorPool.stop(),!0}},_writeFileChanges:function(e,t,i,n,r){var o=this;e.inOriginalFilesCache=!0,e.changeTs=+new Date;var s,a=[];_.each(t,function(e){var t=_.isPatch(e);t?a.push(e):(s=e,a.length=0)});var l=a.length===t.length;return trace("File %s changes are patches only: %s",e.path,l),Q.all([l?o._readOriginalSourceFile(e.id,e.originalPath):Q.when(!1),o._dirEnsurePromise(path.dirname(e.originalPath)),o._dirEnsurePromise(path.dirname(e.instrumentedPath))]).then(function(t){l&&(s=t[0]);var i=void 0;return delete e.lastChangeIsComplex,_.each(a,function(t){var r=o._diffMatchPatch.patch_fromText(t),l=1===a.length&&3===t.split("@@").length;l?e.test&&!n&&_.each(r,function(e){e.diffs&&e.diffs.length&&2===e.diffs[0].length&&!e.diffs[0][0]&&(i=e.start2+e.diffs[0][1].length)}):e.lastChangeIsComplex=!0,s=o._diffMatchPatch.patch_apply(r,s)[0]}),process.env.quokka&&o._quokkaFileChanged(s),Q.all([e.binary?o._doWriteFile(e.originalPath,Buffer.from(s,"base64")):o._writeSourceFile(e.originalPath,s),o._processFile(e,s,i,!o._live,!1)])}).then(function(){return e.ts=i,trace("File %s changes saved, store ts: %s, change ts: %s",e.path,e.ts,e.changeTs),Q.when(!0)})},_quokkaFileChanged:function(content){var inlineConfig,inlineConfigString;if(content){var match=/^[\s;]*(\s*\/\/.*?\r?\n)*\s*\(\s*?{/.exec(content);if(match&&match[0]){for(var braceStack=[],start=match[0].length-1,i=start,len=content.length;i<len;i++){var character=content[i];if("{"===character?braceStack.push(character):"}"===character&&braceStack.pop(),!braceStack.length)break}try{inlineConfig=eval(_85d‍.c("("+content.substring(start,i+1)+")")),inlineConfigString=JSON.stringify(inlineConfig)}catch(e){}}}if(this._settings._currentInlineQuokkaConfigString!==inlineConfigString){this._loadQuokkaSettings(inlineConfig),this._settings=this._quokkaSettings,this._settings._currentInlineQuokkaConfigString=inlineConfigString,this._settings._currentInlineQuokkaConfig=inlineConfig;var file=this._structure.filesByPath[this._quokkaFileName];delete file.noCompilers,delete file.noPreprocessors,this._recycleRunner=!0}},isZeroConfigJest:function(){return this._settings.testFramework.version&&0===this._settings.testFramework.version.indexOf("jest")&&this._settings.testFramework.autoDetected},isVitest:function(){return this._settings.testFramework.version&&0===this._settings.testFramework.version.indexOf("vitest")&&this._settings.testFramework.autoDetected},isNodeJasmine:function(){return"node"===this._settings.env.type&&this._settings.testFramework.version&&0===this._settings.testFramework.version.indexOf("jasmine")},hasGlobalSetupOrTeardown:function(){return this._settings.globalSetup},isNativeBundler:function(){return this._settings.postprocessor&&this._settings.postprocessor.bundler&&this._settings.postprocessor.bundler["native"]},_notInstrumented:function(e,t,i){if(trace("File "+e.path+" is not instrumented by core"),e.validSyntax=!0,this.isZeroConfigJest()||this.isVitest()){if(e.changeStart=i,e.changeStart?e.changePosition=_.textIndexPosition(t,e.changeStart):delete e.changePosition,!e.binary&&e.test&&!process.env.quokka){var n=void 0;if(this._settings.extractComments){n={includedTestFile:!1,excludedTestFile:!1};var r=e.extractedComments;r&&r.testFileSelection&&(n.includedTestFile=r.testFileSelection.included,n.excludedTestFile=r.testFileSelection.excluded,delete r.testFileSelection)}else{var o=utils.deserializeRegExp(this._settings.hints.testFileSelection.include),s=utils.deserializeRegExp(this._settings.hints.testFileSelection.exclude);n=utils.testFileSelection(t,o,s,this._settings.automaticTestFileSelection)}this._updateTestFileSelection(e,n)}}else e.ranges=[],this.isNativeBundler()&&(e.changeStart=i,e.changeStart?e.changePosition=_.textIndexPosition(t,e.changeStart):delete e.changePosition);return Q.when({code:t})},_processFile:function(e,t,i,n,r,o){var s=this;t=t&&t.toString()||"";var a=t;if(s.isZeroConfigJest()||s.isVitest()||s.isNativeBundler())return this._notInstrumented(e,a,i);if(process.env.quokka&&(n=!1,s._settings.error))throw new Error(s._settings.error);if(e.changeStart=i,trace("Preparing to process %s",e.path),"node"===s.settings().env.type&&(s._isJavaScript(e)||s._isOriginallyTypeScript(e))&&((e.coverable||e.test)&&(t=t.replace(/^\#\!.*/,"")),s._isJavaScript(e)&&s._settings.testFramework.jsPreprocessor&&(t=s._settings.testFramework.jsPreprocessor(t))),s._settings.testFramework.version&&0===s._settings.testFramework.version.indexOf("jest")&&(s._isOriginallyTypeScript(e)||s._isJavaScript(e))&&(e.originalId?e.docBlockComment=(s._structure.filesById[e.originalId]||{}).docBlockComment:e.docBlockComment=utils.docBlockComment(t).replace(/\r?\n|\r/g," ")||void 0),e.originalId){var l=s._structure.filesById[e.originalId];l&&(e.includedTestFile=l.includedTestFile,e.excludedTestFile=l.excludedTestFile)}if("snap"===e.type){var c=s._structure.filesByPath[path.join(path.dirname(e.path),"..",path.basename(e.path,".snap"))];c&&(e.testFilesLoadedFrom=e.testFilesLoadedFrom||{},e.testFilesLoadedFrom[c.id]=runAlways)}return n&&s._startProcessorPool(),!e.changeStart||e.noCompilers||e.binary||(e.changePosition=_.textIndexPosition(t,e.changeStart)),(e.binary||!e.coverable&&!e.test?Q.fcall(function(){return s._notInstrumented(e,a,i)}):(r?Q.when(t):s._runThroughProcessors(e,t,n,!0)["catch"](function(t){return s._cleanStack(t),Q.reject(new Error("Failed to run compilers on "+e.path+", "+(t&&(t.stack||t.message))))})).then(function(t){var r,o;if(e.noScript)return Q.fcall(function(){return s._notInstrumented(e,a,i)});if(!e.noCompilers){trace("Processing compiled "+e.path),e.instrumentedType="js";var c=e.sourceMap,u=new utils.SourceMapConsumer(c);delete e.sourceMap;var h=_.reduce(e.ranges,function(e,t){var i=e[t[0]]=e[t[0]]||[];return i.push(t),e},{});if(e.changePosition){e.changePosition.source=c.sources&&c.sources[0]||".";var d=s._findClosestRange(h,e.changePosition,!0);d&&(e.changePosition.column=d[1]),e.changePosition.bias=2,e.changeStart=u.generatedPositionFor(e.changePosition)}var f={};if(e.logMarkers)try{for(var p=__values(e.logMarkers),g=p.next();!g.done;g=p.next()){var v=g.value;v.originalRange=v.range,v.range=utils.mapOriginalRangeToTransformed(u,v.range),v.range&&(f[v.range.join(",")]=v.originalRange)}}catch(y){r={error:y}}finally{try{g&&!g.done&&(o=p["return"])&&o.call(p)}finally{if(r)throw r.error}}var m=s._isOriginallyCoffeeScript(e),b=function(t){_.each(t,function(t){if(e.logMarkers&&f[t.join(",")]){var i=f[t.join(",")];return t[0]=i[0],t[1]=i[1],t[2]=i[2],void(t[3]=i[3])}var n={line:t[0],column:t[1]},r=u.originalPositionFor(n);if(5===t.length){var o="_extends"===t[4]||"Babel.React.createElement"===t[4]||"Babel.objectSpread"===t[4];if(t.length=4,r.source&&!o){var a={line:t[0],column:t[1],bias:2},l=u.originalPositionFor(a);l.source&&r.line<l.line&&(r=l)}r.source||(n.column+=7,r=u.originalPositionFor(n),r.source||(m?(n.column+=7,r=u.originalPositionFor(n)):(n.column+=26,r=u.originalPositionFor(n))))}if(r.source)var c=s._findClosestRange(h,r);c?(t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=c[3]):t.length=0})}}if(!s._isOriginallyJavaScript(e)&&e.noCompilers)return Q.fcall(function(){return s._notInstrumented(e,a,i)});trace("Instrumenting "+e.path+", via process pool: "+n);var k=_.extend({},s._settings.hints);e.test?(process.env.quokka||k.allowIgnoringCoverageInTests||(k=_.omit(k,"ignoreCoverage","ignoreCoverageForFile")),s._settings.extractComments&&(k=_.omit(k,"testFileSelection"))):k=_.omit(k,"testFileSelection");var T=e.scriptRange?t.substring(e.scriptRange.start,e.scriptRange.end):t,S=e.logMarkers||[];return s._instrument(T,{file:e.tmp?e.originalId:e.id,test:e.test,testFileChangeStart:e.changeStart,logMarkers:S.map(function(e){return{originalRange:e.originalRange,range:e.range,changeId:e.id,traceId:e.traceId,expanded:e.expanded,"new":e["new"],exp:e.exp,action:e.action}}),extractedComments:remapComments(e.extractedComments,T,u),hints:k,recordValues:s._settings.autoConsoleLog,preserveComments:s._settings.preserveComments||!1,automaticTestFileSelection:!process.env.quokka&&e.test&&!s._settings.extractComments&&s._settings.automaticTestFileSelection,sequenceExpressionToDiff:!!process.env.quokka},n).then(function(i){if(i.error)throw i.error;if(b&&b(i.ranges),e.test)if(s._settings.extractComments){var n=e.extractedComments;s._updateTestFileSelection(l,{includedTestFile:n&&n.testFileSelection&&n.testFileSelection.included,excludedTestFile:n&&n.testFileSelection&&n.testFileSelection.excluded}),n&&delete n.testFileSelection}else s._updateTestFileSelection(e,i);return e.esm=i.esm,e.validSyntax=!0,e.ranges=i.ranges,e.loggedRanges=i.loggedRanges,e.notInstrumentedLogMarkers=i.notInstrumentedLogMarkers,i.liveCommentLines&&u?e.liveCommentLines=_.chain(i.liveCommentLines).map(function(e,t){return{line:parseInt(t,10),column:e+1}}).map(function(e){var t=e.line,i=e.column;return utils.mapTransformedRangeToOriginal(u,[t,i,t,i])}).filter(function(e){return e&&e.length}).map(function(e){return e[0]}).value():i.liveCommentLines&&(e.liveCommentLines=Object.keys(i.liveCommentLines).map(function(e){return parseInt(e,10)}).filter(function(e){return e}).map(function(e){return e})),e.lineMap=utils.updateFileMap(e.noCompilers?{}:e.lineMap,[JSON.parse(i.map)]),delete e.tmpLineMap,e.numberOfFunctionsChanged=e.numberOfFunctions!==i.numberOfFunctions,e.numberOfFunctions=i.numberOfFunctions,e.lastSingleChangeTest=e.test&&!e.numberOfFunctionsChanged&&i.testName,e.lastSingleChangeTest&&debug("Detected single test [%s] change",i.testName),e.docBlockComment&&i.code&&(debug("Re-attaching document block comment"),i.code=e.docBlockComment+i.code),e.scriptRange&&(i.code=t.substring(0,e.scriptRange.start)+i.code+t.substring(e.scriptRange.end)),Q.when(i)})["catch"](function(t){e.validSyntax=!1;var i=_.map(e.tests,function(e,t){return t.split(testPathSeparator)})||[];return s._testTask.addChangedFile(e,i),s._cleanStack(t),Q.when(utils.formatInstrumentationError(t,T,e.path))})})).then(function(t){return t instanceof Error?Q.when(t):s._runThroughProcessors(e,t.code,n,!1).then(function(t){return o?Q.when(t):(trace("Writing to disk and caching processed file %s",e.path),e.binary?s._doWriteFile(e.instrumentedPath,Buffer.from(t,"base64")):s._doWriteFileWithLruCache(e.instrumentedPath,t))})["catch"](function(t){return s._cleanStack(t),Q.when(new Error("Failed to run preprocessors on "+e.path+", "+(t&&(t.stack||t.message))))})}).then(function(e){return e instanceof Error?Q.reject(e):Q.when(e)})},testRunnerTransformedFile:function(e){var t=this._getFileMetadataById(e.id);if(t){if(trace("Test Runner transformed file: %s %s",t.path,e.transformedTime),t.ranges=[],t.matchSnapshotRanges=e.matchSnapshotRanges,e.transformed.map)try{var i=new utils.SourceMapConsumer(e.transformed.map);_.each(e.instrumented.ranges||[],function(e){var n=utils.mapTransformedRangeToOriginal(i,e);n&&(n[3]===1/0&&(n[3]=n[1]+1),n[2]>=n[0]||(n[2]=n[0]),n[3]>=n[1]||(n[3]=n[1]+1)),t.ranges.push(n||[])}),t.runnerCacheKey=e.runnerCacheKey}catch(n){t.ranges=[],debug("Failed to map ranges for [%s], error: %s",t.path,n.message);
}else t.ranges=e.instrumented.ranges,t.runnerCacheKey=e.runnerCacheKey;if(t.lineMap=e.lineMap,t.lastSingleChangeTest=e.instrumented.testName,t.numberOfFunctions=e.instrumented.numberOfFunctions,t.loggedRanges=e.instrumented.loggedRanges,t.notInstrumentedLogMarkers=e.instrumented.notInstrumentedLogMarkers,t.liveCommentLines=e.instrumented.liveCommentLines,e.parentFilePath){var r=this.getFileMetadataByPath(e.parentFilePath);r&&(t.parentFilePath=e.parentFilePath,r.childFilePath=t.path,r.runnerCacheKey=t.runnerCacheKey)}t.instrumentedByTestingFramework=!0}},_updateTestFileSelection:function(e,t){if(e){var i=e.includedTestFile,n=e.excludedTestFile;e.includedTestFile=t.includedTestFile,e.excludedTestFile=t.excludedTestFile,e.originalId||this._updateFileStructure(e),!!e.includedTestFile==!!i&&!!e.excludedTestFile==!!n||(this._testSelectionChanged=!0),e.originalId&&this._updateTestFileSelection(this._structure.filesById[e.originalId],t)}},_findClosestRange:function(e,t,i){var n=e[t.line];if(n)for(var r,o=1/0,s=0;s<n.length;s++){var a=n[s],l=Math.abs(a[1]-t.column);l<o&&(!i||a[1]<=t.column)&&(o=l,r=a)}return r},_runThroughProcessors:function(e,t,i,n){var r=this;if(!Object.keys(n?r._settings.compilers:r._settings.preprocessors).length||(n?e.noCompilers:e.noPreprocessors))return trace("No %s configured for %s",n?"compilers":"preprocessors",e.path),n?e.noCompilers=!0:e.noPreprocessors=!0,Q.when(t);var o={content:t,config:process.env.quokka?r._settings:r._configFile,file:e,root:r._instrumentedRoot,type:n?"compiler":"preprocessor"};return(i&&r._processorPool.started()?r._processorPool.run(o):processor(o)).then(function(t){if(t.error)throw t.error;return n?e.noCompilers=t.noProcessors:e.noPreprocessors=t.noProcessors,r._updateInstrumentedFile(t,e,n&&!e.noCompilers),Q.when(t.content)})},_updateInstrumentedFile:function(e,t,i){var n=this;i&&delete t.lineMap,e.maps&&e.maps.length&&(t.lineMap=utils.updateFileMap(t.lineMap,e.maps)),e.newPath&&(t.instrumentedPath=path.resolve(n._instrumentedRoot,e.newPath),t.instrumentedType=_.trim(path.extname(t.instrumentedPath),"."),n._structure.filesRenamed[e.newPath]=t.path),i&&(t.ranges=e.ranges,t.scriptRange=e.scriptRange,t.noScript=e.noScript,t.sourceMap=e.maps&&e.maps[0],t.ranges&&t.ranges.length||t.noScript||debug("Compiler did not set ranges for file [%s]",t.path),t.sourceMap||t.noScript||debug("Compiler did not set source map for file [%s]",t.path))},_instrument:function(e,t,i){var n=this;return i&&n._processorPool.started()?n._processorPool.run({content:e,opts:t,type:"instrumentor"}):Q.fcall(function(){return instrument(e,t)})},_writeSourceFile:function(e,t){var i=this,n=i._sourceFileCache[e];return n&&(n.content=t),i.isZeroConfigJest()||i.isVitest()||!n?i._doWriteFile(e,t):Q.when(!0)},_doWriteFile:function(e,t){var i=this;return i._dirEnsurePromise(path.dirname(e)).then(function(){return i._writeFilePromise(e,t)})},_doWriteFileWithLruCache:function(e,t){var i=this;return i._dirEnsurePromise(path.dirname(e)).then(function(){return i._writeFilePromise(e,t)}).then(function(){return i._lruCache.set(e,t),Q.when(!0)})},_deleteSourceFile:function(e){var t=this;return delete t._sourceFileCache[e],t._unlinkFilePromise(e)},_readOriginalSourceFile:function(e,t){var i=this,n=i._sourceFileCache[t];return n?(trace("Returning previously cached file [%s] from memory",e),Q.when(n.content)):i._readFilePromise(t).then(function(n){var r=Q.when(!0),o=_.keys(i._sourceFileCache);if(o.length>=2){var s=o[0],a=i._sourceFileCache[s];delete i._sourceFileCache[s],i._structure.filesById[a.id]?(r=i._doWriteFile(s,a.content),trace("Writing previously cached file [%s] to disk",s)):trace("Previously cached file [%s] was deleted and does not need saving to disk",s)}return trace("Caching file [%s] in memory",e),i._sourceFileCache[t]={content:n,id:e},r.then(function(){return Q.when(n)})})},_flushSourceFileCacheSync:function(){var e=this;try{_.each(e._sourceFileCache,function(t,i){e._dirEnsureSync(path.dirname(i)),e._writeFileSync(i,t.content)})}catch(t){_.each(e._sourceFileCache,function(t){var i=e._structure.filesById[t.id];i&&(i.ts=0)})}},_getOrCreateFileMetadata:function(e){var t=this,i=t._structure.filesByPath[e.path];if(!i){var n=t._createFileMetadata(e,e.id);return t._fileOrderUpdatePending=!0,n}return i},_getFileMetadataById:function(e){var t=this;return t._structure.filesById[e]},getFileMetadataByPath:function(e){var t=this;return t._structure.filesByPath[e]},_overrideFileType:function(e,t,i){},_createFileMetadata:function(e,t){var i=this;if(!process.env.quokka&&path.resolve(e.path)===path.normalize(e.path).replace(new RegExp(path.sep+"$"),""))throw new Error("Configured file paths must be relative: "+e.path);var n=path.join(i._originalRoot,process.env.quokka?path.basename(e.path):e.path),r=path.join(i._instrumentedRoot,e.path);if(e.instrumentedPath&&r!==e.instrumentedPath){r=e.instrumentedPath,e.instrumentedType=_.trim(path.extname(r),".");var o=path.relative(i._instrumentedRoot,r);o!==e.path&&(i._structure.filesRenamed[o]=e.path)}var s=e.type,a=i._overrideFileType(e.type,e.path,e.id)||e.type,l={id:t,path:e.path,type:a||"js",originalType:e.originalType||s||a,binary:e.binary||void 0,tmp:e.tmp||void 0,instrumentedType:e.instrumentedType||a||"js",order:e.order,originalPath:n,instrumentedPath:r,ts:e.ts,changeTs:e.ts,runnerCacheKey:e.runnerCacheKey,triggersTests:e.triggersTests,include:e.include,initialInclude:_.isBoolean(e.initialInclude)?e.initialInclude:e.include,esm:e.esm,includedTestFile:e.includedTestFile,includedExplicitlyTestFile:e.includedExplicitlyTestFile,smartModeStart:e.smartModeStart,excludedTestFile:e.excludedTestFile,coverable:e.coverable,hideFromErrorStackTrace:e.hideFromErrorStackTrace||void 0,test:e.test,tests:e.tests||{},ranges:e.ranges||void 0,loggedRanges:e.loggedRanges||void 0,extractedComments:e.extractedComments||void 0,notInstrumentedLogMarkers:e.notInstrumentedLogMarkers||void 0,liveCommentLines:e.liveCommentLines||void 0,matchSnapshotRanges:e.matchSnapshotRanges||void 0,lineMap:e.lineMap||void 0,tmpLineMap:e.tmpLineMap||void 0,validSyntax:e.validSyntax||void 0,numberOfFunctions:e.numberOfFunctions||void 0,docBlockComment:e.docBlockComment||void 0,instrumentedByTestingFramework:e.instrumentedByTestingFramework||void 0,childFilePath:e.childFilePath,getFileLineMap:function(){return this.tmpLineMap||this.lineMap}};return i._updateFileStructure(l),l},_deleteTmpFiles:function(){var e=this;this._deleteDependantFilesMetadata(),_.each(e._structure.filesByPath,function(t){return t.tmp&&e._deleteFileMetadata(t)}),e._fileOrderUpdatePending=!0},_deleteDependantFilesMetadata:function(e){var t=this;e?(_.each(e.dependant,function(e){return t._deleteFileMetadata(e)}),e.dependant={}):_.each(t._structure.filesByPath,function(e){return t._deleteDependantFilesMetadata(e)})},_deleteFileMetadata:function(e){var t=this,i=t._structure.filesByPath[e.path];if(i)return t._updateFileStructure(i,!0),t._fileOrderUpdatePending=!0,i},_updateFileStructure:function(e,t){if(t)this._deleteDependantFilesMetadata(e),delete this._structure.filesById[e.id],delete this._structure.testFilesById[e.id],delete this._structure.filesByPath[e.path],delete this._structure.testFileSelectionById.excluded[e.id],delete this._structure.testFileSelectionById.included[e.id];else if(this._structure.filesById[e.id]=e,this._structure.filesByPath[e.path]=e,e.test)if(this._structure.testFilesById[e.id]=e,delete this._structure.testFileSelectionById.included[e.id],delete this._structure.testFileSelectionById.excluded[e.id],e.excludedTestFile)this._structure.testFileSelectionById.excluded[e.id]=e;else{var i=this._settings.testLocations?e.includedExplicitlyTestFile:e.includedTestFile;i&&(this._structure.testFileSelectionById.included[e.id]=e)}},selectedTestFiles:function(){var e=!_.isEmpty(this._structure.testFileSelectionById.included),t=!_.isEmpty(this._structure.testFileSelectionById.excluded);return{hasSomeIncludedTestFiles:e,hasSomeExcludedTestFiles:t}},hasSomeSelectedTestFiles:function(){var e=this.selectedTestFiles();return e.hasSomeIncludedTestFiles||e.hasSomeExcludedTestFiles},isExcludedTestFile:function(e){return!!this._structure.testFileSelectionById.excluded[e]},isIncludedTestFile:function(e){return!!this._structure.testFileSelectionById.included[e]},getIncludedTestFiles:function(){return _.values(this._structure.testFileSelectionById.included)},getNotExcludedTestFiles:function(){var e=this;return _.filter(this._structure.testFilesInOrder,function(t){return!t.originalId&&!e.isExcludedTestFile(t.id)})},_getExcludedTestFiles:function(){return _.values(this._structure.testFileSelectionById.excluded)},_additionalHeaderMessage:function(){var e=this;if(this._settings.testLocations){if(0===this._settings.testLocations.length)return this._settings.smartStart&&this._settings.smartStart.find(function(e){return"**/*"===e.pattern&&e.test&&"edit"===e.startMode})?"(waiting for test to be modified)":"(waiting for test to be opened)";var t=this._settings.testLocations.map(function(t,i){for(var n=t.split("/"),r=function(t){var r=n.slice(n.length-t).join("/");if(!e._settings.testLocations.find(function(e,t){return t!==i&&e.endsWith(r)}))return{value:r}},o=1;o<n.length;o++){var s=r(o);if("object"==typeof s)return s.value}return t}),i="(only executed "+t.map(function(e){return""===e?"./":e}).join(", ")+")";return this._settings.testLocations.length>=2&&i.length>120?"(only executing "+this._settings.testLocations.length+" test files)":i}var n=this.selectedTestFiles();if(this._settings.runSelectedTestsOnly||n.hasSomeIncludedTestFiles||n.hasSomeExcludedTestFiles){var r="";return this._settings.runSelectedTestsOnly&&!n.hasSomeIncludedTestFiles?r="no test files selected":n.hasSomeIncludedTestFiles&&(r="only executed "+_.map(this.getIncludedTestFiles(),function(e){return e.path}).join(", ")),!r&&n.hasSomeExcludedTestFiles&&(r="skipped "+_.map(this._getExcludedTestFiles(),function(e){return e.path}).join(", ")),"("+r+")"}},_updateFileOrder:function(){var e=this;e._fileOrderUpdatePending&&(e._structure.testFilesInOrder=[],e._structure.sourceFilesInOrder=[],_.each(e._orderFilesByConfig(e._structure.filesByPath),function(t){t.test?e._structure.testFilesInOrder.push(t):e._structure.sourceFilesInOrder.push(t)}),delete e._fileOrderUpdatePending)},_orderFilesByConfig:function(e){return _.chain(e).sortBy(function(e){return e.path}).sortBy(function(e){return e.order}).value()},saveLatestQuokkaFileChange:function(e){var t=100,i=3e3,n=path.join(this._globalSettingsDir,"recentFiles"),r=function(e){return path.join(n,e)},o=function(e){return e&&"win32"===process.platform?e.toLowerCase():e};if(e.scratchFile){if(utils.textLines(e.content).length<=1&&e.content.length<50&&(e.content=""),!e.content)return;if(e.content.length>i){try{this._dirEnsureSync(n),this._writeFileSync(r(e.fileId),e.content)}catch(s){}delete e.content}}else delete e.content;var a=path.join(this._globalSettingsDir,"recentFiles.json"),l={};try{this._fileExistsSync(a)&&(l=JSON.parse(this._readFileSync(a)))}catch(s){}l.projects||(l.projects={});var c=o(this._localRoot);e.projectRoot=this._localRoot;var u=l.projects[c]||{};delete l.projects[c],l.projects[c]=u;var h=e.fileId||o(e.path),d=!u[h];for(delete u[h],u[h]=e,d&&(l.total=(l.total||0)+1);l.total>t;)for(var f in l.projects){var p=l.projects[f];if(!_.isEmpty(p)){for(var g in p){var v=p[g];if(delete p[g],l.total--,v.scratchFile&&!v.content)try{this._unlinkFileSync(r(v.fileId))}catch(s){}break}break}delete l[f]}try{this._writeFileSync(a,JSON.stringify(l))}catch(s){}}}),module.exports=Project},{"./babelCompiler":8,"./chromeProfileViewer":11,"./config":14,"./extension/shared/utils":41,"./instrumentor":44,"./processor":61,"./testTask":65,"./tracking":67,"./typeScriptPostprocessor":69,"./typeScriptUtils":70,"./utils":72,"./utils/remapComments":73,child_process:void 0,"lru-cache":void 0,os:void 0,path:void 0,semver:void 0,typescript:void 0,url:void 0,util:void 0}],63:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},l=e("os"),c=e("path"),u=e("http"),h=e("./utils"),d=logger.create("workers").debug,f=e("ws").Server,p=/^win/.test(process.platform),g="&wallabyFileId=",v="Wallaby.js cache is corrupted, please restart wallaby.js",y="Jest cache is corrupted, please clear jest cache (`npx jest --clearCache`) and then restart wallaby.js",m=/.*jasmine\.js:(\d|\s)*throw error;[^\^]*\^\s*/s,b=function(e,t){var i=this;i._project=e,i._opts=e.settings(),i._extension=t,i._mapConsoleMessagesStackTrace=i._project.settings().mapConsoleMessagesStackTrace,process.env.quokka&&(i.reportConsoleOutput=function(t){var i=_.extend({},t);e.resolveLogEntryRange(i),e._emitInternal({type:"consoleOutput",data:i})},i.reportIntermediateResult=function(e){}),i._sessions={},i._executedTestNumber=0,i._testRunId=0,i._workers={},i._testFilesByWorker={},i._workerPingTimeoutOverride={},i._connectingWorkers={},i._workerPendingCleanup={},i._calculateNumberOfParallelWorkers(),i._hasGlobalSetupOrTeardown=this._project.hasGlobalSetupOrTeardown();for(var n=Math.max(i._maxWorkers,i._minWorkers)+(i._hasGlobalSetupOrTeardown?1:0),r=0;r<n;r++)i.getWorker(r);i._globalWorkerId=n,i._normalizedWallabyServerPath=this._project.normalizePath(c.dirname(process.mainModule.filename)),i._normalizedLocalRoot=this._project.normalizePath(this._project._localRoot),i._zeroConfigJest=this._project.isZeroConfigJest(),i._vitest=this._project.isVitest(),i._nodeJasmine=this._project.isNodeJasmine(),i._unresponsiveStandardTimeout=Math.max(500,i._opts.unresponsiveStandardTimeout||(i._zeroConfigJest||i._vitest?2e3:200)),i._unresponsiveInitialTimeout=Math.max(i._unresponsiveStandardTimeout,i._opts.unresponsiveInitialTimeout||(i._zeroConfigJest||i._vitest?7e3:200)),i._longExecutingWarningTimeout=Math.max(500,i._opts.longExecutingWarningTimeout||5e3),i._longExecutingPingTimeout=Math.max(200,i._opts.longExecutingPingTimeout||200),i._globalSetupTeardownTimeout=Math.max(10,i._opts.globalSetupTeardownTimeout||5e3)};b.prototype={"worker:transformedFile":function(e){this._project.testRunnerTransformedFile(e)},"worker:profile":function(e){this._resolveProfileRunPromise&&(this._resolveProfileRunPromise(e),delete this._resolveProfileRunPromise)},start:function(e){var t=this,i=t._httpServer=e?u.createServer(e):u.createServer();return i.listen(0),Q.promise(function(e,n){i.on("listening",function(){try{t._receiverPort=i.address().port,d("Web server is listening at "+t._receiverPort),t._wss=new f({server:i,verifyClient:function(e){return _.verifyLocalOrigin(e.origin)}}),t._wss.on("connection",function(e){e.on("message",function(i){var n;try{n=JSON.parse(i)}catch(r){return void console.error("Failed to deserialize message from worker: "+i+", "+(r&&r.message))}if(t["worker:"+n.type])return t["worker:"+n.type](n.data);if(n.worker){var o=t._workers[n.worker];if(!o)return;if(o.onConnected)o.onConnected(e);else if(process.env.quokka&&o.instance){if(o.instance.channel)try{o.instance.channel.close(),o.instance.channel.removeAllListeners()}catch(r){}o.instance.channel=e}try{e.send(JSON.stringify({type:"in:connected"}))}catch(r){console.error('Failed to send the "connected" message to worker. '+r.message)}}else if(n.session){var s=t._sessions[n.session];s&&n.childSession&&(s=s.childSession(n.session+"."+n.childSession));var a=!s||(s._disposing||t.cancelled(s._testRunId))&&!s._globalSetup;if("console"===n.type&&n.data){if("debugLog"===n.data.type)return void d(n.data.text);(n.data.spec||process.env.quokka)&&!a||"autoLog"===n.data.type||console.log("console."+n.data.type+": "+n.data.text)}if(a)return;try{s[n.type](n.data)}catch(r){console.error("Failed to process message "+n.type+" from worker, "+(r&&r.message)),s.reject(r)}}})}),e()}catch(r){n(r)}})})},wallabyFileIdPrefix:function(){return g},traceContext:function(){return this._traceContext},receiverPort:function(){return this._receiverPort},setFileRoot:function(e){this._fileRoot=this._project.normalizePath(e)},run:function(e){return r(this,void 0,void 0,function(){var t,i,r,s,a,l,c,u,h,f,p,g,v,y,m,b,k,T,S,C;return o(this,function(o){switch(o.label){case 0:if(t=this,t._cancelled=!1,t._testRunId++,t._executedTestNumber=0,t._runPriority=e.priority,t._traceContext=e.traceContext,t._profileRun=e.profileRun,i=0,t._profileRun?(t._profileRunPromise=Q.promise(function(e){t._resolveProfileRunPromise=e}),e.testFilesToLoad&&1===e.testFilesToLoad.length&&(i=t._findWorkerThatExecutedTestFile(e.testFilesToLoad[0])||0)):(delete this._resolveProfileRunPromise,delete this._profileRunPromise),e.recycleBeforeRun&&_.each(t._workers,function(e,i){t.recycleWorker(i)}),d("Starting test run, priority: "+t._runPriority),t._startTime=(new Date).getTime(),r=e.fullRun&&t._maxWorkers>1&&e.testFilesToLoad.length>1?t._maxWorkers:t._minWorkers>1&&e.testFilesToLoad.length>1&&!(e.fullRun&&t._maxWorkers<t._minWorkers)?t._minWorkers:1,s=void 0,!t._hasGlobalSetupOrTeardown||!e.testFilesToLoad.length)return[3,4];a=setTimeout(function(){console.log("Some long running code has been detected: Global Setup")},t._longExecutingWarningTimeout),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t._runGlobalSetup(e)];case 2:return s=o.sent(),clearTimeout(a),[3,4];case 3:if(l=o.sent(),clearTimeout(a),l.error)throw l.error;return[2,l.result];case 4:1===r&&_.each(e.testFilesToLoad,function(e){return t._testFileIsAssignedToWorker(e,i)}),c=n(n({},e),{processEnvUpdates:s&&s.processEnvUpdates}),h=void 0,o.label=5;case 5:return o.trys.push([5,10,11,14]),r>1?[4,t._runInParallel(c,r)]:[3,7];case 6:return f=o.sent(),[3,9];case 7:return[4,t._prepareSandbox(c,i).then(function(e){return t._runTests(e)})];case 8:f=[o.sent()],o.label=9;case 9:return u=f,[3,14];case 10:throw p=o.sent();case 11:return s?(g=setTimeout(function(){console.log("Some long running code has been detected: Global Teardown")},t._longExecutingWarningTimeout),s.sandbox.instance.teardown(),[4,s.result]):[3,13];case 12:if(v=o.sent(),y=v.error,m=v.result,clearTimeout(g),y)throw y;h=m,o.label=13;case 13:return[7];case 14:return t._workerPingTimeoutOverride={},1!==u.length?[3,15]:(k=u[0],[3,17]);case 15:return[4,t._mergeRunTestsResults(u)];case 16:k=o.sent(),o.label=17;case 17:return b=k,h&&(b.log=(b.log||[]).concat(h.log||[]),b.globalErrors=(b.globalErrors||[]).concat(h.globalErrors||[])),t._executedTestNumber&&(t._endTime=(new Date).getTime(),T=t._endTime-t._startTime,S="millisecond(s)",T>1e3&&(T/=1e3,S="second(s)",T>60&&(T/=60,S="minute(s)")),console.log("Finished executing "+t._executedTestNumber+" affected test(s) in "+Math.round(100*T)/100+" "+S)),t._profileRunPromise?(C=b,[4,t._profileRunPromise]):[3,19];case 18:C.profile=o.sent(),delete t._profileRunPromise,o.label=19;case 19:return[2,b]}})})},_handleError:function(e,t,i,n,r,o,s,a,l,c){var u=this;o===s&&(o=s=void 0);var h=u._reportableError(i,n);d("Sandbox (%s) [%s] error: %s",e.active()?"active":"inactive",t,h);var f="SyntaxError: Parse error"===i&&_.isEmpty(n);if(u._corruptedCache(h))return u._project.invalidateCache(),e.reject(new Error(v)),void e.recycleWorker();if(u._corruptedJestCache(i,n))return d("Jest cache corrupted: %s",n),u._project.invalidateCache(),void e.reject(new Error(y));if(process.env.quokka?d("Runtime error: "+h):console.error("Runtime error: "+h),e.active()){if(e.scheduleCompleteIfNotActiveFor(process.env.WALLABY_INTEGRATION_TEST_RUN?1e3:100),!n)return void e.reject(new Error(i));if(!f)try{var p={message:i,stack:_.isString(n)?n:_.reduce(n,function(e,t){return e+t.file+":"+t.line+"\n"},""),external:!0,actual:o,expected:s,snapshot:a};u._nodeJasmine&&(p.message=p.message&&p.message.replace(m,""),p.message.endsWith("\r")&&(p.message=p.message.slice(0,-1)),p.stack=p.stack&&p.stack.replace(m,"")),(u._zeroConfigJest||u._vitest)&&(p.delayStackMapping=!0,p.allowNotMappedStackLines=!0,p.testFilePath=c,e._notMappedStackEntries.push(p));var g=[p];u._processTestLog(g,l),p.delayStackMapping||p.stack&&p.stack.length||!c||(p.stack="Error: "+p.message+".\n    at "+c+":1:0",u._mapStackEntries(p,!0),delete p.testFilePath),p.stack&&p.stack.length||(~p.message.indexOf("Cannot find module")||(p.message=h),p.stack=[]),!r&&e._executingTest?e.addToTestLog(p):e._globalErrors.push(p)}catch(b){e.reject(new Error(i+", "+(b&&b.message)))}}},_createAndStartSession:function(e,t,i,n){var r=this;try{var o=function(){var o=r._createSession(e.sessionId,e.workerId,e.testRunId,e.instance,t,i,n);e.instance.start(function(t){return r.cancelled(e.testRunId)?(o.reject({runCancelled:!0}),!1):"success"===t||(o.reject(new Error("Sandbox load failed, status: "+t)),!1)},function(t,i,n,s){r._handleError(o,e.sessionId,t,i,!1,n,s)})},s=r._workerPendingCleanup[e.workerId];s?(d("[%s] Sandbox is waiting for worker cleanup",e.sessionId),s.onDone.push(function(n){if(r.cancelled(e.testRunId))return d("[%s] Sandbox run was cancelled while it was waiting for worker cleanup",e.sessionId),i({runCancelled:!0});if(n){d("[%s] Sandbox worker requires recycling, creating new session",e.sessionId);try{return t(r._prepareSandbox(e.opts,e.workerId).then(function(e){return r._runTests(e)}))}catch(s){return i(s)}}o()})):o()}catch(a){i(a)}},_getRunTestResult:function(e){if(e.session){var t=e.session,i=t.runResult;return _.each(_.keys(t),function(e){e&&"_"===e[0]&&!_.isFunction(t[e])&&"_disposing"!==e&&delete t[e]}),delete e.session,Q.when(i)}return Q.when(e)},_runTests:function(e){var t=this;return t.cancelled(e.testRunId)?Q.reject({runCancelled:!0}):(d("[%s] Running tests in sandbox",e.name),Q.promise(function(i,n){t.cancelled(e.testRunId)&&n({runCancelled:!0}),t._createAndStartSession(e,i,n,void 0)}).then(function(e){return t._getRunTestResult(e)}))},_createRunResult:function(e,t){var i=this,n=e._coverage,r=e._trace,o=e._loadingSequence,s=e._tests,a=e._log,l=e._fileChanges,c=e._globalErrors.concat(e._executingTestLog);return _.each(c,function(e){return i._removeAnsi(e)}),c.length||(c=void 0),e._notMappedStackEntries.length&&(_.each(e._notMappedStackEntries,function(e){delete e.delayStackMapping,i._mapStackEntries(e,e.allowNotMappedStackLines),e.stack&&e.stack.length||!e.testFilePath||(e.stack="Error: "+e.message+".\n    at "+e.testFilePath+":1:0",i._mapStackEntries(e,!0),delete e.testFilePath),delete e.allowNotMappedStackLines}),e._notMappedStackEntries.length=0),{coverage:n,trace:r,tests:s,log:a,globalErrors:c,loadingSequence:o,time:t,fileChanges:l}},_removeAnsi:function(e){return!h.hasAnsi(e.message)||h.hasAnsi(e.actual)||h.hasAnsi(e.expected)||(e.message=h.removeAnsi(e.message)),e},_reportableError:function(e,t){var i=this;if(_.isString(t)){var n={stack:t};return i._project._cleanStack(n),t=n.stack}return e},cancel:function(e){var t=this;if(!_.isEmpty(t._sessions))return e>=t._runPriority&&(_.each(t._sessions,function(e){e.reject({runCancelled:!0})}),t._cancelled=!0,d("Cancelling test run, cancel requester priority: %s, current run priority: %s",e,t._runPriority),!0)},cancelled:function(e){return this._cancelled||e&&e!==this._testRunId},_areLogEntryMessagesEqual:function(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),e===t||(this._opts.testFramework&&this._opts.testFramework.version&&0===this._opts.testFramework.version.indexOf("mocha")?e.indexOf(":")>0&&_.contains(e,t)||t.indexOf(":")>0&&_.contains(t,e):void 0)},_createSession:function(e,t,i,r,o,l,u,h){var f=this;return f._sessions[e]={_coverage:{},_tests:[],_loadingSequence:{},_log:[],_fileChanges:[],_executingTestLog:[],_globalErrors:[],_total:0,_skipped:0,_disposing:!1,_exceededMaxTestAllowedLogLimit:!1,_onFinished:r.closing,_messagesPerTest:{},_closeByErrorTimeout:0,_longRunningWarningTimeout:0,_longRunningPingTimeout:0,_globalSetupCompleteTimeout:0,_executingFiles:{},_executingTest:void 0,_notMappedStackEntries:[],_globalSetup:!!u,_globalSetupDoneCalled:!1,_completed:!1,_testRunId:i,_parentSession:h,_children:[],childSession:function(e){var n=this;if(f._sessions[e])return f._sessions[e];var o=f._createSession(e,t,i,r,function(){},function(){},void 0,n);return n._children.push(o),o},started:function(t){var i=this;d("[%s] Loaded %s test(s)",e,t.total),i._total=t.total,_.each(t.loadingSequence,function(e){i._loadingSequence[e[0]]=e.slice(1)})},active:function(){var e=this;return!e._disposing&&!f.cancelled(i)},scheduleCompleteIfNotActiveFor:function(e){var t=this;clearTimeout(t._closeByErrorTimeout),t._closeByErrorTimeout=setTimeout(function(){t.complete()},e)},addToTestLog:function(e){var t=this,i=t._executingTestLog[t._executingTestLog.length-1];i&&f._areLogEntryMessagesEqual(i.message||void 0,e.message||void 0)&&i.stack&&e.stack&&i.stack.length>0&&e.stack.length>0&&_.isEqual(e.stack[0],i.stack[0])?e.stack.length>i.stack.length&&(i.stack=e.stack):t._executingTestLog.push(e)},intermediateComplete:function(){var e=this;e._parentSession||f.reportIntermediateResult&&f.reportIntermediateResult(f._createRunResult(e))},trace:function(e){var t=this;t._trace=e.trace,t._trace&&_.each(t._trace.callStack,function(e){e.delayStackMapping=!0,t._notMappedStackEntries.push(e)})},complete:function(t){var n=this;if(clearTimeout(n._closeByErrorTimeout),clearTimeout(n._longRunningWarningTimeout),clearTimeout(n._longRunningPingTimeout),clearTimeout(n._globalSetupCompleteTimeout),n._completed=!0,!n._parentSession){n._children.length&&n._children.forEach(function(e){e.runResult=f._createRunResult(e,t&&t.time),e.complete()}),n._onFinished();var r=n._children.map(function(e){return e.runResult}).filter(function(e){return!!e}),c=n._children.length?n._children.reduce(function(e,t){return e+(t._tests||[]).length},0):(n._tests||[]).length,u=n._children.length?n._children.reduce(function(e,t){return e+t._skipped},0):n._skipped;n._dispose(function(){f.cancelled(i)?l({runCancelled:!0}):(n._children.length?n.runResult=f._reduceTestResults(a([f._createRunResult(n,t&&t.time)],s(r),!1)):n.runResult=f._createRunResult(n,t&&t.time),o({session:n,time:t&&t.time}))}),d("[%s] Run %s test(s), skipped %s test(s)",e,c-u,u)}},globalSetupComplete:function(e){var t=this;u&&(t._globalSetupDoneCalled=!0,u(e))},globalError:function(t){var i=this;return i._parentSession?void i._parentSession.globalError(t):void f._handleError(i,e,t.message,t.stack,t.declaration,t.actual,t.expected,t.snapshot,t.allowNotMappedStackLines,t.testFilePath)},programScopeStart:function(e){var t=this;t._executingFiles[e]=1,t._setTimeoutForLongRunningOperation()},programScopeEnd:function(e){var t=this;delete t._executingFiles[e],_.isEmpty(t._executingFiles)&&!t._executingTest&&(clearTimeout(t._longRunningWarningTimeout),clearTimeout(t._longRunningPingTimeout))},preTest:function(e){var t=this;t._setTimeoutForLongRunningOperation(),t._executingTest=e},postTest:function(){var e=this;delete e._executingTest},_setTimeoutForLongRunningOperation:function(){if(!process.env.quokka){var e=this,t=function(e){console.warn(e),d(e)};clearTimeout(e._longRunningWarningTimeout),clearTimeout(e._longRunningPingTimeout),e._longRunningWarningTimeout=setTimeout(function(){var i="Some long running code has been detected: ",n=e._executingTest,o=!_.isEmpty(e._executingFiles);if(i+=(n?'test "'+n+'"':"one of your "+(o?"files":"tests"))+" is taking more than "+f._longExecutingWarningTimeout+"ms to execute.",o&&(i+="\nExecution of the following files has started but has not finished:",_.each(e._executingFiles,function(e,t){var n=f._project._getFileMetadataById(t);i+="\n- "+(n?n.path:"unknown")})),e._log.length&&(i+="\nThe last recorded console.log: "+_.last(e._log).text),n||o){i+="\nTry commenting out the test or excluding the test file from the `tests` list in your wallaby config,\nand restarting wallaby to make sure that it is this test/file causing the issue and not something else.",n&&(i+="\nAlso review your recent changes to the code that the test covers, as well as its `before` and `after` hooks."),i+="\nPinging test runner sandbox...";try{r.ping(function(){clearTimeout(e._longRunningPingTimeout),e.active()&&t("Sandbox is responsive. The issue may be asynchronous in nature (for example, a missing callback).")}),e._longRunningPingTimeout=setTimeout(function(){t("The sandbox is not responsive. Check for possibly recently introduced infinite loops.")},f._longExecutingPingTimeout)}catch(s){i+="\nThe sandbox ping failed: "+s.message}}t(i)},f._longExecutingWarningTimeout)}},module:function(e){var t=this;f._project._emitInternal({type:"moduleLoaded",path:e.path,session:t})},test:function(t){var i=this;return delete i._executingTest,clearTimeout(i._closeByErrorTimeout),i._setTimeoutForLongRunningOperation(),t.hook&&t.log?(f._processTestLog(t.log),_.isString(t.hook)&&_.each(t.log,function(e){e.message=t.hook+(e.message?": ":"")+e.message}),void(i._globalErrors=i._globalErrors.concat(t.log))):("disabled"!==t.status?(d("[%s] Test executed: "+t.name,e),f._processTestLog(t.log),t.log&&_.each(t.log,function(e){return i.addToTestLog(e)}),i._executingTestLog.length&&(t.log=i._executingTestLog.slice()),_.isUndefined(t.slow)&&(t.slow=t.time>f._opts.slowTestThreshold),t.slow=t.slow||void 0,i._executingTestLog.length=0,++f._executedTestNumber%50||console.log("Execution progress: "+f._executedTestNumber+" tests"),process.env.WALLABY_INTEGRATION_TEST_RUN&&(t.time=1)):(i._skipped++,f._processTestLog(t.log)),void i._tests.push(t))},coverage:function(e){var t=this;t._coverage[e.id]=e.ranges},fileChange:function(e){var t=this;t._fileChanges.push(e)},console:function(e){var t=this,i=f._opts.maxConsoleMessagesPerTest,r=t._messagesPerTest[e.spec]=(t._messagesPerTest[e.spec]||0)+1;if(r===i+1)console.warn("Number of console messages per test exceeded maximum allowed value ("+i+"), current test console messages recording stopped.\nYou may increase the limit by adding `maxConsoleMessagesPerTest` setting to your config file.");else if(r<=i)if(t._log.push(e),e.valueBag&&e.valueBag.data&&e.valueBag.data.props){var o=e.valueBag.data,s=o.props[0];if(s.callStack){f._mapStackEntries(s.callStack);var a;if(s.callStack.replaceFirstEntryLine){var l=n({},e);
f._project.resolveLogEntryRange(l),a=l.range&&l.range[0]}s.props=s.callStack.stack.map(function(e,t){var i=e[0],n=t>0||!a?e[1]:a,r=f._project.stackEntryByFileIdWithoutLineMapping(i,n);if(r){var o=s.callStack.context[t]||"...";return{id:s.id+",se"+t,target:r,callStackEntryNode:!0,label:{name:o,description:c.basename(r.file)+":"+n},disallowToCopyPath:!0,disallowToCopyData:!0}}}).filter(function(e){return!!e})}}else if(f._mapConsoleMessagesStackTrace&&e.text&&e.text.length){var u=/^\s*at .*$/gm;if(u.test(e.text)){var h={stack:e.text,suppressErrorReporting:!0};if(f._mapStackEntries(h),h.stack.length){var d=!1;e.text=e.text.split("\n").reduce(function(e,t){if(t.trimStart().startsWith("at ")){if(!d){var i=t.substr(0,t.indexOf("at "));h.stack.map(function(t,n){var r=t[0],o=t[1],s=f._project.stackEntryByFileIdWithoutLineMapping(r,o);if(s){var a=h.context[n]||"...";e.push(i+"at "+a+" ("+c.basename(s.file)+":"+o+")")}}),d=!0}}else e.push(t);return e},[]).join("\n")}}}f.reportConsoleOutput(e)},resume:function(){var e=this;d("Sandbox requested early screen shot capture"),e._onFinished(),e._onFinished=_.noop,r.resume()},reject:function(e){var t=this;t._parentSession||t._disposing||t._dispose(function(){l(f.cancelled(i)?{runCancelled:!0}:e)})},recycleWorker:function(){var e=this;e._parentSession||f.recycleWorker(t)},_dispose:function(i){var n=this;if(n._disposing=!0,clearTimeout(n._closeByErrorTimeout),clearTimeout(n._longRunningWarningTimeout),clearTimeout(n._longRunningPingTimeout),!n._parentSession){var o=f._workerPendingCleanup[t]={onDone:[]},s=!1,a=!1,l=function(n){a=!0,s&&clearTimeout(s),delete f._sessions[e],o.onDone&&(o.onDone.forEach(function(e){return e(n)}),o.onDone.length=0),delete f._workerPendingCleanup[t],i()},c=function(){a||(d("[%s] Sandbox is not responsive, recycling worker instance",e),f._tryClosingSandbox(r.close,e),f.recycleWorker(t),l(!0))};if(!n._globalSetup||n._completed||void 0!==f._opts.globalSetupTeardownTimeoutRecycle&&!f._opts.globalSetupTeardownTimeoutRecycle)if(n._globalSetup&&n._completed&&!n._globalSetupDoneCalled)console.error("[%s] Error running Global Setup, recycling worker.",e),c();else if(n._globalSetup&&n._completed&&n._globalErrors.length>0)console.error("[%s] Error running Global Teardown, recycling worker.",e),c();else try{var u=f._workerPingTimeoutOverride[t]||f._unresponsiveStandardTimeout;s=setTimeout(function(){c()},u),r.ping(function(){if(!a){clearTimeout(s),d("[%s] Sandbox is responsive, closing it",e);var t=setTimeout(function(){console.error("[%s] Wallaby Teardown did not complete in %sms, recycling worker.",e,f._globalSetupTeardownTimeout),c()},f._globalSetupTeardownTimeout);f._tryClosingSandbox(r.close,e,function(e){a||(clearTimeout(t),e?l():c())})}})}catch(h){return d("[%s] Sandbox can not be pinged: %s",e,h&&h.message),void c()}else console.log("[%s] Global Setup and Teardown is not complete, waiting for %sms before recycling worker",e,f._globalSetupTeardownTimeout),n._globalSetupCompleteTimeout=setTimeout(function(){console.error("[%s] Global Setup and Teardown did not complete, recycling worker.",e),c()},f._globalSetupTeardownTimeout)}}}},_tryClosingSandbox:function(e,t,i){i=i||function(){};try{e(i)}catch(n){d("[%s] Sandbox closing error, %s",t,n.message)}},_corruptedCache:function(e){return e&&e.match(/evaluating '[a-z]\.\$_\$coverage\[/)},_corruptedJestCache:function(e,t){if(this._zeroConfigJest&&e&&"string"==typeof e&&t&&"string"==typeof t&&~e.indexOf("Cannot read property '0' of undefined")){var i=t.split("\n").map(function(e){return e.trim()});if(i.length>1&&~i[1].toLowerCase().indexOf("server.js"))return!0}return!1},_processTestLog:function(e,t){var i=this;_.each(e,function(e){var n=e.message&&e.message.indexOf(" in file:///")||-1;~n&&(e.message=e.message.substring(0,n)),i._corruptedCache(e.message)&&(i._project.invalidateCache(),e.message=v),i._removeAnsi(e),i._mapStackEntries(e,t),process.env.quokka&&e.message&&(e.message=e.message.replace(i._normalizedLocalRoot,".").replace(i._project._localRoot,"."))})},_mapStackEntries:function(e,t){var i=this,n=g.length;if(e.stack&&_.isString(e.stack)&&!e.delayStackMapping){var r,o,a=[],l={},c=e.stack.split("\n");if(c&&i._corruptedCache(c[0])&&(i._project.invalidateCache(),e.message=v),_.each(c,function(e){var c=e.lastIndexOf(g);if(~c){var u=e.substr(c+n).split(":");if(u.length>=2){var d=parseInt(u[1],10);r=i._project.stackEntryByFileId(parseInt(u[0],10)||u[0],d,parseInt((u[2]||"").replace(/\(/,""),10)),r&&r.line?(o=i._extractBrowserStackLineContext(e),o&&(l[a.length]=o),a.push([r.file,r.line])):r&&t&&a.push([r.file,d])}}else if(process.env.quokka){if(process.env.quokka){var f=e.indexOf("file:")!==-1;if(e=i._project.normalizePath(e),f){var p=e.split("?session=");if(p.length>1){var v=p[1].split(":");3===v.length&&(v[0]=""),e=p[0]+v.join(":")}}if(_.contains(e,i._normalizedWallabyServerPath)){if(_.contains(e,"quokkaStackTraceMarker"))return!1}else{var y,m,b=e;e=e.replace(i._normalizedLocalRoot,".");var k;if(b!==e?(k=b.lastIndexOf(i._normalizedLocalRoot),F=e.substr(k).split(":")):(k=e.lastIndexOf("(")+1,0!==k?F=e.substring(k,e.lastIndexOf(")")-1).split(":"):(k=e.lastIndexOf("at ")+3,F=2!==k?e.substr(k).split(":"):[])),3===F.length){o=i._extractNodeStackLineContext(e,k);var T=parseInt(F[1],10);r=i._project.stackEntryByFilePath(i._project.normalizePath(h.isLevelUpRelativePath(F[0])?F[0]:_.ltrim(F[0],"./")),T,parseInt(F[2],10)),r&&r.line?(y=r.file,m=r.line):!r||r&&!r.file?(y=F[0],m=T):r&&t&&(y=r.file||F[0],m=T),y&&(o&&(l[a.length]=o),a.push([y,m]))}}}}else{if(e.indexOf("file://")!==-1){var S=s(e.split("?update="),2),C=S[0],L=S[1];if(C&&L){var j=s(L.split("&wallaby=true"),2),w=j[1];w&&(e=decodeURI(C).replace("file://","")+w)}}e=i._project.normalizePath(e);var x=i._fileRoot?e.lastIndexOf(i._fileRoot):-1;if(~x){var F=_.rtrim(e.substr(x+i._fileRoot.length),")").split(":");if(3===F.length||2===F.length){var d=parseInt(F[1],10);r=i._project.stackEntryByFilePath(i._project.normalizePath(_.ltrim(F[0],"/")),d,parseInt(F[2],10)),r&&r.line?(o=i._extractNodeStackLineContext(e,x),o&&(l[a.length]=o),a.push([r.file,r.line])):r&&t&&d>0&&a.push([r.file,d])}}}}),a.length||e&&e.suppressErrorReporting||d("Failed to map the stack to user code, entry message: %s, stack: %s",e.message&&e.message.substring(0,1024),e.stack.substring(0,1024)),e.message=i._project._cleanMessage(e.message),"node"===i._project.settings().env.type&&e.message&&~e.message.indexOf("Cannot find module")&&(e.message=i._project._cleanMessage(e.message,i._project._root)),e.message&&e.message.startsWith("TestingLibraryElementError")){var u=s(e.message.split("\n\nIgnored nodes: comments, <script />, <style />\n")),f=u[0],p=u.slice(1);if(f&&p)e.formattedMessage={header:{content:f,format:"error"},body:{content:p.join("\n\n"),format:"html"}};else{var y=s(e.message.split("\n\n")),m=y[0],b=y.slice(1);m&&b&&(e.formattedMessage={header:{content:m,format:"error"},body:{content:b.join("\n\n"),format:"html"}})}}e.stack=a,_.isEmpty(l)||(e.context=l),e.stackMapped=!0}},_extractNodeStackLineContext:function(e,t){if(t>4&&"("===e[t-1]){var i=e.substr(0,t-2)||"";return i.split("at ")[1]}},_extractBrowserStackLineContext:function(e){var t=e.split(" (http");return t.length>=2?(t[0]||"").split("at ")[1]:(t=e.split("@http"),t.length>=2?t[0]:void 0)},_runGlobalSetup:function(e){return r(this,void 0,void 0,function(){var t,i,s,a,l=this;return o(this,function(c){switch(c.label){case 0:return t=this,i=void 0,s=void 0,a=!1,[4,t._prepareSandbox(n(n({},e),{runGlobals:!0}),t._globalWorkerId)];case 1:return i=c.sent(),[2,new Promise(function(e,n){s=new Promise(function(c){t._createAndStartSession(i,function(e){return r(l,void 0,void 0,function(){var i;return o(this,function(r){switch(r.label){case 0:return[4,t._getRunTestResult(e)];case 1:return i=r.sent(),a?c({result:i}):n({result:i}),[2]}})})},function(e){a?c({error:e}):n({error:e})},function(t){a=!0,e({result:s,sandbox:i,processEnvUpdates:t})})})})]}})})},_reduceTestResults:function(e){return _.reduce(e,function(e,t){e.runCancelled=t.runCancelled||e.runCancelled,e.tests=e.tests.concat(t.tests||[]),e.log=e.log.concat(t.log||[]),e.fileChanges=e.fileChanges.concat(t.fileChanges||[]),e.globalErrors=e.globalErrors.concat(t.globalErrors||[]),e.error=t instanceof Error||e.error,e.loadingSequence=_.extend(e.loadingSequence,t.loadingSequence||{}),e.trace=e.trace||t.trace;var i=e.coverage;return _.isEmpty(i)?(e.coverage=t.coverage,e):(_.each(t.coverage,function(e,t){var n=i[t];return n?void _.each(e,function(e,t){var i=n[t];return i?void _.extend(i,e):void(n[t]=e)}):void(i[t]=e)}),e)},{coverage:{},tests:[],log:[],globalErrors:[],loadingSequence:{},trace:void 0,fileChanges:[]})},_mergeRunTestsResults:function(e){var t=this;d("Merging parallel test run results");var i=t._reduceTestResults(e);return i.runCancelled?Q.reject(i):i.error?Q.reject(i.error):Q.when(i)},_findWorkerThatExecutedTestFile:function(e){var t;return _.each(this._testFilesByWorker,function(i,n){if(i[e.normalizedRelativePath])return t=n,!1}),t},_testFileIsAssignedToWorker:function(e,t){var i=this._testFilesByWorker[t]=this._testFilesByWorker[t]||{};i[e.normalizedRelativePath]||(this._workerPingTimeoutOverride[t]=this._unresponsiveInitialTimeout,i[e.normalizedRelativePath]=!0)},_unassignAllTestFilesFromWorker:function(e){this._testFilesByWorker[e]={}},_runInParallel:function(e,t){var i=this,n=e.testFilesToLoad,r={};d("Distributing tests between %s workers",t);for(var o=0;o<t;o++){var s=_.omit(e,"testFiles");s.testFilesToLoad=[],r[o]={opts:s,workerId:o,ranges:0}}return _.each(n,function(e){var t=_.chain(r).sortBy(function(e){return e.ranges}).sortBy(function(e){return e.opts.testFilesToLoad.length}).value()[0];t.opts.testFilesToLoad.push(e),t.ranges+=e.rangesLength,i._testFileIsAssignedToWorker(e,t.workerId)}),d("Running tests in parallel"),Q.all(_.chain(r).filter(function(e){return e.ranges||e.opts.testFilesToLoad.length}).map(function(e){return i._prepareSandbox(e.opts,e.workerId).then(function(e){return i._runTests(e)})}).value())},_prepareSandbox:function(e,t){var i=this._testRunId;return this._extension.prepare(e,t).then(function(t){return t.testRunId=i,t.opts=e,t})},getWorker:function(e){var t=this,i=t._workers[e];return i||(i=t._workers[e]={id:e,promise:Q.promise(function(i,n){var r=t._workers[e];if(r)if(r.instance){if(t._extension.healthy(r.instance))return void i(r);d("Found inactive run worker instance #%s, recycling",e),t.recycleWorker(e)}else if(r.promise)return r.promise;d("Starting run worker instance #"+e);try{t._extension.create(e,function(r){if(!r)return void n(new Error("Failed to create worker instance"));var o=t._workers[e]=t._workers[e]||{id:e};if(r.onConnected){o.onConnected=_.bind(r.onConnected,o),delete r.onConnected;var s,a;o.promise=Q.promise(function(e,t){s=e,a=t});var l=!1,c=setTimeout(function(){if(!l){u();var i=t._workers[e];i&&i._connected?t._extension.recycle(r):t.recycleWorker(e),d("Worker is not created in time, recycling it"),a&&a({runCancelled:!0,rerun:!0}),n({runCancelled:!0,rerun:!0})}},1e4),u=function(){l=!0,clearTimeout(c)},h=t._connectingWorkers[e];h&&t._extension.recycle(h),t._connectingWorkers[e]=r,o.onConnected(function(n){delete t._connectingWorkers[e],l||(u(),d("Started run worker instance (delayed) #"+e),o.instance=r,o._connected=!0,r.channel=n,o.promise=Q.when(r),s&&s(r),i(r))})}else d("Started run worker instance (immediate) #"+e),o.instance=r,o.promise=Q.when(r),i(r)})}catch(o){n(o)}})}),i.promise},reportConsoleOutput:function(e){},recycleWorker:function(e){this._unassignAllTestFilesFromWorker(e);var t=this;try{var i=t._workers[e];i&&i.instance&&(d("Recyling run worker instance #%s",e),t._extension.recycle(i.instance))}catch(n){d("Error while recycling run worker instance #%s: %s",e,n&&(n.stack||n.message))}finally{delete t._workers[e],delete t._workerPendingCleanup[e]}},stop:function(){var e=this;_.each(e._workers,function(t,i){e.recycleWorker(i)});try{e._wss&&e._wss.close()}catch(t){}try{e._httpServer&&e._httpServer.close()}catch(t){}},_calculateNumberOfParallelWorkers:function(){var e=this;e._maxWorkers=Math.max(1,e._opts.workers.initial||Math.max(l.cpus().length-2,2)),p&&!e._opts.workers.initial&&"phantomjs"===e._opts.env.kind&&(e._maxWorkers=Math.min(16,e._maxWorkers)),e._minWorkers=Math.max(1,e._opts.workers.regular||Math.max(Math.floor(e._maxWorkers/2),2)),d("Parallelism for initial run: %s, for regular run: %s",e._maxWorkers,e._minWorkers)}},t.exports=b},{"./utils":72,http:void 0,os:void 0,path:void 0,ws:void 0}],64:[function(e,t,i){t.exports={initServerOptions:function(t){var i=e("graceful-fs"),n=e("fs-extra");t.runnerResolver=function(t,i){return e("browser"===t?"electron"===i?"./electronRunner.js":"chrome"===i?"./chromeRunner.js":"./phantomRunner.js":"./nodeRunner.js")},t.processorPool=e("./processPool"),t.fileStructureCachePromise=function(e){return Q.nfcall(i.readFile,e).then(function(e){return Q.when(JSON.parse(e))})},t.fileStatPromise=function(e){return Q.nfcall(i.stat,e)},t.readFilePromise=function(e){return Q.nfcall(i.readFile,e)},t.writeFilePromise=function(e,t){return Q.nfcall(i.writeFile,e,t)},t.unlinkFilePromise=function(e){return Q.nfcall(i.unlink,e)},t.unlinkFileSync=function(e){return i.unlinkSync(e)},t.writeFileSync=function(e,t){return i.writeFileSync(e,t)},t.readFileSync=function(e){return i.readFileSync(e).toString("utf8")},t.fileExistsSync=function(e){return i.existsSync(e)},t.realpathSync=function(e){return i.realpathSync(e)},t.dirRemovePromise=function(e){return Q.nfcall(n.remove,e)},t.dirRemoveSync=function(e){return n.removeSync(e)},t.dirEnsurePromise=function(e){return Q.nfcall(n.ensureDir,e)},t.dirEnsureSync=function(e){return n.ensureDirSync(e)},t.copySync=function(e,t){return n.copySync(e,t)},t.nodeModulesLookup=e("./utils").nodeModulesLookup}}},{"./chromeRunner.js":12,"./electronRunner.js":40,"./nodeRunner.js":46,"./phantomRunner.js":48,"./processPool":60,"./utils":72,"fs-extra":void 0,"graceful-fs":void 0}],65:[function(e,t,i){"use strict";var n={testRunPriority:1,fileChangePriority:2,fullRunPriority:3},r=logger.create("testTask").debug,o=function(){function e(e){this._filesAndAffectedTests={},this._failingTests={},this._tests=[],this._priority=0,this._project=e,this._singleChangeTests=[]}return e.prototype.files=function(){return _.reduce(this._filesAndAffectedTests,function(e,t){return e[t.file.id]=t.file,e},{})},e.prototype.tests=function(){return this._tests},e.prototype.hasAnyFiles=function(){return _.keys(this._filesAndAffectedTests).length>0},e.prototype.addTests=function(e){this._tests=this._tests.concat(e)},e.prototype.addTestFileWithGlobalError=function(e){this._testFilesWithGlobalErrors=this._testFilesWithGlobalErrors||{},this._testFilesWithGlobalErrors[e]=!0},e.prototype.addChangedFile=function(e,t){this._mergeAffectedTests(e.id,{file:e,tests:t,testFilesLoadedFrom:e.testFilesLoadedFrom})},e.prototype.setTestRunPriority=function(){this._priority=n.testRunPriority},e.prototype.setFileChangeRunPriority=function(){this._priority=n.fileChangePriority},e.prototype.setFullRunPriority=function(){this._priority=n.fullRunPriority},e.prototype.setEditorRequestedRun=function(){this._editorRequestedRun=!0},e.prototype.setEvaluatedExpressionRun=function(){this._editorRequestedRun=!0},e.prototype.setInitialTraceRun=function(e){this._initialTraceRun=e,this._editorRequestedRun=!0},e.prototype.setProfileRun=function(e){this._profileRun=e,this._editorRequestedRun=!0},e.prototype.setCodeClipSharingRun=function(e){this._codeClipSharingRun=e,this._editorRequestedRun=!0},e.prototype.setRegularTraceRunTest=function(e){this._traceTest=e},e.prototype.setManuallyRequestedRun=function(){this._manuallyRequestedRun=!0},e.prototype.setUpdateSnapshotsRun=function(){this._updateSnapshotsRun=!0},e.prototype.getFullRunPriority=function(){return n.fullRunPriority},e.prototype.getPriority=function(){return this._priority},e.prototype.isFullRun=function(){return this._priority===n.fullRunPriority},e.prototype.isFileChangedRun=function(){return this._priority===n.fileChangePriority},e.prototype.isManualRun=function(){return(this._priority===n.testRunPriority||this._manuallyRequestedRun)&&!this._editorRequestedRun},e.prototype.isEditorRequestedRun=function(){return this._priority===n.testRunPriority&&this._editorRequestedRun},e.prototype.initialTraceRunData=function(){return this._initialTraceRun},e.prototype.isInitialTraceRun=function(){return!!this._initialTraceRun},e.prototype.isProfileRun=function(){return!!this._profileRun},e.prototype.profileRunData=function(){return this._profileRun},e.prototype.isCodeClipSharingRun=function(){return!!this._codeClipSharingRun},e.prototype.codeClipSharingRunData=function(){return this._codeClipSharingRun},e.prototype.isUpdateSnapshotsRun=function(){return!!this._updateSnapshotsRun},e.prototype.isRegularTraceRun=function(){return!!this._traceTest},e.prototype.filesAdded=function(){this._anyFilesAdded=!0},e.prototype.filesNotAdded=function(){delete this._anyFilesAdded},e.prototype.filesDeleted=function(){this._anyFilesDeleted=!0},e.prototype.filesNotDeleted=function(){delete this._anyFilesDeleted},e.prototype.anyFilesAdded=function(){return this.isFullRun()||this._anyFilesAdded},e.prototype.anyFilesDeleted=function(){return this._anyFilesDeleted},e.prototype.mergeTask=function(e){var t=this;t._priority=Math.max(t._priority,e._priority),_.each(e._filesAndAffectedTests,function(e,i){t._mergeAffectedTests(i,e)}),t._failingTests=_.extend({},e._failingTests,t._failingTests),t._tests=t._tests.concat(e._tests),t._testFilesWithGlobalErrors=_.extend({},e._testFilesWithGlobalErrors||{},t._testFilesWithGlobalErrors||{}),t._singleChangeTests=t._singleChangeTests.concat(e._singleChangeTests),t._anyFilesAdded=t._anyFilesAdded||e._anyFilesAdded,t._anyFilesDeleted=t._anyFilesDeleted||e._anyFilesDeleted},e.prototype._mergeAffectedTests=function(e,t){var i=this,n=i._filesAndAffectedTests[e];n?(n.tests=n.tests?n.tests.concat(t.tests):t.tests,n.testFilesLoadedFrom=_.extend(n.testFilesLoadedFrom||{},t.testFilesLoadedFrom||{})):i._filesAndAffectedTests[e]=t},e.prototype.failingTest=function(e,t){var i=this._failingTests[e]=this._failingTests[e]||[];i.push(t)},e.prototype._getAllTests=function(){var e=this,t=this,i=[];if(this._traceTest)i=[this._traceTest];else{var n=!1,o={},s={},a=0,l=0,c=0,u=0,h=0;if(_.each(t._filesAndAffectedTests,function(r){var l=r.file;r.tests=_.map(r.tests,function(e){var i=t._getTestFileId(e);return o[i]||(o[i]=1,a++),r.testFilesLoadedFrom&&r.testFilesLoadedFrom[i]||l.numberOfFunctionsChanged||l.lastChangeIsComplex||l.relatedFilesWithTests?[e[0]]:e}),l.test&&(n=!0);var c=l.test&&l.lastSingleChangeTest&&!l.relatedFilesWithTests&&!t._project.hadGlobalErrorsPreviousRun();c&&e._singleChangeTests.push([l.id,"?",l.lastSingleChangeTest]),i=i.concat(c?e._singleChangeTests:r.tests),_.extend(s,r.testFilesLoadedFrom||{})}),_.each(t._tests,function(e){var i=t._getTestFileId(e);o[i]||(o[i]=1,l++)}),i=i.concat(t._tests),this.isFileChangedRun()&&_.each(this._testFilesWithGlobalErrors,function(e,t){t=parseInt(t,10),o[t]||(o[t]=1,i.push([t]))}),_.each(s,function(e,t){t=parseInt(t,10),o[t]||(o[t]=1,i.push([t]),u++)}),!i.length&&t._project._lastAffectedTestFileIds&&t._project.hasAnyPendingInEditorFileChanges()&&(i=i.concat(_.map(t._project._lastAffectedTestFileIds,function(e){return o[e]||(o[e]=1,c++),[e]}))),!(n&&1===_.size(t._filesAndAffectedTests)||t.isManualRun()||t.isInitialTraceRun()||t.isRegularTraceRun()||t.isProfileRun())){var d=[],f={};_.each(i,function(e){var i=t._getTestFileId(e);if(!f[i]){var n=t._failingTests[i];n&&(d=d.concat(n),o[i]=1,f[i]=1,h++)}}),i=i.concat(d)}r("Test files from affected: %s, from deleted or manually requested: %s, from recently changed: %s, from loaded by: %s, from failing: %s",a,l,c,u,h)}this._project.settings().runAllTestsInAffectedTestFile&&_.each(i,function(e){e&&(e.length=1)});var p=this._project.selectedTestFiles();return this._project.settings().runSelectedTestsOnly&&!p.hasSomeIncludedTestFiles?i=[]:(p.hasSomeIncludedTestFiles||p.hasSomeExcludedTestFiles)&&(i=_.filter(i,function(e){var i=t._getTestFileId(e);return(!p.hasSomeExcludedTestFiles||!t._project.isExcludedTestFile(i))&&(!p.hasSomeIncludedTestFiles||t._project.isIncludedTestFile(i))}),r("Running only selected or not excluded tests")),i},e.prototype.testData=function(){return this._getTestRunData()},e.prototype._getTestRunData=function(){var e=this;if(this.isFullRun()){var t=this._project.selectedTestFiles();if(this._project.settings().runSelectedTestsOnly&&!t.hasSomeIncludedTestFiles)return;if(t.hasSomeIncludedTestFiles)return{files:_.reduce(e._project.getIncludedTestFiles(),function(e,t){return e[t.id]=t,e},{}),names:"*"};if(t.hasSomeExcludedTestFiles)return{files:_.reduce(e._project.getNotExcludedTestFiles(),function(e,t){return e[t.id]=t,e},{}),names:"*"}}else{var i=e._getAllTests();if(i){var n={},r={};return _.each(i,function(t){var i=n,o=e._getTestFileId(t);if(o){var s=e._project._structure.testFilesById[o];if(s&&(r[s.id]=s,1===t.length&&(n="*"),"*"!==n))for(var a=1,l=t.length;a<l;a++){var c=t[a],u=i[":"+c],h=a===l-1;if(u&&!h||(u=i[":"+c]=h?"*":{}),"*"===u)break;i=u}}}),{files:r,names:n}}}},e.prototype._getTestFileId=function(e){var t=e&&e[0];if(t)return _.isNumber(t)?t:(this._project._structure.filesByPath[t]||{}).id},e}();t.exports={TestTask:o,runPriority:n}},{}],66:[function(e,t,i){!function(e){for(var t=["alert","confirm","prompt"],i=0;i<t.length;i++){var n=t[i];e[n]&&~e[n].toString().indexOf("[native code]")&&(e[n]=function(){})}e.addEventListener&&(e.addEventListener("beforeunload",function(){if(!(e.$_$tracer&&e.$_$tracer._finished||e.navigator&&e.navigator.userAgent&&!/PhantomJS/.test(e.navigator.userAgent)&&!/Electron/.test(e.navigator.userAgent)&&!e.$_$tracer._startRequested)&&e.$_$throwOnBeforeunload)throw new Error("One of your tests is trying to unload window object.")}),e.$_$reportUnhanledPromises&&e.addEventListener("unhandledrejection",function(e){if(e&&e.reason){var t=new Error;throw e.reason.stack&&(t.stack=e.reason.stack),t.message="Unhandled promise rejection: "+(e.reason.message||e.reason),t}}));try{e.Error.stackTraceLimit=80}catch(r){}var o,s=/%[sdjc%]/g,a=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*$/,l=/^(0|[1-9][0-9]*)$/,c=/'([^\\']|\\')*'/,u=/\s?<!doctype html>|(<html\b[^>]*>|<body\b[^>]*>|<x-[^>]+>)+/i,h=/<\/?[a-z][\s\S]*>/i;try{h=new RegExp(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"].map(function(e){return"<"+e+"\\b[^>]*>"}).join("|"),"i")}catch(r){}"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},r=function(){return i.apply(this instanceof n?this:e||{},t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype||{},r.prototype=new n,r});var d=function(){var t=this;t._noOp=function(){},t._maxLogEntrySize=e.$_$maxLogEntrySize||16384,t._maxTraceSteps=e.$_$maxTraceSteps||999999,t._evaluatedExpressionPerRangeLimit=10,t._evaluatedProxyExpressionPerRangeLimit=300,t._undefined=e.undefined,t._setTimeout=e.setTimeout,t._Date=e.Date,t._Error=e.Error,t._Symbol=e.Symbol,t._JSONStringify=JSON.stringify,t._XMLHttpRequest=e.XMLHttpRequest,t._regExpToString=RegExp.prototype.toString,t._dateToString=Date.prototype.toString,t._HTMLAllCollection=e.HTMLAllCollection,t._getOwnPropertyNames=Object.getOwnPropertyNames,t._getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,t._pauseAfterSingleTestExecution=e.navigator&&e.navigator.userAgent&&/PhantomJS/.test(e.navigator.userAgent),t._replacedConsoleLog=e.console.log=function(){t._suppressConsoleLog||t._doWhenReceiverIsReady(function(e){t._log.apply(t,e)},arguments)},e.console.warn=function(){t._doWhenReceiverIsReady(function(e){t._warn.apply(t,e)},arguments)},e.console.error=function(){t._doWhenReceiverIsReady(function(e){t._error.apply(t,e)},arguments)},e.console.dir=function(){t._doWhenReceiverIsReady(function(e){t._dir.apply(t,e)},arguments)},e.console.debug=function(){t._doWhenReceiverIsReady(function(e){t._debug.apply(t,e)},arguments)},e.console.info=function(){t._doWhenReceiverIsReady(function(e){t._info.apply(t,e)},arguments)},t._receiver=e.$_$receiver||new e.WebSocket("ws://"+(e.$_$receiverHost||"127.0.0.1")+":"+e.$_$receiverPort),t._onReceiverReady=[function(){t._receiverReady=!0}],t._receiver.onopen=function(){for(var i=0,n=t._onReceiverReady.length;i<n;i++)try{t._onReceiverReady[i]()}catch(r){if(e.$_$reuseableTracer||void 0===t._onStartIndex||!(i<t._onStartIndex))throw r;t._globalBrowserError(r.message,void 0,void 0,void 0,r)}},t._receiver.onerror=function(e){throw new Error("Sandbox receiver error: "+e.message)},t.reset()};if(d.prototype={setGlobalErrorHandler:function(){var t=this;e.$_$reuseableTracer||(e.onerror=function(){t._globalBrowserError.apply(t,arguments)})},_globalBrowserError:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._sendBrowserGlobalError.apply(e,t)},arguments)},reportDeclarationError:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._sendDeclarationError.apply(e,t)},arguments)},reportGlobalErrorObject:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._sendGlobalErrorObject.apply(e,t)},arguments)},sendTransformedFile:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._sendTransformedFile.apply(e,t)},arguments)},_sendTransformedFile:function(e){this._send("transformedFile",e)},sendFileChange:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._sendFileChange.apply(e,t)},arguments)},_sendFileChange:function(e){this._send("fileChange",e)},initialSpecId:function(){return e.$_$initialSpecId},setInitializeResult:function(e){this._initializeResult=e},start:function(t){var i=this;if(t||!(i._delayStart||i._startRequested&&!e.$_$reuseableTracer))if(i.reset(),t)i._onStart=t,i._patchFrameworks();else{var n=function(){if(t)i._onStart=t,i._patchFrameworks();else{if(!i._onStart)throw new Error("Missing tracer start subscription");i._startRequested=!0,i._receiverReady?i._onStart():(i._onReceiverReady.push(i._onStart),i._onStartIndex=i._onReceiverReady.length-1)}};i._initializeResult&&i._initializeResult instanceof Promise?(i._initializeResult.then(n)["catch"](function(e){e.message="Uncaught Error in Wallaby `setup` function: "+e.message,i._globalBrowserError(e.message,void 0,void 0,void 0,e)}),delete i._initializeResult):n()}},isInitialized:function(){return!!e.$_$coverage},statement:function(t,i){e.$_$coverage[t][i][this._spec]=o++},scopeStart:function(e){this._fileEncounter[e]||(this._fileEncounterSequence.push(e),this._fileEncounter[e]=1)},programScopeStartLoading:function(t){var i=this;this._testFileIds[t]&&(this._resetFileData(),e.$_$traceContext&&e.$_$traceContext.test&&(t===e.$_$traceContext.test[0]?i._setTraceRecordMode():i._resetTracerMode())),this.scopeStart(t)},programScopeEndLoading:function(e){this._testFileIds[e]&&(this._saveCurrentTestLoadingSequence(),this._resetFileData())},_saveCurrentTestLoadingSequence:function(){this._fileEncounterSequence.length&&this._testLoadingSequence.push(this._fileEncounterSequence.slice())},entryFile:function(){return this._fileEncounterSequence[0]},started:function(t){t=t||{},t.loadingSequence=this._testLoadingSequence.slice(),this._resetLoadingData(),this._resetFileData(),e.$_$wp=this._original_$_$wp,e.$_$wpe=this._original_$_$wpe,this._send("started",t)},specStart:function(t,i){var n=this,r="string"==typeof i?i:n._format(i).content;this._doWhenReceiverIsReady(function(){n._sendWithHighPriority("preTest",r)}),this._spec=t,this._specName=r,this._resetFileData(),e.$_$trace&&(e.$_$trace.tests[t]={start:e.$_$trace.sequence.length})},specSyncStart:function(){if(this._specRangeStart=o,e.$_$trace&&this._spec){var t=e.$_$trace.tests[this._spec];t&&(t.start=e.$_$trace.sequence.length)}},specSyncEnd:function(){this._specRangeEnd=o-1},specEnd:function(){if(e.$_$trace){var t=e.$_$trace.tests[this._spec];t&&(t.end=Math.max(e.$_$trace.sequence.length-1,t.start),t.start>e.$_$trace.sequence.length-1&&delete e.$_$trace.tests[this._spec])}this._spec=0,delete this._specName;var i=this._specRangeStart,n=this._specRangeEnd;return this._specRangeStart=0,this._specRangeEnd=0,[i,n||o]},needToNotifySingleTestRun:function(){if(this._paused||this._onResumed||!this.hasSpecFilter()||e.$_$reuseableTracer||!this._pauseAfterSingleTestExecution)return!1;for(var t=e.$_$tests;"*"!==t;){var i=Object.keys(t);if(1!=i.length)return!1;t=t[i[0]]}return!0},notifySingleTestAfterEach:function(t){return this._paused||this._onResumed||e.$_$reuseableTracer?void t():(this._paused=!0,this._onResumed=t,void this._send("resume"))},resume:function(){this._paused&&(this._paused=!1,this._onResumed&&(this._onResumed(),delete this._onResumed))},paused:function(){return this._paused},hasSpecFilter:function(){return!!e.$_$tests&&"*"!==e.$_$tests},specFilter:function(t){var i=e.$_$tests[":?"];if(i&&i[":"+t[t.length-1]])return!0;for(var n=e.$_$tests,r=0,o=t.length;r<o;r++){var s=t[r];if(n=n[":"+s],!n)return!1;if("*"===n)return!0}return!1},globalSetupComplete:function(e){this._send("globalSetupComplete",e)},complete:function(t){e.$_$coverage&&(this._sendCoverageAndTimeMeasures(),e.$_$trace&&(e.$_$trace.values={},this._send("trace",{trace:e.$_$trace}),delete e.$_$trace,this._resetTracerMode()),this._send("complete",t),e.$_$reuseableTracer||(this._receiver.close(),this._finished=!0))},intermediateComplete:function(){this._sendCoverageAndTimeMeasures()},_sendCoverageAndTimeMeasures:function(){if(e.$_$coverage){var t,i;for(t=0,i=e.$_$coverage.length;t<i;t++){var n=e.$_$coverage[t];n&&n.length&&this._send("coverage",{id:t,ranges:n})}var r=Object.keys(f._autoTimeHits);for(t=0,i=r.length;t<i;t++){var o=f._autoTimeHits[r[t]];if(o.fileId){var s,a,l,c;if(o.logMarkerContext&&(s=o.logMarkerContext.changeId,a=o.logMarkerContext.traceId,l=o.logMarkerContext.traceStep,c=o.logMarkerContext.permanent,e.$_$logSuppressions&&!c)){var u=e.$_$logSuppressions[fileId];if(u&&u.whole)continue;if(s&&u[s])continue}var h;(a||s||c)&&(h=h||{},c&&(h.permanent=c)),(a||s)&&(a&&(h.traceId=a),s&&(h.changeId=s),h.traceStep=l),this._sendLog("autoLog",{content:o.value?this._formatTime(o.value)+"ms":"Σ "+this._formatTime(o.total)+"ms, μ "+this._formatTime(o.total/o.n)+"ms, ⋀ "+this._formatTime(o.min)+"ms, ⋁ "+this._formatTime(o.max)+"ms",format:"raw"},o.context,o.fileId,o.rangeId,h)}}}},_formatTime:function(e){return e.toFixed(3)},result:function(t){t.files=this._fileEncounterSequence,t.matchSnapshotCalls=this._matchSnapshotCalls,delete this._matchSnapshotCalls,e.$_$reuseableTracer&&this._sendWithHighPriority("postTest"),this._send("test",t)},_patchFrameworks:function(){var t=this;if(!t._patchedFrameworks&&!e.$_$reuseableTracer){t._patchedFrameworks=!0;var i=e.requirejs&&"function"==typeof e.requirejs.load,n=e.System&&(e.System.fetch||e.System["import"]);if(t._shouldReportProgramScope=t._shouldReportProgramScope||i||n,
i){var r=e.requirejs.load;e.requirejs.load=function(e,i,n){return r.call(this,e,i,t._urlWithFileData(n))}}if(n){var o=e.System.fetch;e.System.fetch=function(){var e=arguments[0]&&arguments[0].address;return e&&(arguments[0].address=t._urlWithFileData(e)),o.apply(this,arguments)};var s=e.fetch;s&&(e.fetch=function(){var e=arguments[0];return e&&(arguments[0]=t._urlWithFileData(e)),s.apply(this,arguments)});var a=e.System["import"];e.System["import"]=function(){var e=arguments[0];return e&&(arguments[0]=t._urlWithFileData(e)),a.apply(this,arguments)}}if(t._XMLHttpRequest){var l=t._XMLHttpRequest.prototype.open;t._XMLHttpRequest.prototype.open=function(e,i){arguments[1]=t._urlWithFileData(i),l.apply(this,arguments)}}t._Error&&!t._Error.captureStackTrace&&e.navigator&&e.navigator.userAgent&&/PhantomJS\/2/.test(e.navigator.userAgent)&&(t._Error.captureStackTrace=function(){})}},_urlWithFileData:function(e){var t=this;if(e&&~e.indexOf("wallabyFileId"))return e;for(var i=[],n=e.replace(/\\/g,"/").split("/"),r=0;r<n.length;r++)"."!==n[r]&&(".."===n[r]&&i.length&&".."!==i[i.length-1]?i.pop():i.push(n[r]));return e=i.join("/"),e=t._appendFileData(e)},_appendFileData:function(t){var i=this,n="/"===t.charAt(0)?t.substr(1):t,r=e.location&&e.location.host&&t.indexOf(e.location.host);r>=0&&(n=n.substr(r+e.location.host.length+1));var o=t.lastIndexOf("?");o>=0&&(n=n.substring(0,o));var s=n&&i._getFileMetadata(n);return s?t+(~o?"&":"?")+s.ts+"&wallabyFileId="+s.id:t},_getFileMetadata:function(t){return e.$_$files[t]||e.$_$files[t.split("\\").join("/")]},_doWhenReceiverIsReady:function(e,t){var i=this;i._receiverReady?e(t):i._onReceiverReady.push(function(){e(t)})},_log:function(){this._sendLog("log",this._format.apply(this,arguments))},_warn:function(){this._sendLog("warn",this._format.apply(this,arguments))},_error:function(){this._sendLog("error",this._format.apply(this,arguments))},_dir:function(e){this._sendLog("dir",{content:this._inspect(e),format:"raw"})},_debug:function(e){this._sendLog("debug",{content:this._inspect(e),format:"raw"})},_info:function(e){this._sendLog("info",this._format.apply(this,arguments))},_debugLog:function(){this._sendLog("debugLog",this._format.apply(this,arguments))},_sendBrowserGlobalError:function(e,t,i,n,r){e=e&&e.toString()||"",t=t&&t.toString()||"",i=i&&i.toString()||"",i&&(n=n>=0&&n.toString()||"",n&&(i+=":"+n)),this._send("globalError",{message:e,stack:r&&r.stack?r.stack:e+"\nat "+t+":"+i})},_sendDeclarationError:function(e){this._send("globalError",{message:e.message,stack:e.stack,declaration:!0})},_sendGlobalErrorObject:function(e){this._send("globalError",e)},setEnvGlobal:function(e){this._envGlobal=e},resetEnvGlobal:function(){delete this._envGlobal},debugLog:function(){var e=this;e._doWhenReceiverIsReady(function(t){e._debugLog.apply(e,t)},arguments)},log:function(){var t,i,n=this;e.$_$trace&&e.$_$traceContext&&(t="*",i=e.$_$trace.sequence.length-1);var r=n._replacedConsoleLog!==e.console.log;if(r||n._envGlobal){for(var o=[],s=arguments.length-3,a=0;a<s;a++)o.push(arguments[a]);n._suppressConsoleLog=!0,n._envGlobal&&n._envGlobal.console.log.apply(n._envGlobal.console,o),r&&e.console.log.apply(console,o),n._suppressConsoleLog=!1}n._doWhenReceiverIsReady(function(e){n._loggingValue=!0;for(var r=[],o=e.length-3,s=0;s<o;s++)r.push(e[s]);var a,l=e[o],c=e[o+1],u=e[o+2],h=c+","+u,d=n._consoleHits[h]=n._consoleHits[h]||0;d<n._evaluatedExpressionPerRangeLimit?a=n._evaluateExpressions(n._expressionId(c,h,d),r[0],l):d===n._evaluatedExpressionPerRangeLimit&&(a=n._evaluateExpressions(n._expressionId(c,h,d),r[0],l,new Error("Only the first "+d+" values are evaluated"))),n._consoleHits[h]=d+1,a&&t&&(a.traceId=t,a.traceStep=i);var f=n._format.apply(n,r);n._sendLog("log",f.content?f:{content:"",format:"raw"},l,c,u,a),n._loggingValue=!1},arguments)},canUpdateSnapshots:function(){return this._updateSnapshotsRun},_expressionId:function(e,t,i,n){var r=(this.entryFile()||"").toString();e=e.toString();var o=t+","+i+(r===e?"":","+r);return n&&(o+="#"+n.hitCount),o},setAssertionData:function(e,t){try{e.actual||e.expected||!e.matcherResult||(e=e.matcherResult,e.showDiff="toEqual"===e.name);var i=Object.prototype.toString.call(e.actual);e.showDiff===!0&&i==Object.prototype.toString.call(e.expected)&&void 0!==e.expected&&"[object Boolean]"!==i&&"[object Number]"!==i&&"[object Function]"!==i&&("string"!=typeof e.actual&&(e.actual=this._inspect(e.actual,8,1e3,!0,!0,!0),e.expected=this._inspect(e.expected,8,1e3,!0,!0,!0)),t.actual=e.actual,t.expected=e.expected),"UnexpectedError"===e.name&&e.getErrorMessage&&(t.formattedDiff=e.getErrorMessage("ansi").toString()),e.actual&&e.actual.stack&&"string"==typeof e.actual.stack&&(t.stack=t.stack||"",t.stack+="\nFrom actual error object:\n"+e.actual.stack)}catch(n){}return t},diff:function(e,t,i,n,r){var o=this;return o._doWhenReceiverIsReady(function(){var s=o.setAssertionData({showDiff:!0,expected:e,actual:t},{});o._sendLog("diff",{content:""},i,n,r,void 0,s.expected,s.actual)},arguments),t},_sendLog:function(e,t,i,n,r,o,s,a){var l=t.content?t.content.length:0;t.content&&l>this._maxLogEntrySize&&(t.content=t.content.slice(0,this._maxLogEntrySize)+"...\n(truncated, total length: "+l+")",t.format="raw"),this._send("console",{type:e,text:t.content||"",format:t.format,valueBag:o,spec:this._spec,file:n,range:r,context:i,expected:s,actual:a})},_send:function(e,t){this._receiver.send(this._JSONStringify(this._createMessage(e,t)))},_createMessage:function(t,i){return{type:t,data:i,session:e.$_$session,childSession:e.$_$childSession}},_sendWithHighPriority:function(e,t){if(this._highPriorityReceiver){var i=this._createMessage(e,t);i._p="###wpm###",this._highPriorityReceiver.send(this._JSONStringify(i)+"\n")}else this._send(e,t)},_resetLoadingData:function(){this._testLoadingSequence=this._safeObject([])},_resetFileData:function(){this._fileEncounterSequence=this._safeObject([]),this._fileEncounter=this._safeObject([])},reset:function(){var e=this;o=1,e._formattingOpts={},e._consoleHits={},e._consoleProxyHits={},delete e._proxyCache,e._autoTimeHits={},e._spec=0,delete e._specName,e._specRangeStart=0,e._specRangeEnd=0,e._stackDepth=0,e._functionCallId=0,e._resetFileData()},_safeObject:function(e){return e.toJSON=this._undefined,e},_format:function(t){var i,n=this._formattingOpts.depth||e.$_$logLimits.inline.depth,r=this._formattingOpts.maxElementsPerLevel||e.$_$logLimits.inline.elements,o=this._formattingOpts.resolveGetters;if("string"!=typeof t){var a=[];for(i=0;i<arguments.length;i++)a.push(this._inspect(arguments[i],n,r,!1,!1,o));return{content:a.join(" ")}}i=1;for(var l=arguments,c=l.length,u=1===c?t:String(t).replace(s,function(e){if("%%"===e)return"%";if(i>=c)return e;switch(e){case"%s":return String(l[i++]);case"%d":return Number(l[i++]);case"%j":return JSON.stringify(l[i++]);case"%c":return i++&&"";default:return e}}),h=l[i];i<c;h=l[++i])u+=null===h||"object"!=typeof h?" "+h:" "+this._inspect(h,n,r);return{content:u,format:this._maybeHtml(u)?"html":"raw"}},_inspect:function(t,i,n,r,o,s){var a={seen:[],showHidden:!1,hideTypes:r,depth:i||e.$_$logLimits.inline.depth,stylize:function(e){return e},maxElementsPerLevel:n||e.$_$logLimits.inline.elements,customInspect:e.$_$reuseableTracer&&this._nodeUtil,sortProperties:!!o,resolveGetters:!!s};return this._formatValue(a,t,a.depth)},_formatValue:function(e,t,i){var n=this,r=this._formatPrimitive(e,t);if(r)return r;if(e.customInspect){var o=n._nodeUtil.inspect&&t[n._nodeUtil.inspect.custom];if(o||t.inspect===n._nodeUtil.inspect||"function"!=typeof t.inspect||(o=t.inspect),"function"==typeof o&&o!==n._nodeUtil.inspect&&(!t.constructor||t.constructor.prototype!==t)){var s=o.call(t,i,e);if(s!==t)return"string"!=typeof s?n._formatValue(e,s,i):s}}var a=Object.keys(t),l=this._arrayToHash(a);e.showHidden&&(a=Object.getOwnPropertyNames(t)),e.sortProperties&&a.sort();var c=this._getOwnPropertySymbols(t);if(c.length&&(e.showHidden||"function"!=typeof t.propertyIsEnumerable||(c=c.filter(function(e){return t.propertyIsEnumerable(e)})),a=a.concat(c)),0===a.length){if("function"==typeof t){var u=t.name?": "+t.name:"";return e.stylize("[λ"+u+"]","special")}if(this._isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(this._isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(this._isBigInt(t))return t.toString();if(this._isError(t))return this._formatError(t)}var h="",d=!1,f=!1,p=!1,g=["{","}"],v=t&&t.constructor&&"string"==typeof t.constructor.name&&t.constructor.name||void 0;if(("Object"===v||e.hideTypes)&&(v=void 0),this._isArray(t)?(v=void 0,d=!0,g=["[","]"]):this._isSet(t)?f=!0:this._isMap(t)&&(p=!0),"function"==typeof t){var y=t.name?": "+t.name:"";h=" [λ"+y+"]"}if(this._isRegExp(t)&&(h=" "+RegExp.prototype.toString.call(t)),this._isDate(t)&&(h=" "+Date.prototype.toUTCString.call(t)),this._isError(t)&&(h=" "+this._formatError(t)),""===h&&v&&(g[0]=v+("String"!==v&&"Number"!==v&&"Boolean"!==v||"function"!=typeof t.valueOf?"":" "+this._formatPrimitive(e,t.valueOf()))+" "+g[0]),d||p||f||(this._isGenerator(t)?h=" [Generator] ":this._isIterator(t)&&(h=" [Iterator] ")),this._nodeUtil&&this._nodeUtil.inspect&&this._looksLikePromise(t))return this._nodeUtil.inspect(t);if(!(0!==a.length||d&&0!==t.length||f||p))return g[0]+h+g[1];if(i<0)return this._isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var m,_=!1;a.length>e.maxElementsPerLevel&&(a.length=e.maxElementsPerLevel,d&&t&&(t=t.slice(0,e.maxElementsPerLevel)),_=!0);try{m=d?this._formatArray(e,t,i,l,a):f?this._formatSet(e,t,i,l,a,_):p?this._formatMap(e,t,i,l,a,_):a.map(function(r){return n._formatProperty(e,t,i,l,r,d)})}catch(b){m=[]}return _&&m.push("..."),e.seen.pop(),this._reduceToSingleString(m,h,g)},_isArray:function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===this._objectToString(e)},_isSet:function(t){return!!(t&&e.Set&&"[object Set]"===this._objectToString(t)&&t.forEach)},_isMap:function(t){return!!(t&&e.Map&&"[object Map]"===this._objectToString(t)&&t.forEach)},_isIterator:function(t){return!!(t&&e.Symbol&&e.Symbol.iterator&&"function"==typeof t[e.Symbol.iterator])},_isGenerator:function(t){return!!(t&&e.Symbol&&e.Symbol.toStringTag&&"Generator"===t[e.Symbol.toStringTag])},_isRegExp:function(e){return"object"==typeof e&&"[object RegExp]"===this._objectToString(e)},_isDate:function(e){return"object"==typeof e&&"[object Date]"===this._objectToString(e)},_isBigInt:function(e){return"bigint"==typeof e},_isError:function(e){return"object"==typeof e&&("[object Error]"===this._objectToString(e)||e instanceof Error)},_objectToString:function(e){return Object.prototype.toString.call(e)},_isNegativeZero:function(e){return 1/e===Number.NEGATIVE_INFINITY},_reduceToSingleString:function(e,t,i){var n=0,r=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.length+1},0);return r>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]},_formatPrimitive:function(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string");case"number":return!t&&this._isNegativeZero(t)?e.stylize("-0","number"):e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean");case"symbol":return this._Symbol&&this._Symbol.prototype.toString.call(t)}if(null===t)return e.stylize("null","null")},_formatError:function(e){return"["+Error.prototype.toString.call(e)+"]"},_formatSet:function(e,t,i,n,r,o){var s=this,a=[];t.forEach(function(t){if(!(a.length>e.maxElementsPerLevel)){var n=null===i?null:i-1,r=s._formatValue(e,t,n);a.push(r)}}),!o&&a.length>e.maxElementsPerLevel&&a.push("...");for(var l=0;l<r.length;l++)a.push(s._formatProperty(e,t,i,n,r[l],!1));return a},_formatMap:function(e,t,i,n,r,o){var s=this,a=[];t.forEach(function(t,n){if(!(a.length>e.maxElementsPerLevel)){var r=null===i?null:i-1,o=s._formatValue(e,n,r);o+=" => ",o+=s._formatValue(e,t,r),a.push(o)}}),!o&&a.length>e.maxElementsPerLevel&&a.push("...");for(var l=0;l<r.length;l++)a.push(s._formatProperty(e,t,i,n,r[l],!1));return a},_formatArray:function(e,t,i,n,r){for(var o=this,s=[],a=0,l=t.length;a<l;++a)this._hasOwnProperty(t,String(a))?s.push(this._formatProperty(e,t,i,n,String(a),!0)):s.push("");return r.forEach(function(r){r.toString().match(/^\d+$/)||s.push(o._formatProperty(e,t,i,n,r,!0))}),s},_formatProperty:function(e,t,i,n,r,o){var s,a,l;if(l=!e.resolveGetters&&Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},l.get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),this._hasOwnProperty(n,r)||(s="["+r.toString()+"]"),a||(e.seen.indexOf(l.value)<0?(a=null===i?this._formatValue(e,l.value,null):this._formatValue(e,l.value,i-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),"undefined"==typeof s){if(o&&r.match(/^\d+$/))return a;s=this._propertyName(r),s=e.stylize(s,"string")}return s+": "+a},_arrayToHash:function(e){var t={};return e.forEach(function(e){t[e]=!0}),t},_hasOwnProperty:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},_getOwnPropertySymbols:function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]},_propertyName:function(e){if(e.match(/^\d+$/))return e;var t=JSON.stringify(""+e);return t=t.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?t.substr(1,t.length-2):t.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'")},_evaluate:function(t,i,n,r,o,s){var a={};try{var l=n||{};if(l.props=l.props!==this._undefined?l.props:100,l.sortProps=l.sortProps!==this._undefined&&l.sortProps,l.elements=l.elements!==this._undefined?l.elements:100,l.depth=l.depth!==this._undefined?l.depth:1,l.strLength=l.strLength!==this._undefined?l.strLength:e.$_$logLimits.values["default"].stringLength,l.level=0,l.expId=l.expId||r,l.rootExpression=i,l.autoExpand=l.autoExpand!==this._undefined&&l.autoExpand,l.autoExpandPreviousObjects=[],l.autoExpandPropertyCount=0,l.autoExpandLimit=l.autoExpandLimit!==this._undefined?l.autoExpandLimit:e.$_$logLimits.values.autoExpand.elements,l.autoExpandMaxDepth=l.autoExpandMaxDepth!==this._undefined?l.autoExpandMaxDepth:e.$_$logLimits.values.autoExpand.depth,l.resolveGetters=l.autoExpand||e.$_$resolveGetters,l.node={current:this._undefined,parent:this._undefined,index:0},o){var c={error:o.message};this._processTreeNodeResult(c,l),a.data=c}else{if(a.data=this._traverseObject({},t,l,l.expressionsToEvaluate||{}),!this._suppressCallStackEval&&!s&&(a.data.expandable&&a.data.props&&a.data.props.length||!a.data.expandable)){var u="_s_.",h={id:a.data.id+",cs",expandable:!0,callStackNode:!0,label:{name:"Call Stack"},disallowToCopyPath:!0,disallowToCopyData:!0,queryPath:a.data.queryPath.slice().concat([u])};a.data.expandable||(a.data.expandable=!0,a.data.props=[]),a.data.props.unshift(h),l.expressionsToEvaluate&&l.expressionsToEvaluate[u]&&(h.callStack={stack:this._currentStack(),replaceFirstEntryLine:!l.proxyValue})}this._specName&&!l.proxyValue&&a.data&&a.data.label&&a.data.label.value&&(a.data.label.value+=" ("+this._specName+")")}}catch(d){var f={error:'Error while evaluating "'+i+'": '+(d&&d.message||"")};this._processTreeNodeResult(f,l),a.data=f}return a},_addProperty:function(e,t,i,n,r,o){var s=this;return function(a){var l=r.node.current,c=r.node.index,u=r.node.parent;r.node.parent=l,r.node.index="number"==typeof n?n:a,e.push(s._property(t,i,n,r,o)),r.node.parent=u,r.node.index=c}},_addObjectProperty:function(e,t,i,n,r,o,s){var a=this;return t["_p_"+r.toString()]=!0,function(t){var l=o.node.current,c=o.node.index,u=o.node.parent;o.node.parent=l,o.node.index=t,e.push(a._property(i,n,r,o,s)),o.node.parent=u,o.node.index=c}},_traverseObject:function(e,t,i,n){var r=this,o=i.autoExpand;try{i.level++,i.autoExpand&&i.autoExpandPreviousObjects.push(t);var s,a,l,c,u,h,d=[],f=[],p=this._type(t),g="array"===p,v=!1,y="function"===p,m=this._isPrimitiveType(p),_=this._isPrimitiveWrapperType(p),b=m||_,k={},T=0,S=!1,C=/^(([1-9]{1}[0-9]*)|0)$/;if(i.depth){if(g){a=t.length;var L=n.ranges||i.ranges;if(L&&L.length===a)v=!0,d=L.props,this._traverseRanges(d,function(e,n,o){for(s=n;s<=o;s++)f.push(r._addProperty(e.props,t,p,s,i))});else if(a>i.elements)v=!0,l=0,c=a-1,f.push(function(e,t,i){return function(){d=d.concat(r._createRanges(e,t,i))}}(l,c,i));else for(l=0,c=a,s=l;s<c;s++)f.push(r._addProperty(d,t,p,s,i));i.autoExpandPropertyCount+=f.length}if("null"!==p&&"undefined"!==p&&!m&&"String"!==p&&"Buffer"!==p&&"bigint"!==p){var j=n.props||i.props;if(this._isSet(t)?(s=0,t.forEach(function(e){return T++,i.autoExpandPropertyCount++,T>j?void(S=!0):!i.isExpressionToEvaluate&&i.autoExpand&&i.autoExpandPropertyCount>i.autoExpandLimit?void(S=!0):void f.push(r._addProperty(d,t,"Set",s++,i,function(e){return function(){return e}}(e)))})):this._isMap(t)&&t.forEach(function(e,n){if(T++,i.autoExpandPropertyCount++,T>j)return void(S=!0);if(!i.isExpressionToEvaluate&&i.autoExpand&&i.autoExpandPropertyCount>i.autoExpandLimit)return void(S=!0);var o=r._inspect(n,2,10).replace(/\r?\n|\r/g," ").replace(/\s\s+/g," ");o.length>100&&(o=o.slice(0,100)+"..."),f.push(r._addProperty(d,t,"Map",o,i,function(e){return function(){return e}}(e)))}),!v){try{for(u in t)if(!(g&&C.test(u)||this._blacklistedProperty(t,u))){if(T++,i.autoExpandPropertyCount++,T>j){S=!0;break}if(!i.isExpressionToEvaluate&&i.autoExpand&&i.autoExpandPropertyCount>i.autoExpandLimit){S=!0;break}f.push(r._addObjectProperty(d,k,t,p,u,i))}}catch(w){}if(k._p_length=!0,y&&(k._p_name=!0),!S){var x=this._getOwnPropertyNames(t).concat(this._getOwnPropertySymbols(t));for(s=0,a=x.length;s<a;s++)if(u=x[s],!(g&&C.test(u.toString())||this._blacklistedProperty(t,u)||k["_p_"+u.toString()])){if(T++,i.autoExpandPropertyCount++,T>j){S=!0;break}if(!i.isExpressionToEvaluate&&i.autoExpand&&i.autoExpandPropertyCount>i.autoExpandLimit){S=!0;break}f.push(r._addObjectProperty(d,k,t,p,u,i))}}}}}if(e.type=p,b?(e.value=t.valueOf(),this._capIfString(p,e,i,n)):"date"===p?e.value=this._dateToString.call(t):"RegExp"===p?e.value=this._regExpToString.call(t):"symbol"===p&&this._Symbol?e.value=this._Symbol.prototype.toString.call(t):i.depth||"null"===p||"undefined"===p||(delete e.value,e.capped=!0),S&&(e.cappedProps=!0),h=i.node.current,i.node.current=e,this._treeNodePropertiesBeforeFullValue(e,i),f.length)for(s=0,a=f.length;s<a;s++)f[s](s);d.length&&(e.props=d)}catch(w){e.type="unknown",e.error=w.message,h=i.node.current,i.node.current=e,this._treeNodePropertiesBeforeFullValue(e,i)}return this._additionalMetadata(t,e),this._treeNodePropertiesAfterFullValue(e,i),i.node.current=h,i.level--,i.autoExpand=o,i.autoExpand&&i.autoExpandPreviousObjects.pop(),e},_blacklistedProperty:function(t,i){if((t===e||t===this._envGlobal)&&"wallaby"===i||i.indexOf&&0===i.indexOf("$_$"))return!0},_createRanges:function(e,t,i,n){n=n||{index:0};for(var r=i.elements,o=t-e+1,s=[],a=Math.max(Math.ceil(o/r),r),l=e;l<t;l+=a){var c=l,u=Math.min(l+a-1,t);u+r/2>=t&&(u=t);var h=c+" - "+u,d=u-c+1,f={rangeNode:!0,name:h,props:d>2*r&&r>1?this._createRanges(c,u,i,n):[]};if(this._setNodeId(f,i),this._setNodeLabel(f,i),this._setNodeExpandableState(f,i),this._setNodePermissions(f,i),f.id+=" r "+n.index++,s.push(f),u===t)break}return s},_traverseRanges:function(e,t){for(var i=0,n=e.length;i<n;i++){var r=e[i];if(r.rangeNode=!0,r.props)if(r.props.length)this._traverseRanges(r.props,t);else if(r.props===!0){var o=r.name.split("-");r.props=[],t(r,parseInt(o[0],10),parseInt(o[1],10))}}},_capIfString:function(e,t,i,n){var r=n.strLength||i.strLength;("string"===e||"String"===e)&&t.value&&t.value.length>r&&(t.capped=t.value.substr(0,r),delete t.value)},_property:function(e,t,i,n,r){var o=this;r||(r=function(e,t){return e[t]});var s=i.toString(),a=n.expressionsToEvaluate||{},l=n.depth,c=n.isExpressionToEvaluate;try{var u=this._isMap(e),h=s;u&&"'"===h[0]&&(h=h.substr(1,h.length-2));var d=n.expressionsToEvaluate=a["_p_"+h];d&&(n.depth=n.depth+1),n.isExpressionToEvaluate=!!d;var f="symbol"==typeof i,p={name:f||u?s:this._propertyName(s)};if(f&&(p.symbol=!0),"array"!==t&&"Error"!==t){var g=this._getOwnPropertyDescriptor(e,i);if(g&&(g.set&&(p.setter=!0),g.get&&!d&&!n.resolveGetters))return p.getter=!0,this._processTreeNodeResult(p,n),p}var v;try{v=r(e,i)}catch(y){return p={name:s,type:"unknown",error:y.message},this._processTreeNodeResult(p,n),p}var m=this._type(v),_=this._isPrimitiveType(m);if(p.type=m,_)this._processTreeNodeResult(p,n,v,function(){p.value=v.valueOf(),!d&&o._capIfString(m,p,n,{})});else{var b=n.autoExpand&&n.level<n.autoExpandMaxDepth&&n.autoExpandPreviousObjects.indexOf(v)<0&&"function"!==m&&n.autoExpandPropertyCount<n.autoExpandLimit;b||n.level<l||d?(this._traverseObject(p,v,n,d||{}),this._additionalMetadata(v,p)):this._processTreeNodeResult(p,n,v,function(){"null"!==m&&"undefined"!==m&&(delete p.value,p.capped=!0)})}return p}finally{n.expressionsToEvaluate=a,n.depth=l,n.isExpressionToEvaluate=c}},_processTreeNodeResult:function(e,t,i,n){this._treeNodePropertiesBeforeFullValue(e,t),n&&n(),this._additionalMetadata(i,e),this._treeNodePropertiesAfterFullValue(e,t)},_treeNodePropertiesBeforeFullValue:function(e,t){this._setNodeId(e,t),this._setNodeQueryPath(e,t),this._setNodeExpressionPath(e,t),this._setNodePermissions(e,t)},_treeNodePropertiesAfterFullValue:function(e,t){this._setNodeLabel(e,t),this._setNodeExpandableState(e,t),t.sortProps&&this._sortProps(e,t),this._addFunctionsNode(e,t),this._addLoadNode(e,t),this._cleanNode(e,t)},_additionalMetadata:function(e,t){try{e&&"number"==typeof e.length&&(t.length=e.length)}catch(i){}if("number"===t.type||"Number"===t.type)if(isNaN(t.value))t.nan=!0,delete t.value;else switch(t.value){case Number.POSITIVE_INFINITY:t.positiveInfinity=!0,delete t.value;break;case Number.NEGATIVE_INFINITY:t.negativeInfinity=!0,delete t.value;break;case 0:this._isNegativeZero(t.value)&&(t.negativeZero=!0)}else"function"===t.type&&"string"==typeof e.name&&e.name&&t.name&&e.name!==t.name&&(t.funcName=e.name)},_setNodeId:function(e,t){e.id=t.node.parent?t.node.parent.id+" "+t.node.index:t.expId},_sortProps:function(e){e.props&&e.props.length&&"array"!==e.type&&"Map"!==e.type&&"Set"!==e.type&&e.props.sort(function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0})},_addFunctionsNode:function(e,t){if(e.props&&e.props.length){for(var i=[],n=[],r=0,o=e.props.length;r<o;r++){var s=e.props[r];"function"===s.type?i.push(s):n.push(s)}if(!n.length&&t.autoExpand&&(e.capped=!0),n.length&&!(i.length<=1)){e.props=n;var a={functionsNode:!0,props:i};t.autoExpand&&(a.capped=!0),this._setNodeId(a,t),this._setNodeLabel(a,t),this._setNodeExpandableState(a,t),this._setNodePermissions(a,t),a.id+=" f",e.props.unshift(a)}}},_addLoadNode:function(e,t){if(e.props&&e.props.length&&e.cappedProps&&"string"!==e.type){var i={loadActionNode:!0};this._setNodeId(i,t),this._setNodeQueryPath(i,t),this._setNodeLabel(i,t),this._setNodeExpandableState(i,t),this._setNodePermissions(i,t),i.id+=" l",e.props.push(i)}},_setNodeExpandableState:function(e){(e.capped||e.cappedProps||e.functionsNode||e.loadActionNode||e.rangeNode||e.getter||this._isArray(e.props))&&(e.expandable=!0)},_setNodePermissions:function(e,t){var i=t.node.parent;e._hasSymbolPropertyOnItsPath=e.symbol||i&&i._hasSymbolPropertyOnItsPath;var n=i&&i._hasSetOnItsPath,r=i&&i._hasMapOnItsPath;e._hasSetOnItsPath="Set"===e.type||n,e._hasMapOnItsPath="Map"===e.type||r;var o=!(e.functionsNode||e.loadActionNode||e.rangeNode||e.error);(!o||e._hasSymbolPropertyOnItsPath||n||r)&&(e.disallowToCopyPath=!0),o&&!e.getter&&"function"!==e.type&&"symbol"!==e.type&&"Set"!==e.type&&"Map"!==e.type||(e.disallowToCopyData=!0)},_cleanNode:function(e){delete e._hasSymbolPropertyOnItsPath,delete e._hasSetOnItsPath,delete e._hasMapOnItsPath},_setNodeExpressionPath:function(e,t){if(!t.node.parent)return void(e.expressionPath=[t.rootExpression]);var i=t.node.parent.expressionPath.slice();e.expressionPath=i.concat([this._propertyAccessor(e.name)])},_propertyAccessor:function(e){return e?e.match(l)?"["+e+"]":e.match(a)?"."+e:e.match(c)?"["+e+"]":"['"+e+"']":""},_setNodeQueryPath:function(e,t){if(!t.node.parent)return void(e.queryPath=[e.id]);if(e.loadActionNode)return void(e.queryPath=t.node.current.queryPath.slice());var i=e.name;i&&"'"===i[0]&&(i=i.substr(1,i.length-2)),e.queryPath=t.node.parent.queryPath.slice().concat(["_p_"+i])},_setNodeLabel:function(e,t){return e.label={},e.rangeNode?void(e.label.name=e.name):e.loadActionNode?void(e.label.name="..."):e.functionsNode?void(e.label.name="Functions"):(e.label.name=e.name,e.label.type=this._formatNodeType(e,t),void(e.label.value=this._formatNodeValue(e,t)))},_formatNodeValue:function(e,t,i){if(e.rangeNode)return e.name;if(e.error)return e.error;if(e.getter)return"(...)";if("number"===e.type.toLowerCase()){var n=e;if(n.nan)return"NaN";if(n.positiveInfinity)return"Infinity";if(n.negativeInfinity)return"-Infinity";if(n.negativeZero)return"-0"}if("null"===e.type||"undefined"===e.type)return e.type;if("string"===e.type.toLowerCase()){var r=e.capped?e.capped+"...":e.value;return"'"+r.replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'"+(e.capped?" (total length: "+e.length+")":"")}return(this._isUndefined(e.value)?this._formatCompactObjectView(e,t,i):e.value)+(e.funcName?":"+e.funcName:"")},_formatCompactObjectView:function(e,t,i){if("function"===e.type)return"λ";var n="array"===e.type&&0===e.length,r=["array"===e.type?"[":"{","","array"===e.type?"]":"}"];if(i||e.capped||e.ranges)r[1]=n?"":"...";else if(e.props){for(var o=5,s=[],a=[],l=0;l<e.props.length&&a.length<=o;l++){var c=e.props[l];("function"===c.type||c.getter?s:a).push("array"===e.type?this._formatNodeValue(c,t,!0):c.name+": "+this._formatNodeValue(c,t,!0))}a.length<o&&(a=a.concat(s)),r[1]=a.join(", "),e.props.length>o&&(r[1]+=", ...")}return r.join("")},_formatNodeType:function(e){if(this._isDisplayableType(e.type))return e.error?"":"date"===e.type?"Date":"array"===e.type?e.length?"Array("+e.length+")":"":e.type},_isUndefined:function(e){return e===this._undefined},_isDisplayableType:function(e){return!("boolean"===e||"Boolean"===e||"symbol"===e||"string"===e||"String"===e||"number"===e||"Number"===e||"object"===e||"Object"===e||"function"===e||"null"===e||"undefined"===e)},_type:function(e){var t=typeof e;return"object"===t?"[object Array]"===this._objectToString(e)?t="array":"[object Date]"===this._objectToString(e)?t="date":null===e?t="null":e.constructor&&(t=e.constructor.name||t):"undefined"===t&&this._HTMLAllCollection&&e instanceof this._HTMLAllCollection&&(t="HTMLAllCollection"),t},_isPrimitiveType:function(e){return"boolean"===e||"string"===e||"number"===e},_isPrimitiveWrapperType:function(e){return"Boolean"===e||"String"===e||"Number"===e},initLoadingPhase:function(){var t=this;this._resetLoadingData(),this._testFileIds=this._safeObject({}),(e.$_$testFiles||[]).forEach(function(e){t._testFileIds[e.id]=1}),t._original_$_$wp=e.$_$wp,t._original_$_$wpe=e.$_$wpe,e.$_$wp=function(e){return t._reportProgramScope("programScopeStart",e),t.programScopeStartLoading(e),t._executionContext()},e.$_$wpe=function(e){t._reportProgramScope("programScopeEnd",e),t.programScopeEndLoading(e)},!e.$_$traceContext||e.$_$traceContext.test?t._resetTracerMode():e.$_$traceContext.test||t._setTraceRecordMode(),e.$_$profileRun?t._setProfileMode():t._resetTracerMode()},_resetTracerMode:function(){e.$_$w=f.$_$w,e.$_$w_=f.$_$w_,e.$_$wv=f.$_$wv,e.$_$wf=f.$_$wf,this._envGlobal&&(this._envGlobal.$_$w=e.$_$w,this._envGlobal.$_$w_=e.$_$w_,this._envGlobal.$_$wv=e.$_$wv,this._envGlobal.$_$wf=e.$_$wf)},_setProfileMode:function(){e.$_$wf=e.$_$w_=e.$_$w=function(){},e.$_$wv=function(e,t,i,n,r,o){return o},this._envGlobal&&(this._envGlobal.$_$w=e.$_$w,this._envGlobal.$_$w_=e.$_$w_,this._envGlobal.$_$wf=e.$_$wf,this._envGlobal.$_$wv=e.$_$wv)},_setTraceRecordMode:function(){e.$_$trace||(e.$_$trace={sequence:[],tests:{},values:{}}),e.$_$traceContext.allowRecordingValues=!0,e.$_$traceContext.currentFrame=e.$_$traceContext.currentFrame||0,e.$_$w=function(e,t,i){f.$_$w(e,t),f._recordTrace(e,t,i[0]),f._recordTraceValues(e,t,i[1]),f._recordCallStack()},e.$_$wv=function(t,i,n,r,o,s,a,l,c,u){if(!e.$_$trace)return s;var h=f._expressionId(t,n,0);if(!u||!u.traceId||u.permanent){var d={};for(prop in u)d[prop]=u[prop];d.traceId="*",d.traceStep=e.$_$trace.sequence.length-1;var p=f.$_$wv(t,i,n,r,o,s,a,l,c,d);if(!d.permanent)return p}return u.permanent&&delete u.permanent,e.$_$trace.values[h]={fileId:t,rangeId:i,fileRangeId:n,context:o,val:s,exp:a,singleHit:l,evalOpts:c,logMarkerContext:u},f._recordTraceValues(t,i,r[1],!0),s},e.$_$w_=function(t,i,n,r){f.$_$w_(t,i),e.$_$traceContext.allowRecordingValues&&r&&e.$_$traceContext.currentFrame<=e.$_$trace.sequence.length-1&&(e.$_$traceContext.allowRecordingValues=!1)},e.$_$wf=function(e){return f.scopeStart(e),f._executionContext()},this._envGlobal&&(this._envGlobal.$_$w=e.$_$w,this._envGlobal.$_$wv=e.$_$wv,this._envGlobal.$_$wf=e.$_$wf)},_executionContext:function(){return[++this._stackDepth,++this._functionCallId]},_recordCallStack:function(){e.$_$trace&&e.$_$traceContext.captureCallStackFrame===e.$_$trace.sequence.length-1&&(e.$_$trace.callStack={},e.$_$trace.callStack[e.$_$traceContext.captureCallStackFrame]={stack:f._currentStack()})},_recordTraceValues:function(t,i,n,r){if(e.$_$traceContext.allowRecordingValues&&e.$_$trace){var o=e.$_$traceContext.currentFrame===e.$_$trace.sequence.length-1,s=e.$_$traceContext.currentFrame<e.$_$trace.sequence.length-1;if((s&&!e.$_$traceContext.currentFrameFunctionCallId||n<=e.$_$traceContext.currentFrameFunctionCallId)&&(e.$_$traceContext.allowRecordingValues=!1),o&&!r&&(e.$_$traceContext.currentFrameFunctionCallId=n),(o||r&&e.$_$traceContext.currentFrameFunctionCallId&&n===e.$_$traceContext.currentFrameFunctionCallId)&&Object.keys(e.$_$trace.values).length){var a=e.$_$trace.values;e.$_$trace.values={},f._doWhenReceiverIsReady(function(){for(var e=Object.keys(a),t=0,i=e.length;t<i;t++){var n=e[t],r=a[n];f._autoLogImmediateValue(r.fileId,r.rangeId,-1,r.context,r.val,r.exp,r.singleHit,r.evalOpts,r.logMarkerContext)}})}}},_recordTrace:function(t,i,n){e.$_$trace&&e.$_$trace.sequence.length>this._maxTraceSteps||(e.$_$trace._stackDepth!==n&&(e.$_$trace._stackDepth=n),e.$_$trace.sequence.push([t,i,n]))},_currentStack:function(){try{throw new Error("stack trace")}catch(e){return e.stack}},_reportProgramScope:function(e,t){var i=this;this._shouldReportProgramScope&&this._doWhenReceiverIsReady(function(){i._sendWithHighPriority(e,t)})},_looksLikePromise:function(t){return t&&t.constructor&&"Promise"===t.constructor.name&&"function"==typeof t.then&&"function"==typeof t["catch"]&&(e.Promise||{}).prototype!==t},_looksLikeObservable:function(e){return e&&e.constructor&&e.constructor.name&&"string"==typeof e.constructor.name&&~e.constructor.name.indexOf("Observable")&&"function"==typeof e.forEach},_looksLikeBuffer:function(t){return t&&t.constructor&&"Buffer"===t.constructor.name&&"function"==typeof t.toString&&(e.Buffer||{}).prototype!==t},_autoLogValue:function(t,i,n,r,o,s,a,l,c,u){var h=this,d=e.$_$session;this._loggingValue=!0,h._looksLikePromise(o)?(this._loggingValue=!1,o.then(function(o){e.$_$session===d&&h._autoLogResolvedValue(t,i,n,r,"then ",h._valueToFormat(o,s),a,l,c,u)})["catch"](function(o){e.$_$session===d&&h._autoLogResolvedValue(t,i,n,r,"catch ",(o||"<No Reason Provided>").toString(),a,l,c,u)})):h._looksLikeObservable(o)?(this._loggingValue=!1,o.forEach(function(o){e.$_$session===d&&h._autoLogResolvedValue(t,i,n,r,"",h._valueToFormat(o,s),a,l,c,u)})):h._autoLogImmediateValue(t,i,n,r,o,s,a,l,c,u),this._loggingValue=!1},_createProxy:function(t,i){i=i||{path:[]};var n=t.val,r=this;if(!r._loggingValue){r._proxyCache||(r._proxyCache=new e.WeakMap);
var o=function(e,n,o){if(!r._loggingValue){var s;n=(n||"").toString();var a="function"==typeof e;if((a||"object"==typeof e)&&"get"===o&&(s=r._proxyCache.get(e),!s)){var l={};l.path=i.path.slice(),n&&l.path.push(n),s=r._createProxy({fileId:t.fileId,rangeId:t.rangeId,hitCount:t.hitCount,context:t.context,val:e,exp:t.exp,singleHit:t.singleHit,evalOpts:t.evalOpts,logMarkerContext:t.logMarkerContext},l),r._proxyCache.set(e,s)}if(!a){var c={};c.path=i.path.slice().concat(n&&[n]||[]),c.trap=o;var u=r._expressionId(t.fileId,t.rangeId,t.hitCount);c.hitCount=r._consoleProxyHits[u]||0,r._autoLogValue(t.fileId,t.rangeId,t.hitCount,t.context,e,t.exp,t.singleHit,t.evalOpts,t.logMarkerContext,c),r._consoleProxyHits[u]=c.hitCount+1}return s}},s={get:function(e,t,i){var n=Reflect.get(e,t,i);return o(n,t,"get")||n},set:function(e,t,i,n){return o(i,t,"set"),Reflect.set(e,t,i,n)},apply:function(e,t,i){var n=Reflect.apply(e,t,i);return o(n,void 0,"call"),n},deleteProperty:function(e,t){return o(Reflect.get(e,t,e),t,"delete"),Reflect.deleteProperty(e,t)}};return new e.Proxy(n,s)}},_valueToFormat:function(e,t){return"$_$ne"===t?e:t(e)},_autoLogImmediateValue:function(e,t,i,n,r,o,s,a,l,c){var u=this;u._isBigInt(r)&&(r=r.toString()),u._autoLogResolvedValue(e,t,i,n,"",u._valueToFormat(u._looksLikeBuffer(r)?r.toString():r,o),s,a,l,c)},_autoLogResolvedValue:function(t,i,n,r,o,s,a,l,c,u){var h,d,f,p;if(c&&(h=c.changeId,d=c.traceId,f=c.traceStep,p=c.permanent,e.$_$logSuppressions&&!p)){var g=e.$_$logSuppressions[t];if(g&&g.whole)return;if(h&&g[h])return}this._loggingValue=!0,this._formattingOpts={maxElementsPerLevel:a?10:100,resolveGetters:e.$_$resolveGetters||1&l};var v,y=t+","+i;!o&&2&l&&(o="⚑ "),n<this._evaluatedExpressionPerRangeLimit?u&&u.hitCount===this._evaluatedProxyExpressionPerRangeLimit?v=this._evaluateExpressions(this._expressionId(t,y,n,u),s,r,new Error("Only the first "+u.hitCount+" values are evaluated"),l,d,!!u):(!u||u.hitCount<this._evaluatedProxyExpressionPerRangeLimit)&&(v=this._evaluateExpressions(this._expressionId(t,y,n,u),s,r,void 0,l,d,!!u)):n===this._evaluatedExpressionPerRangeLimit&&(v=this._evaluateExpressions(this._expressionId(t,y,n,u),s,r,new Error("Only the first "+n+" values are evaluated"),l,d,!!u)),(d||h||p)&&(v=v||{},p&&(v.permanent=p)),(d||h)&&(d&&(v.traceId=d),h&&(v.changeId=h),v.traceStep=f),u&&v&&v.data&&(v.data.proxyData=u),a&&(this._formattingOpts.depth=this._formattingOpts.depth||2);var m=this._format(s);m.content=m.content||"",o&&(m.content=o+(m.content||""),m.format="raw"),this._sendLog("autoLog",m,r,t,i,v),this._formattingOpts={},this._loggingValue=!1},_evaluateExpressions:function(t,i,n,r,o,s,a){var l=this._expressionsToEvaluate&&this._expressionsToEvaluate[t],c={expressionsToEvaluate:l};l||(c.depth=0),a&&(c.proxyValue=!0);var u=1&o;u&&(c.autoExpand=!0,c.depth=1,c.strLength=e.$_$logLimits.values.autoExpand.stringLength);var h=this._evaluate(i,n,c,t,r,s);return(h.data||{}).id=t,(h.data||{}).autoExpand=!!u,h},_maybeHtml:function(e){return e=e.trim().slice(0,500),u.test(e)||h.test(e)}},e.$_$doNotInit)e.$_$Tracer=d;else{var f=new d;f.setGlobalErrorHandler();var p=function(e,t){return t-e};e.performance?f._time=function(){return e.performance.now()}:e.process&&e.process.hrtime?(f._time=function(){return e.process.hrtime()},p=function(e,t){return 1e3*(t[0]-e[0])+(t[1]-e[1])/1e6}):f._time=function(){return+new Date},f._logTime=function(t,i,n,r,o,s,a,l,c){var u=this;if(u._looksLikePromise(a)){var h=e.$_$session;a.then(function(a){e.$_$session===h&&u._logTime(t,i,n,r,o,s,a,u._time(),c)})["catch"](function(a){e.$_$session===h&&u._logTime(t,i,n,r,o,s,a,u._time(),c)})}else{var d=p(s,l),g=f._autoTimeHits[n];g?(g.value&&(g.n=1,g.min=g.value,g.max=g.value,g.total=g.value,delete g.value),g.min=Math.min(g.min,d),g.max=Math.max(g.max,d),g.total+=d,g.n+=1):f._autoTimeHits[n]={value:d,context:o,fileId:t,rangeId:i,logMarkerContext:c}}return a},f.$_$w=f.$_$w_=e.$_$w=e.$_$w_=function(e,t){f.statement(e,t)},e.$_$wp=function(e){return f._reportProgramScope("programScopeStart",e),f.scopeStart(e),f._executionContext()},e.$_$wpe=function(e){f._reportProgramScope("programScopeEnd",e)},f.$_$wf=e.$_$wf=function(e){f.scopeStart(e)},f.$_$wv=e.$_$wv=function(t,i,n,r,o,s,a,l,c,u){var h=f._consoleHits[n]||0;l?f._identifierExpressionAutoLogHitLimit?h<f._identifierExpressionAutoLogHitLimit?f._doWhenReceiverIsReady(function(){f._autoLogValue(t,i,h,o,s,a,l,c,u)},arguments):h===f._identifierExpressionAutoLogHitLimit&&f._doWhenReceiverIsReady(function(){f._sendLog("log",{content:"Only the first "+f._identifierExpressionAutoLogHitLimit+" values are automatically logged, use console.log("+(o||"...")+") for the full output",format:"raw"},o,t,i)},arguments):h||f._doWhenReceiverIsReady(function(){f._autoLogValue(t,i,h,o,s,a,l,c,u)},arguments):f._logLimit?h<f._logLimit?f._doWhenReceiverIsReady(function(){f._autoLogValue(t,i,h,o,s,a,l,c,u)},arguments):h===f._logLimit&&f._doWhenReceiverIsReady(function(){f._sendLog("log",{content:"Only the first "+f._logLimit+" values are automatically logged. Increase this limit with the `logLimit` setting.",format:"raw"},o,t,i)},arguments):f._doWhenReceiverIsReady(function(){f._autoLogValue(t,i,h,o,s,a,l,c,u)},arguments),f._consoleHits[n]=h+1;var d=2&c&&"object"==typeof s&&e.Proxy&&e.WeakMap;return!d||u&&u.traceId?s:f._createProxy({fileId:t,rangeId:i,hitCount:h,context:o,val:s,exp:a,singleHit:l,evalOpts:c,logMarkerContext:u})},e.$_$tracer=f,e.$_$coverage=e.$_$coverage||[],e.$_$reuseableTracer||(e.$_$tracer._expressionsToEvaluate=e.$_$expressionsToEvaluate||{});var g=function(e){return e.path},v=function(e){return e?e.replace(/\\/g,"/"):e},y=e.$_$testFiles&&(e.$_$testFiles||[]).map(g).map(v),m=e.$_$testFiles&&e.$_$testFiles.filter(function(e){return e.loaded}).map(g);f.initLoadingPhase(),e.wallaby={delayStart:function(){f._patchFrameworks(),f._delayStart=!0},start:function(){f._delayStart=!1,f.start()},_startWhenReceiverIsReady:function(e){f._shouldReportProgramScope=!0,f._doWhenReceiverIsReady(function(){e()})},tests:y,loadedTests:m,baseDir:e.$_$baseDir,slowTestThreshold:e.$_$slow||75}}}(function(){return this}()||global)},{}],67:[function(e,t,i){"use strict";var n=e("path"),r=e("uuid"),o=e("querystring"),s=e("http"),a={Atom:"AT",VSCode:"VSC",Sublime:"ST",IntelliJ:"IJ",VS:"VS"},l=function(){function e(e,t){if(e&&_.isString(t)){var i=e.client&&a[e.client];i&&e.edition&&(i=i+"-"+e.edition.toUpperCase());var o=e.cidFile;this._client=i||(~t.indexOf("wallaby-vscode")?"VSC":~t.indexOf(".wallaby")?"VS":~t.indexOf("atom-wallaby")?"AT":~t.indexOf("Sublime")?"ST":"IJ"),o||(o="VS"===this._client?n.join(t,"..","..","t.id"):"VSC"===this._client?n.join(t,"..","..","..",".wtid"):n.join(t,"..","t.id"));var s;try{s=e.readFileSync(o)}catch(l){s=r.v4();try{e.writeFileSync(o,s)}catch(c){}}this._cid=s||r.v4(),this._heartBeatTid=process.env.quokka?"UA-58409118-5":"UA-58409118-3",this._telemetryTid=process.env.quokka?"UA-58409118-8":"UA-58409118-7",this._coreVersion=e.coreVersion||"unknown",this._sendHeartbeat=!0,this._featureUseTelemetry=void 0}}return e.prototype.start=function(e){try{this._env=("browser"===e.env.type?e.env.kind:e.env.type)+" "+e.testFramework.version.substr(0,e.testFramework.version.indexOf("@"))+(e.testFramework.autoDetected?".auto":"")}catch(t){this._env="unknown"}var i=this;this._heartbeatInterval=setInterval(function(){return i._heartbeat()},3e5),this._started=!0,i._heartbeat()},e.prototype.editorDataEvent=function(e){if(this._started){switch(e.event){case"vscode.liveShare.available":return;case"vscode.liveShare.started":return}this._event(this._telemetryTid,e.event,e.event,e.event)}},e.prototype.dispose=function(){clearInterval(this._heartbeatInterval),clearTimeout(this._sendPendingFeatureUseTelemetryTimeout)},e.prototype.busy=function(){this._sendHeartbeat=!0},e.prototype.featureUsed=function(e){var t=this,i=void 0===this._featureUseTelemetry;this._featureUseTelemetry||(this._featureUseTelemetry={}),this._featureUseTelemetry[e]=1,i&&(this._sendPendingFeatureUseTelemetryTimeout=setTimeout(function(){return t._sendPendingFeatureUseTelemetry()},1e4))},e.prototype.appendToTrackingClient=function(e){this._client=this._client+"-"+e},e.prototype._sendPendingFeatureUseTelemetry=function(){var e=this;if(this._started&&this._telemetryTid&&this._featureUseTelemetry){var t=this._featureUseTelemetry;this._featureUseTelemetry=null,Object.keys(t).forEach(function(t){e._event(e._telemetryTid,t,t,t)})}},e.prototype._heartbeat=function(){this._sendHeartbeat&&(this._event(this._heartBeatTid,this._env,this._coreVersion,this._client),this._telemetryTid&&this._event(this._telemetryTid,"heartbeat","heartbeat","heartbeat"),this._telemetryTid&&this._sendPendingFeatureUseTelemetry()),delete this._sendHeartbeat},e.prototype._event=function(e,t,i,n){try{var r=o.stringify({v:1,tid:e,cid:this._cid,t:"event",ec:t,ea:i,el:n}),a={hostname:"www.google-analytics.com",path:"/collect",method:"POST",headers:{"Content-Length":r.length}},l=s.request(a,function(e){e.on("data",_.noop),e.on("end",_.noop)});l.on("error",_.noop),l.write(r),l.end()}catch(c){}},e}();t.exports=l},{http:void 0,path:void 0,querystring:void 0,uuid:void 0}],68:[function(e,t,i){"use strict";var n,r=e("./typeScriptVisitor"),o=e("./utils"),s=e("./typeScriptUtils"),a=e("semver"),l="2.1.5",c=function(){function e(e,t){this._useTsconfigFile=!0,this._opts=s.createOptions(n,e||{},this),this._useTsconfigFile&&(this._opts=s.mergeTsConfigOptions(n,this._opts,t)),this._opts.isolatedModules=!0,this._opts.suppressOutputPathCheck=!0,this._opts.allowNonTsExtensions=!0,this._opts.noLib=!0,this._opts.lib=void 0,this._opts.types=void 0,this._opts.noEmit=void 0,this._opts.noEmitOnError=void 0,this._opts.paths=void 0,this._opts.rootDirs=void 0,this._opts.declaration=void 0,this._opts.declarationDir=void 0,this._opts.out=void 0,this._opts.outFile=void 0,this._opts.noResolve=!0,this._visitor=new r(n)}return e.prototype.run=function(e){this._code="",this._ranges=[];var t=this._opts,i=e.path,r=n.createSourceFile(i,e.content,t.target);this._ranges=this._visitor.visit(r);var o=n.transpileModule(e.content,{fileName:i,compilerOptions:t,reportDiagnostics:!0});this._code=o.outputText;var a=o&&o.diagnostics;if(a&&a.length)throw new Error(_.reduce(a,function(e,t){var i=s.formatErrorText(n,t);return e[i]||(e[i]=i,e.message+="\n  - "+i),e},{message:"TypeScript compiler errors:"}).message);if(o.emitSkipped)return e.content;var l=o.sourceMapText&&JSON.parse(o.sourceMapText);if(!l)throw new Error("Cannot find source map for "+i);return this._noRename||e.changeExt("js"),{map:l,code:this._code,ranges:this._ranges}},e}();t.exports=function(t){return function(i){if(i.typescript)n=i.typescript;else try{n=o.requireModuleFrom(t,"typescript")}catch(r){n=e("typescript")}if(a.valid(n.version)&&a.lt(n.version,l))throw new Error("TypeScript version for compiler must be >= "+l);delete i.typescript;var s=new c(i,t);return function(e){return s.run(e)}}}},{"./typeScriptUtils":70,"./typeScriptVisitor":71,"./utils":72,semver:void 0,typescript:void 0}],69:[function(e,t,i){"use strict";var n,r=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},o=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},s=e("path"),a=e("graceful-fs"),l=e("minimatch"),c=e("semver"),u=e("./utils"),h=e("./typeScriptUtils"),d=e("./typeScriptVisitor"),f="1.5.3",p=function(){function e(e,t){var i=this,r=this;e=e||{},this._filePatterns=[],this._localProjectDir=t,this._useTsconfigFile=!0,e.files?(this._opts=!1,_.each(e.files,function(e,t){r._filePatterns.push(t),e=e||{};var o=h.createOptions(n,e,i);r._opts||(r._opts=o)})):(this._filePatterns.push("**/*.ts?(x)"),this._opts=h.createOptions(n,e,this)),this._allTrackedFiles={},this._allFiles={},this._ts=1}return e.prototype.createPostprocessor=function(){var e=this,t=this,i=function(i){var r=i.logger;t._ts++;var o=t._filesToBeCompiled(i.affectedFiles,void 0,i.dot);if(!t._compiler||i.anyFilesAdded||i.anyFilesDeleted)if(t._compiler?i.tsPostprocessorOnly||r.debug("TypeScript language service is being re-created because some tracked files were added or deleted"):r.debug("New TypeScript language service is required"),t._allTrackedFiles=t._filesToBeCompiled(i.allFiles,function(e){return t._allFiles[e.fullPath]=e},i.dot),t._compiler&&i.tsPostprocessorOnly)i.anyFilesDeleted&&(i.affectedFiles||[]).length===(i.allFiles||[]).length&&(o={});else{if(o=t._allTrackedFiles,_.isEmpty(o))return r.debug("TypeScript postprocessor will be removed because in %s project files none were found by patterns: %s",i.allFiles.length,t._filePatterns),Q.when({removePostprocessor:!0});r.trace("TypeScript compiler options module (before tsconfig.json): %s",(t._opts||{}).module),t._useTsconfigFile&&(t._opts=h.mergeTsConfigOptions(n,t._opts,t._localProjectDir,r),r.trace("TypeScript compiler options module (after tsconfig.json): %s",(t._opts||{}).module)),t._compiler=t._createLanguageService(i.baseDir),t._visitor||(t._visitor=new d(n))}else _.each(o,function(e){var i=t._allTrackedFiles[e.fullPath];i&&(i.ts=e.ts)});var a=[];return _.each(o,function(o){if(t._orderFilesByReferenceComments&&t._dependencies){var l=t._dependencies.files[o.path];l&&l.hash!==t._getFileDependencies(o).hash&&delete t._dependencies}var c=t._compiler.getEmitOutput(o.fullPath),u=t._compiler.getSyntacticDiagnostics(o.fullPath);if(c.emitSkipped){var d=u.concat(t._compiler.getSemanticDiagnostics(o.fullPath));if(e._logErrors(r,d),t._opts.noEmitOnError)throw new Error(_.reduce(d.concat(t._compiler.getCompilerOptionsDiagnostics()),function(e,t){var i=h.formatErrorText(n,t);return e[i]||(e[i]=i,e.message+="\n  - "+i),e},{message:"TypeScript compiler errors:"}).message)}else u&&u.length&&e._logErrors(r,u);var f=t._visitor.visit(t._compiler.getSourceFile?t._compiler.getSourceFile(o.fullPath):t._compiler.getProgram().getSourceFile(o.fullPath)),p={};c.outputFiles.forEach(function(e){var t=s.extname(e.name);".map"===t?p.sourceMap=e.text:".js"===t||".jsx"===t?p.code=e.text:r.debug("Unexpected output file: %s",e.name)}),p.sourceMap&&a.push(i.createFile({path:_.isUndefined(t._opts.module)||t._opts.module?t._changeExtToJs(o.path):o.path+".compiled.js",original:o,content:p.code,sourceMap:JSON.parse(p.sourceMap),ranges:f,order:o.order,load:o.initialLoad}))}),t._orderFilesByReferenceComments&&!t._dependencies&&t._updateFileOrder(),Q.all(a)};return i.filePatterns=t._filePatterns,i.ts=!0,i},e.prototype._logErrors=function(e,t){t.forEach(function(t){e.error(h.formatErrorText(n,t))})},e.prototype._updateFileOrder=function(){var e=this;e._dependencies={files:{},min:Number.POSITIVE_INFINITY},_.each(e._allTrackedFiles,function(t){return e._orderFilesByReferences(t,e._dependencies,{})});var t=e._dependencies.min;_.each(e._dependencies.files,function(e){e.file.test||e.file.setOrder(t++,!0)})},e.prototype._orderFilesByReferences=function(e,t,i){var n=this;if(!i[e.path]&&(i[e.path]=!0,!t.files[e.path])){e.test||(t.min=Math.min(t.min,e.order));var r=n._getFileDependencies(e);_.each(r.items,function(e){return n._orderFilesByReferences(e,t,i)}),t.files[e.path]||(t.files[e.path]={hash:r.hash,file:e})}},e.prototype._getFileDependencies=function(e){var t,i=this,r="";try{t=n.preProcessFile(e.getContentSync()).referencedFiles}catch(o){throw new Error("Failed to get file dependencies: "+o.stack)}var a=_(t).map(function(t){return i._allTrackedFiles[s.join(s.dirname(e.fullPath),t.fileName)]}).filter(function(e){return!_.isUndefined(e)}).map(function(e){return r+=e.path,e}).value();return{items:a,hash:u.quickHash(r)}},e.prototype._changeExtToJs=function(e){return e.substr(0,e.lastIndexOf(".")+1)+(_.endsWith(e,".js")?"jsts":"js")},e.prototype._createLanguageService=function(e){var t=this;if(!t._opts.noResolve){var i=n.resolveModuleName;n.resolveModuleName=function(r,o){var s=i.apply(this,arguments);if(s&&!s.resolvedModule){arguments[1]=o.replace(n.normalizePath&&n.normalizePath(e)||e,n.normalizePath&&n.normalizePath(t._localProjectDir)||t._localProjectDir);var a=i.apply(this,arguments);if(a&&a.resolvedModule)return a}return s}}var l={},c={};return n.createLanguageService({getScriptFileNames:function(){return o(o([],r(t._opts.typeRoots?t._opts.typeRoots.filter(function(e){return e.endsWith(".d.ts")}):[]),!1),r(Object.keys(t._allTrackedFiles)),!1)},getScriptVersion:function(e){e=s.normalize(e);var i=t._allTrackedFiles[e];return i&&i.ts.toString()},readFile:function(e){return(this.getScriptSnapshot(e)||{}).text},fileExists:function(e){if(e=s.normalize(e),t._opts.noResolve||!~e.indexOf(t._localProjectDir))return!1;var i=c[e];if(i===!1||i)return i;var n=s.dirname(e),r=l[n];return r===!1?(c[e]=!1,!1):(i=c[e]=a.existsSync(e),i?(l[n]=!0,!0):r?void 0:(l[n]=a.existsSync(n),!1))},getScriptSnapshot:function(i){i=s.normalize(i);var r=t._allFiles[i];if(r)return n.ScriptSnapshot.fromString(r.getContentSync());if(t._opts.noEmitOnError||!t._opts.noResolve)try{var o=i.replace(e,t._localProjectDir);if(a.existsSync(o))return n.ScriptSnapshot.fromString(a.readFileSync(o).toString())}catch(l){}},getCurrentDirectory:function(){return e},getCompilationSettings:function(){return t._opts},getDefaultLibFileName:function(e){return n.getDefaultLibFilePath(e)},getCustomTransformers:function(){return t._getCustomTransformers?t._getCustomTransformers(t._compiler.getProgram()):void 0},getProjectVersion:function(){return t._ts}},n.createDocumentRegistry())},e.prototype._filesToBeCompiled=function(e,t,i){var n=this;return t=t||function(){},_.reduce(e,function(e,r){var o=0===(r.path||"").indexOf("..")?s.basename(r.path):r.path;return _.find(n._filePatterns,function(e){return l(o,e,{dot:i})})&&(e[r.fullPath]=r),t(r),e},{})},e}();t.exports=function(t){return function(i){if(i.typescript)n=i.typescript;else try{n=u.requireModuleFrom(t,"typescript")}catch(r){n=e("typescript")}if(c.valid(n.version)&&c.lt(n.version,f))throw new Error("TypeScript version for compiler must be >= "+f);return delete i.typescript,new p(i,t).createPostprocessor()}}},{"./typeScriptUtils":70,"./typeScriptVisitor":71,"./utils":72,"graceful-fs":void 0,minimatch:void 0,path:void 0,semver:void 0,typescript:void 0}],70:[function(e,t,i){var n=e("path"),r=e("graceful-fs");t.exports={createOptions:function(e,t,i){t&&(i._orderFilesByReferenceComments||(i._orderFilesByReferenceComments=t.orderFilesByReferenceComments),delete t.orderFilesByReferenceComments,i._useStandardDefaults||(i._useStandardDefaults=t.useStandardDefaults),delete t.useStandardDefaults,i._getCustomTransformers||(i._getCustomTransformers=t.getCustomTransformers),delete t.getCustomTransformers,i._useTsconfigFile&&(i._useTsconfigFile=t.tsconfig!==!1),delete t.tsconfig);var n=this._normaliseOptions(e,t)||{},r={noLib:!0,noResolve:!0,noEmit:!1,removeComments:!1},o={sourceMap:!0,inlineSourceMap:!1,inlineSources:!1,declarationMap:!1,rootDir:void 0,mapRoot:void 0,outFile:void 0,noEmitOnError:!1,composite:!1,declaration:!1};return i._useStandardDefaults&&(delete r.noLib,delete r.noResolve,delete o.declaration,delete o.noEmitOnError,delete o.composite),_.extend(r,n,o)},getCompilerOptions:function(e,t){return this._normaliseOptions(e,e.parseJsonConfigFileContent?e.parseJsonConfigFileContent(e.parseConfigFileTextToJson(t,r.readFileSync(t).toString()).config,e.sys,e.getDirectoryPath(e.normalizePath(t)),{},t).options:e.readConfigFile(t,function(e){return r.readFileSync(e).toString()}).config.compilerOptions)},mergeTsConfigOptions:function(t,i,o,s){void 0===s&&(s={debug:function(){}});var a,l=n.join(o,"tsconfig.json");try{a=t.parseJsonConfigFileContent?t.parseJsonConfigFileContent(t.parseConfigFileTextToJson(l,r.readFileSync(l).toString()).config,_.extend(t.createCompilerHost(t.getDefaultCompilerOptions()),{readDirectory:t.sys.readDirectory}),t.getDirectoryPath(t.normalizePath(l)),{},l).options:t.readConfigFile(l,function(e){return r.readFileSync(e).toString()}).config.compilerOptions}catch(c){s.debug("Error parsing tsconfig file "+l+"\n("+c.message+")");try{a=e(l).compilerOptions}catch(u){s.debug("Error reading tsconfig file from "+l+"\n("+u.message+")")}}var h;return a?(a.allowJs&&!i.outDir&&delete i.outDir,h=_.extend({},this._normaliseOptions(t,a)||{},i)):h=i,h.allowJs||delete h.outDir,h},formatErrorText:function(e,t){var i=e.flattenDiagnosticMessageText(t.messageText,"\n");if(t.file){var n=t.file.getLineAndCharacterOfPosition(t.start);return"Error "+t.file.fileName+" ("+(n.line+1)+","+(n.character+1)+"): "+i}return"Error: "+i},_normaliseOptions:function(e,t){var i=this;if(t)return this._optionDeclarations||(this._optionDeclarations=_.reduce(e.optionDeclarations,function(e,t){return e[t.name]=t,e},{})),_.each(t,function(e,n){var r=i._optionDeclarations[n];r&&(_.isObject(r.type)&&_.isString(e)?t[n]=i._getNormalisedValue(e,r.type):"list"===r.type&&_.isArray(e)&&r.element&&_.isObject(r.element.type)&&(t[n]=_.map(e,function(e){return _.isString(e)?i._getNormalisedValue(e,r.element.type)||e:e})))}),t},_getNormalisedValue:function(e,t){return _.isFunction(t.get)?t.get(e.toLowerCase()):t[e.toLowerCase()]}}},{"graceful-fs":void 0,path:void 0}],71:[function(e,t,i){"use strict";var n=function(){function e(e){var t=this,i={};this._ts=e,i[e.SyntaxKind.DoStatement]=i[e.SyntaxKind.WhileStatement]=i[e.SyntaxKind.IfStatement]=i[e.SyntaxKind.SwitchStatement]=function(e){e.expression&&t._pushRange(e.expression)},i[e.SyntaxKind.ForStatement]=function(e){e.condition&&t._pushRange(e.condition)},i[e.SyntaxKind.ForInStatement]=i[e.SyntaxKind.ForOfStatement]=function(e){e.expression&&t._pushRange(e.expression)},i[e.SyntaxKind.BreakStatement]=i[e.SyntaxKind.ContinueStatement]=i[e.SyntaxKind.ThrowStatement]=function(e){t._pushRange(e)},i[e.SyntaxKind.VariableStatement]=function(i){(!t._parent||t._parent.kind!==e.SyntaxKind.ForStatement&&t._parent.kind!==e.SyntaxKind.ForInStatement&&t._parent.kind!==e.SyntaxKind.ExportAssignment)&&t._pushRange(i)},i[e.SyntaxKind.ExpressionStatement]=i[e.SyntaxKind.ReturnStatement]=function(e){t._pushRange(e)},i[e.SyntaxKind.ConditionalExpression]=function(e){t._pushRange(e.whenTrue),t._pushRange(e.whenFalse)},i[e.SyntaxKind.BinaryExpression]=function(e){t._pushRange(e.left),t._pushRange(e.right)},i[e.SyntaxKind.ArrowFunction]=function(e){e.body.statements||t._pushRange(e.body)},t._visit=function(n){var r=i[n.kind];r&&r(n),t._parent=n,e.forEachChild(n,t._visit)}}return e.prototype.visit=function(e){var t=this;return t._ranges=[],t._parent=null,t._sourceFile=e,t._visit(e),t._parent=null,t._sourceFile=null,t._ranges.slice()},e.prototype._pushRange=function(e){this._ranges.push(this._getRange(e))},e.prototype._getRange=function(e){var t=this._ts.getLineAndCharacterOfPosition(this._sourceFile,e.getStart(this._sourceFile)),i=this._ts.getLineAndCharacterOfPosition(this._sourceFile,e.getEnd());return[t.line+1,t.character,i.line+1,i.character]},e}();t.exports=n},{}],72:[function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):r(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o["return"]:i[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return s},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=e("path"),c=e("fs"),u=e("./extension/shared/utils").normalizePath,h=e("source-map").SourceMapConsumer,d=e("source-map").SourceMapGenerator,f=/^\s*(\/\*\*?(.|\r?\n)*?\*\/)/,p=/^\s*/,g=/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g,v=/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,y=/(^[\s]*?(fit|fdescribe)[\s]*?|[^.\w\s][\s]*?(fit|fdescribe)[\s]*?|(test|test\.concurrent|it|describe)[\s]*?\.[\s]*?only[\s]*?)((\.each[\s]*?(`[^`]*?`[\s]*?)*?)?\([\s]*?[^)\s])/gm,m=/[#@] sourceMappingURL=([^\s'"]*)/,b=RegExp("(?:/\\*(?:\\s*\r?\n(?://)?)?(?:"+m.source+")\\s*\\*/|//(?:"+m.source+"))\\s*","g"),k=/data:application\/json[^,]+base64,/,T=function(e,t){return"js"===e||"jsx"===e||"es6"===e||"es7"===e||"mjs"===e||t&&t.find(function(t){return e===t})},S=function(e){return"ts"===e||"tsx"===e},C=function(e){return"vue"===e},L=function(e){return"svelte"===e},j=function(e,t){return"coffee"===e||/\.(litcoffee|coffee\.md)$/.test(t||"")},w={},x={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(function(e,t){w[e]=t,x[t]=e});var F="\n//",E="_$_$w_id",R=5;t.exports={selectedTestRegExp:y,SourceMapConsumer:h,randomId:function(){return Math.random().toString(36).substr(2,R)},addWallabyRandomIdCommentToFileContent:function(e,t){return e+F+(t||this.randomId())+E},removeWallabyRandomIdCommentFromFileContent:function(e){return _.endsWith(e,E)?e.slice(0,-(F.length+R+E.length)):e},noopTrue:function(){return!0},noopTruePromise:function(){return Q.fcall(this.noopTrue)},isPatch:function(e){return e&&e.length>2&&"@"===e[0]&&"@"===e[1]},isLevelUpRelativePath:function(e){return e&&"."===e[0]&&"."===e[1]},docBlockComment:function(e){var t=e.match(f);return t?t[0].replace(p,"")||"":""},normalizePath:function(e){return e?e.replace("win32"===process.platform?"file:///":"file://","").split(l.sep).join("/"):e},fileUrl:function(e){var t=l.resolve(e).replace(/\\/g,"/");return"/"!==t[0]&&(t="/"+t),encodeURI("file://"+t)},trimSlashes:function(e){return e?e.replace(/^\/|\/$/g,""):e},platformDependentPath:function(e){return!e||"win32"!==process.platform||~e.indexOf(l.sep)?e:e.split("/").join(l.sep)},getSourceMapFromCode:function(e){b.lastIndex=0;for(var t;null!==(t=b.exec(e));){var i=t?t[1]||t[2]||"":null;if(i&&k.test(i)){var n=i.slice(i.indexOf(",")+1);return Buffer.from(n,"base64").toString()}}},pathMatchesPattern:function(t,i,n){if(t){if("string"==typeof i){if(!n||!n.micromatch){var r=e("minimatch");return r(t,i,n)}var o=e("micromatch").isMatch;return o(t,i,{dot:!0})}return(this.platformDependentPath(n&&n.absolute?"":"./")+this.platformDependentPath(t)).match(i)}},escapePathForRegex:function(e){return"\\"===l.sep&&(e=e.replace(/\\/g,"/")),this.replacePathSepForRegex(this.escapeRegExp(e))},escapeRegExp:function(e){return e.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")},replacePathSepForRegex:function(e){return"\\"===l.sep?e.replace(/(\/|(.)?\\(?![[\]{}()*+?.^$|\\]))/g,function(e,t,i){return i&&"\\"!==i?i+"\\\\":"\\\\"}):e},displayTestName:function(e){return e.replace(/\r?\n|\r/g," ").replace(/\s\s+/g," ")},getOriginalLineByGeneratedLine:function(e,t,i){var n=e[t];if(n){if(n=this._decodeMapping(n),n>0)return n;i&&(i-=1);for(var r=0;r<n.length;r++){if(n[r].column===i)return n[r].line;if(i<n[r].column)return 0===r?n[0].line:n[r-1].line}return n[n.length-1].line}},_decodeMapping:function(e){if(_.isUndefined(e)||_.isObject(e))return e;if(_.isNumber(e))return e;for(var t,i=[],n=0,r=0,o=0;o<e.length;o+=1){var s=w[e[o]],a=32&s;if(s&=31,r+=s<<n,a)n+=5;else{var l=1&r;r>>>=1;var c=l?0===r?-2147483648:-r:r;t>=0?(i.push({line:t,column:c}),t=void 0):t=c,r=n=0}}return i},_encodeMapping:function(e,t,i){var n=e[t];if(!_.isObject(n))return n;var r=Object.values(n);if(i&&1===r.length&&0===r[0].originalColumn&&0===r[0].generatedColumn&&i[t])return i[t];if(1!==r.length&&r.find(function(e){return e.originalLine!==r[0].originalLine})){r.sort(function(e,t){return e.generatedColumn-t.generatedColumn});var o="";o+=this._encodeInteger(r[0].originalLine),o+=this._encodeInteger(r[0].generatedColumn);for(var s=0,a=1;a<r.length;a++)if(r[a].originalLine!==r[a-1].originalLine){if(s++,s>2e3)return r[0].originalLine;o+=this._encodeInteger(r[a].originalLine),o+=this._encodeInteger(r[a].generatedColumn)}return o}return r[0].originalLine},_encodeInteger:function(e){var t="";e<0?e=-e<<1|1:e<<=1;do{var i=31&e;e>>>=5,e>0&&(i|=32),t+=x[i]}while(e>0);return t},generateLineMappings:function(e,t){var i=this,n={},r=Object.keys(e);return r.forEach(function(r){n[r]=i._encodeMapping(e,r,t)}),n},_previousLineMapNextGreaterThanOrEqualTo:function(e,t){for(var i=0,n=e.length-1,r=-1;i<=n;){var o=parseInt((i+n)/2,10);e[o].column<t?i=o+1:(r=o,n=o-1)}return 0===r&&(r=1),r===-1&&(r=e.length),r},_previousLineMapNextGreaterThan:function(e,t){for(var i=0,n=e.length-1,r=-1;i<=n;){var o=parseInt((i+n)/2,10);e[o].column<=t?i=o+1:(r=o,n=o-1)}return 0===r&&(r=1),r===-1&&(r=e.length),r},updateFileMap:function(e,t){var i=this,r=_.extend({},e);return _.each(t,function(t){var o=new h(t),s={},a=_.isEmpty(r);o.eachMapping(function(e){if(e.originalLine&&e.generatedLine)if(a)s[e.generatedLine]||(s[e.generatedLine]={}),s[e.generatedLine][e.generatedColumn]&&!e.name||(s[e.generatedLine][e.generatedColumn]=n({},e));else if(r[e.originalLine]){if(s[e.generatedLine]&&s[e.generatedLine][e.generatedColumn]&&!e.name)return;var t=r[e.originalLine]=i._decodeMapping(r[e.originalLine]);if(!t)return;if(t>0)s[e.generatedLine]||(s[e.generatedLine]={}),s[e.generatedLine][e.generatedColumn]=n(n({},e),{originalLine:t,originalColumn:0});else{var o=i._previousLineMapNextGreaterThan(t,e.originalColumn);s[e.generatedLine]||(s[e.generatedLine]={}),s[e.generatedLine][e.generatedColumn]=n(n({},e),{originalLine:t[o-1].line,originalColumn:t[o-1].column})}}}),r=i.generateLineMappings(s,e)}),r},formatInstrumentationError:function(e,t,i){var n=(e&&(e.stack||e.message))+"",r=this.textLines(n),o=r[0],s=o.match(/^SyntaxError.*\((\d+):(\d+)\)$/);return s&&(r=[this.codeFrame(t,parseInt(s[1],10),parseInt(s[2],10)+1,o)]),Error("Failed to instrument "+i+"\n"+r.join("\n"))},combineSourceMaps:function(e,t){if(!e)return t;if(!t)return e;var i=new h(t),n=new h(e),r=new d;i.eachMapping(function(e){if(null!=e.originalLine){var t=n.originalPositionFor({line:e.originalLine,column:e.originalColumn});null!=t.source&&r.addMapping({original:{line:t.line,column:t.column},generated:{line:e.generatedLine,column:e.generatedColumn},source:t.source,name:t.name||e.name})}});var o=[n,i];return o.forEach(function(e){
e.sources.forEach(function(t){r._sources.add(t);var i=e.sourceContentFor(t);null!=i&&r.setSourceContent(t,i)})}),r._sourceRoot=e.sourceRoot,r._file=e.file,JSON.parse(r.toString())},mapTextPosition:function(e,t){var i;if(e)if(t){var n={line:e.line,column:e.column};n.source=t.sources&&t.sources[0]||".",n.bias=2,i=t.generatedPositionFor(n)}else i=e;return i},textIndexPosition:function(e,t){var i=this.textLines(e,t);return{line:i.length,column:i[i.length-1].length}},mapTransformedRangeToOriginal:function(e,t){var i=function(e,t,i){var n=e.originalPositionFor({line:t,column:i,bias:1});return null===n.source?e.originalPositionFor({line:t,column:i,bias:2}):n},n=function(e,t){var i=e.originalPositionFor({line:t.line,column:t.column-1});if(null===i.source)return null;var n=e.generatedPositionFor({source:i.source,line:i.line,column:i.column+1,bias:2});return null===n.line||e.originalPositionFor(n).line!==i.line?{source:i.source,line:i.line,column:1/0}:e.originalPositionFor(n)},r={start:{line:t[0],column:t[1]},end:{line:t[2],column:t[3]}},o=i(e,r.start.line,r.start.column),s=n(e,r.end);return o&&s&&o.source&&s.source?o.source!==s.source?null:null===o.line||null===o.column?null:null===s.line||null===s.column?null:(o.line===s.line&&o.column===s.column&&(s=e.originalPositionFor({line:r.end.line,column:r.end.column,bias:2}),s.column=s.column-1),[o.line,o.column,s.line,s.column]):null},mapOriginalRangeToTransformed:function(e,t){var i=s(t,4),n=i[0],r=i[1],o=i[2],a=i[3];if(!e)return[n,r,o,a];var l={line:n,column:r};l.source=e.sources&&e.sources[0]||".";var c=e.generatedPositionFor(l),u={line:o,column:a};u.source=e.sources&&e.sources[0]||".",u.bias=2;var h=e.generatedPositionFor(u);if(c&&h&&null!==c.line&&null!==c.column){if(null===h.line||null===h.column){if(null===c.line||null===c.column)return;h.source=c.source,h.line=c.line,h.column=1/0}return h.line<c.line&&(h.line=c.line),c.line===h.line&&h.column<c.column&&(h.column=1/0),null===c.column&&(c.column=0),null===h.column&&(h.column=0),[c.line,c.column,h.line,h.column]}},textLines:function(e,t,i){return e=_.isUndefined(t)||t===e.length-1?e:e.substr(0,t),e.split(_.isUndefined(i)?/\r\n|\r|\n/:i)},instrumentableRange:function(e,t){var i=s(t,4),n=i[0],r=i[1],o=i[2],a=i[3];if(o-n>500)return t;if(!(o<n||o===n&&a<r)){var l=_.textLines(e);n<1&&(n=1),o>l.length&&(o=l.length),r<0&&(r=0);for(var c=!1,u=n;u<=o;u++){var h=l[u-1];n=u;for(var d=u===o&&a<=h.length?a:h.length,f=r;f<=d;f++)if(r=f,h.charAt(f).trim().length){c=!0;break}if(c)break;r=0}if(c){for(var u=o;u>=n;u--){var h=l[u-1];o!==u&&(o=u,a=h.length);for(var p=u===n&&n>=0?r:0,g=!1,f=a;f>=p;f--){if(h.charAt(f).trim().length){g=!0;break}a=f}if(g)break}return[n,r,o,a]}}},verifyLocalOrigin:function(t,i){if(!t)return!0;var n=!1;try{var r=e("url").parse(t).hostname;n="localhost"===r||"0.0.0.0"===r||"127.0.0.1"===r||"::1"===r}catch(o){}return n||i||console.error("wallaby.js refused to accept connection from "+t),n},patchModule:function(t,i){var n=e("module").Module.prototype,r=n.require;n.require=function(e){return e===t?i(r.bind(this)):r.call(this,e)}},patchModulesCode:function(e,t){var i={};e.forEach(function(e){e.files.forEach(function(t){i[t]=(i[t]||[]).concat(e.replacements)})});var n="node_modules/",r=function(e){return e=e.replace(/\\/g,"/"),e.substr(e.lastIndexOf(n)+n.length)},o=c.readFileSync;c.readFileSync=function(e){var n=o.apply(this,arguments),s=r(e),a=i[s];return a&&(n=n.toString(),a.forEach(function(i){var r=n;n=n.split(i.from).join(i.to),i.optional||n!==r||console.warn(t+" ("+e+")")})),n}},requireModuleFrom:function(t,i){try{return e(l.join(t,"node_modules",i))}catch(n){var r=e("module"),o=new r(".",null);return o.filename=l.join(t,"wallaby.js"),o.paths=r._nodeModulePaths(t),r._load(i,o,!1)}},resolveModulePathFrom:function(t,i){var n=e("module"),r=new n(".",null);return r.filename=l.join(t,"wallaby.js"),r.paths=n._nodeModulePaths(t),n._resolveFilename(i,r,!1)},tryRequireModuleWithPathFrom:function(t,i,n){try{var r=e("module"),o=new r(".",null);o.filename=l.join(t,"wallaby.js"),o.paths=r._nodeModulePaths(t);var s=r._resolveFilename(i,o,!1),a=void 0;return a=process.env.WALLABY_INTEGRATION_TEST_RUN||process.env.WALLABY_UNIT_TEST_RUN?e(s):r._load(i,o,!1),{module:a&&a["default"]||a,moduleExports:a,path:s}}catch(c){if(n)throw c}},nodeModulesLookup:function(t,i){var n=e("module").Module,r=n.prototype,o=n._nodeModulePaths,s=r.require;n._nodeModulePaths=function(e){var i=o.call(this,e);return t(i,e,o,this),i},i&&(r.require=function(e){return s.call(this,i(e))})},nodeModulePaths:function(t){var i=e("module");return i._nodeModulePaths(t)},patchBabelResolve:function(e){var t=this.nodeModulePaths(e);this.patchModule("resolve",function(e){var i=e("resolve"),n=i.sync;return i.sync=function(e,i){return~e.indexOf("babel")&&i&&(arguments[1].paths=(i.paths||[]).concat(t)),n.apply(this,arguments)},i})},hasAnsi:function(e){return e&&"string"==typeof e&&e.match(g)},removeAnsi:function(e){return e&&"string"==typeof e?e.replace(g,""):e},copyToClipboard:function(t){var i=function(e){return e&&console.warn("May have failed to copy to clipboard. "+("linux"===process.platform?'Linux/Ubuntu environments require "xclip" to be installed. ':"")+(e&&e.message))};try{e("copy-paste").copy(t,i)}catch(n){i(n)}},testFileSelection:function(e,t,i,n){if(_.isString(t)){var r=t;t={test:function(e){return!!~e.indexOf(r)}}}if(_.isString(i)){var o=i;i={test:function(e){return!!~e.indexOf(o)}}}var s,a=!1,l=!1,c={};for(v.lastIndex=0;null!==(s=v.exec(e));){for(var u=s.index+s[0].length,h=s.index;h<u;h++)c[h]=1;a=a||t.test(s[0]),l=l||i.test(s[0])}if(!a&&n)for(y.lastIndex=0;null!==(s=y.exec(e));)if(!c[s.index]){a=!0;break}return{includedTestFile:a,excludedTestFile:l}},codeFrame:function(e,t,i,r){function o(e,t,i){var r=n({column:0,line:-1},e.start),o=n(n({},r),e.end),s=i||{},a=s.linesAbove,l=void 0===a?2:a,c=s.linesBelow,u=void 0===c?3:c,h=r.line,d=r.column,f=o.line,p=o.column,g=Math.max(h-(l+1),0),v=Math.min(t.length,f+u);h===-1&&(g=0),f===-1&&(v=t.length);var y=f-h,m={};if(y)for(var _=0;_<=y;_++){var b=_+h;if(d)if(0===_){var k=t[b-1].length;m[b]=[d,k-d]}else if(_===y)m[b]=[0,p];else{var k=t[b-_].length;m[b]=[0,k]}else m[b]=!0}else d===p?d?m[h]=[d,0]:m[h]=!0:m[h]=[d,p-d];return{start:g,end:v,markerLines:m}}var s=this.textLines(e),a={start:{column:i,line:t}},l=o(a,s),c=l.start,u=l.end,h=l.markerLines,d=a.start&&"number"==typeof a.start.column,f=String(u).length,p=s.slice(c,u).map(function(e,t){var i=c+1+t,n=(" "+i).slice(-f),o=" "+n+" | ",s=h[i],a=!h[i+1];if(s){var l="";if(Array.isArray(s)){var u=e.slice(0,Math.max(s[0]-1,0)).replace(/[^\t]/g," "),d=s[1]||1;l=["\n ",o.replace(/\d/g," "),u,"^".repeat(d)].join(""),a&&r&&(l+=" "+r)}return[">",o,e,l].join("")}return" "+o+e}).join("\n");return d||(p=""+" ".repeat(f+1)+r+"\n"+p),p},loadJest:function(t,i,n){return r(this,void 0,void 0,function(){var r,s,a,c,u,h,d,f,p,g,v,y,m,_,b,k=this;return o(this,function(o){switch(o.label){case 0:s=!1;try{a=e(l.resolve(t,"package.json")),c=a&&a.scripts,u=a&&a.devDependencies||{},h=a&&a.dependencies||{},s=!!u.jest||!!h["react-scripts"]||!!h.jest,c&&c.test&&c.test.indexOf("react-app-rewired")!==-1?(this.tryRequireModuleWithPathFrom(t,"react-app-rewired/scripts/test"),this.tryRequireModuleWithPathFrom(t,"react-scripts/config/env"),r=this.tryRequireModuleWithPathFrom(t,"react-scripts/scripts/utils/createJestConfig")):!(c&&c.test&&c.test.indexOf("react-scripts")!==-1||!u)&&u.jest||c&&c.test&&c.test.indexOf("jest")!==-1&&c.test.indexOf("react-scripts")===-1||(r=this.tryRequireModuleWithPathFrom(t,"react-scripts/scripts/utils/createJestConfig"),this.tryRequireModuleWithPathFrom(t,"react-scripts/config/env"))}catch(T){r=void 0}if(i=i&&(l.isAbsolute(i)?i:l.resolve(l.join(t,i))),d=i?this.tryRequireModuleWithPathFrom(i,"jest"):r?this.tryRequireModuleWithPathFrom(r.path,"jest"):this.tryRequireModuleWithPathFrom(t,"jest"),p=d?d.path:t,v=this.tryRequireModuleWithPathFrom(p,"jest-cli"),!v)return[3,5];if(y=v.module.getVersion?function(){return v.module.getVersion()}:d&&d.module.getVersion?function(){return d.module.getVersion()}:void 0,!y)throw new Error("Cannot find compatible jest-cli module.");m="x.x.x",_=0;try{m=y(),_=parseInt(m.split(".")[0])}catch(T){throw new Error("Cannot detect/parse jest-cli module version: "+T.message+".")}if(_<24)throw new Error("Only Jest v24.x or higher is supported, but found v"+m+" at '"+v.path+"'.");if(f=this.tryRequireModuleWithPathFrom(v.path,"jest-config"),!f)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),n=n&&(l.isAbsolute(n)?n:l.resolve(l.join(t,n))),[4,f.module.readConfigs(n?{config:n}:r?{config:JSON.stringify(r.module(function(e){return l.resolve(r.path,"../../..",e)}))}:{},[t])];case 2:return g=o.sent(),g.globalConfig=Object.assign({},g.globalConfig),g.configs=(g.configs||[]).filter(function(e){return"jest-runner"===e.runner||~k.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~k.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}).map(function(e){return Object.assign({},e)}),[3,4];case 3:throw b=o.sent(),new Error("Failed to read Jest configuration from '"+t+"': "+(b.stack?b.stack:"unknown."));case 4:return[3,6];case 5:throw new Error("Module jest-cli is not found in '"+t+"'.");case 6:if(!g)throw new Error("Failed to read Jest configuration from '"+t+"'.");if(!g.configs.length)throw new Error("Can not find any Jest runner configurations in '"+t+"'.");return[2,{jestConfig:g,jestCLI:v,jestConfigLoader:f,isDirectDependency:s}]}})})},serializeRegExp:function(e){if(_.isRegExp(e))return"__REGEXP "+e.toString();if(_.isString(e))return e;throw new Error("Must pass a string or a regular expression")},deserializeRegExp:function(e){if(0===e.indexOf("__REGEXP ")){var t=e.split("__REGEXP ")[1].match(/\/(.*)\/(.*)?/);return new RegExp(t[1],t[2]||"")}return e},isJavaScript:T,isTypeScript:S,isVue:C,isSvelte:L,isCoffeeScript:j,isCoverable:function(e,t,i){return T(e,i)||S(e)||C(e)||j(e,t)||L(e)},quickHash:function(e){var t,i,n,r=0;if(e.length>0)for(t=0,n=e.length;t<n;t++)i=e.charCodeAt(t),r=(r<<5)-r+i,r|=0;return r},isWsl:function(){var t=e("os");if("linux"!==process.platform)return!1;if(t.release().toLowerCase().includes("microsoft"))return!0;try{return c.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")}catch(i){return!1}},wslHostIpAddress:function(){var e=c.readFileSync("/etc/resolv.conf").toString().split("\n").map(function(e){return e.split(" ")}).filter(function(e){return"nameserver"===e[0]}).map(function(e){return e.length>1&&e[1]});return 1===e.length?e[0]:"127.0.0.1"},lazyLoadDependencyReplacement:function(e,t,i){var n=void 0===i?{}:i,r=n.doubleQuotes,o=n.dependencyOverride,s=n.replaceBothDependencyAndDependencyOverride,a=n.varType;a=a||"var";var l=r?'require("'+t+'")':"require('"+t+"')",c=o||l,u=[{from:""+e,to:e+"()",optional:!0},{from:a+" "+e+"() = "+c+";",to:"var "+e+" = function() { const data = "+c+"; "+e+" = function() { return data; }; return data; }",optional:!0}];return s&&u.push({from:a+" "+e+"() = "+l+";",to:"var "+e+" = function() { const data = "+l+"; "+e+" = function() { return data; }; return data; }",optional:!0}),u},findFirstFileMatchingContentInDirectory:function(e,t){function i(e){var n,r,o=c.readdirSync(e);try{for(var s=a(o),u=s.next();!u.done;u=s.next()){var h=u.value,d=l.resolve(l.join(e,h));if(c.statSync(d).isDirectory()){var f=i(d);if(f)return f}else if(h.endsWith(".js")||h.endsWith(".mjs")){var p=c.readFileSync(d,"utf8");if(p.indexOf(t)!==-1)return d}}}catch(g){n={error:g}}finally{try{u&&!u.done&&(r=s["return"])&&r.call(s)}finally{if(n)throw n.error}}}return u(i(e))}}},{"./extension/shared/utils":41,"copy-paste":void 0,fs:void 0,micromatch:void 0,minimatch:void 0,module:void 0,os:void 0,path:void 0,"source-map":void 0,url:void 0}],73:[function(e,t,i){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};e("../../lib/global");var r=e("../../lib/utils");t.exports=function(e,t,i){var o,s,a,l;if(e){if(e.isCoverageIgnored)return{isCoverageIgnored:!0};for(var c={},u={},h=r.textLines(t,void 0,"\n"),d=0,f=0;f<h.length;f++){var p=h[f].length;u[f+1]={index:d,length:p},d+=p+1}if(e.liveComments){var g=[];try{for(var v=n(e.liveComments),y=v.next();!y.done;y=v.next()){var m=y.value,_=r.mapTextPosition(m.position,i),b=u[_.line];if(b){var k=_.column>b.length-1?b.length-1:b.index+_.column;g.push({index:k,exp:m.exp})}}}catch(T){o={error:T}}finally{try{y&&!y.done&&(s=v["return"])&&s.call(v)}finally{if(o)throw o.error}}c.liveComments=g.length?g:void 0}if(e.ignoreComments){var S=[];try{for(var C=n(e.ignoreComments),L=C.next();!L.done;L=C.next()){var j=L.value,_=r.mapTextPosition(j.position,i),b=u[_.line];if(b){var w=_.column>b.length-1?b.length-1:b.index+_.column;S.push({index:w})}}}catch(x){a={error:x}}finally{try{L&&!L.done&&(l=C["return"])&&l.call(C)}finally{if(a)throw a.error}}c.ignoreComments=S.length?S:void 0}return c}}},{"../../lib/global":43,"../../lib/utils":72}],74:[function(e,t,i){t.exports={name:"Wallaby.js",version:"1.0.1302",author:"Wallaby.js",license:"Proprietary",homepage:"https://wallabyjs.com",scripts:{postinstall:"node ./node_modules/grunt/bin/grunt patchNodeModules",test:"npm run test:unit","test:unit":"jest --no-cache --config=jest.unit.config.js","test:integration":"jest --no-cache --silent --runInBand --config=jest.integration.config.js --forceExit --json --outputFile=integration_tests.json","test:integration:verbose":"jest --no-cache --runInBand --config=jest.integration.config.js --forceExit --json --outputFile=integration_tests.json","test:integration:bootstrap":"cd ./test/samples/integration && node install","test:integration:reset":"cd ./test/samples/integration && node clean && node install","test:integration:isolated":"node ./test/samples/integration/test","test:integration:docker":"node ./test/docker/run.js",build:"node ./node_modules/grunt/bin/grunt bump-only && node ./node_modules/grunt/bin/grunt",release:"node ./docker/run.js"},dependencies:{"@babel/parser":"7.8.4","@babel/register":"7.10.3",acorn:"8.7.0","acorn-jsx":"5.3.1","acorn-walk":"8.0.2",arg:"4.1.3",bufferutil:"4.0.1",chokidar:"3.5.2","chrome-launcher":"0.15.1","chrome-remote-interface":"0.31.2","coffee-script":"1.10.0",commander:"2.5.0",compression:"1.7.2","copy-paste":"1.3.0",debug:"4.1.1","escodegen-wallaby":"1.6.35","esm-wallaby":"3.2.26",express:"4.17.1","fs-extra":"6.0.1","graceful-fs":"4.2.4",lodash:"3.0.0","lru-cache":"2.5.0",micromatch:"4.0.2",minimatch:"3.0.4",open:"8.0.7",phantom:"0.7.2",q:"1.5.0",semver:"4.3.3","source-map":"0.4.3","style-loader":"3.3.1","ts-node":"10.2.1","tsconfig-paths":"3.9.0",typescript:"4.4.2","underscore.string":"2.3.3","utf-8-validate":"5.0.2","util.promisify":"1.0.0",uuid:"7.0.3","write-file-atomic":"4.0.1",ws:"1.1.5"},devDependencies:{"@babel/core":"^7.10.4","@babel/generator":"^7.6.4","@babel/preset-env":"^7.12.11","@types/lodash":"^4.14.136","@types/node":"12.0.10","@types/semver":"^6.0.1","adm-zip":"^0.5.5","aws-sdk":"2.333.0","browserify-transform-tools":"1.5.0",chai:"4.2.0","chai-subset":"1.6.0",escodegen:"1.6.1","expect.js":"0.3.1",grunt:"1.0.3","grunt-browserify":"4.0.1","grunt-bump":"0.0.16","grunt-contrib-clean":"0.7.0","grunt-contrib-compress":"2.0.0","grunt-contrib-copy":"0.8.2","grunt-contrib-uglify":"0.11.0","grunt-run":"^0.8.1","grunt-ts":"^6.0.0-beta.22","javascript-obfuscator":"^0.18.1",jest:"^26.1.0","line-column":"^1.0.2","node-fetch":"^2.6.0",removeNPMAbsolutePaths:"1.0.4","typescript-cached-transpile":"0.0.6"},optionalDependencies:{keytar:"^4.10.0"},"private":!0}},{}],75:[function(e,t,i){var n,r,o,s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},s.apply(this,arguments)},a=e("path"),l=function(){};try{Error.stackTraceLimit=80}catch(c){}process.env&&process.env.NODE_MODULES_OVERRIDE&&(console.warn(" ---- Using node modules from: "+process.env.NODE_MODULES_OVERRIDE+" ---- "),e("./lib/utils").nodeModulesLookup(function(e){e.unshift(process.env.NODE_MODULES_OVERRIDE)}));var u=process.argv[2];if("worker"===u)l(),process.noDeprecation=!0,e("./lib/global"),process.on("message",function(t){if(t&&"exit"===t.type)return void process.exit(0);if("instrumentor"===t.type){var i=e("./lib/instrumentor");try{var n=i(t.content,t.opts);process.send(n)}catch(r){process.send({error:{message:r&&r.message,stack:r&&r.stack}})}}else if("preprocessor"===t.type||"compiler"===t.type){var o=e("./lib/processor");try{o(t)["catch"](function(e){process.send({error:{message:e&&e.message,stack:e&&e.stack}})}).then(function(e){e&&process.send(e)})}catch(r){process.send({error:{message:r&&r.message,stack:r&&r.stack}})}}}),process.send("READY");else if("runner"===u){if(process.env.WALLABY_ENV=!0,r=process.argv[7],r&&!process.env.quokka){var h=function(e,t){for(var i=[],n=0;n<t.length;n++)i.push(t[n]),e[n]&&i.push(e[n]);for(;n<e.length;n++)i.push(e[n]);return i};n=e("fs");var d=process.cwd(),f=a.dirname(r);o=a.join(d,"node_modules"),d!==f&&e("./lib/utils").nodeModulesLookup(function(e,t,i,n){var o=!1;e&&e[0]&&0===e[0].indexOf(d)&&(o=!0,Array.prototype.splice.apply(e,[0,e.length].concat(h(i.call(n,t.replace(d,f)),e)))),o||e.push(r)},function(e){var t=e.replace(o,r);return t===e||n.existsSync(t)?t:e})}e("./lib/nodeTestWorker")(process.argv[3],process.argv[4],process.argv[5],process.argv[6],r,process.argv[8],process.argv[9],process.argv[10],process.argv[11])}else if("extractor"===u){var p=process.argv[3];if("vitest"===p){var g=e("./lib/configurators/vitest/extract"),v=process.argv[4],y=process.argv[5],m=process.argv[6];g(v,y,m).then(function(e){return process.stdout.write(JSON.stringify(e))})["catch"](function(e){process.stderr.write(e.message),process.exit(1)})}}else{if(!process.versions||!process.versions.pnp){var b=["cjs","js"],k=e("fs");b.reduce(function(t,i){if(t)return t;var n=a.join(process.cwd(),".pnp."+i);if(k.existsSync(n))try{return e(n).setup(),process.env.WALLABY_PNP="--require "+n,!0}catch(r){}return!1},!1)}l(),process.env.PWD=process.cwd(),process.env.DEBUG="wallaby:.*",process.env.DEBUG_COLORS="no",process.noDeprecation=!0,n=e("graceful-fs");var T=e("./lib/app"),S=e("commander"),C=!1;S.unknownOption=function(){},S.option("-p, --port <port>","specify port").option("-l, --projectCachePath <projectCachePath>","specify project cache location").option("-l, --configPath <configPath>","specify config file location").option("-l, --testsPath <testsPath>","specify tests location",function(e,t){return void 0===t?[e]:t.concat([e])},void 0).option("-l, --smartStart <smartStart>","specify wallaby start start").option("-k, --lkp [lkp]","specify lkp location").option("-c, --client [client]","specify client").option("-q, --quokka [quokka]","specify quokka").option("-q, --editorTypeScript [editorTypeScript]","specify editorTypeScript").option("-q, --homeDir <homeDir>","specify homeDir").option("-q, --cv <cv>","specify cv").option("-q, --ol <true|false>","specify ol").option("-q, --te <te>","specify te").option("-q, --fid <te>","specify fid").parse(process.argv);var L={port:47878,location:a.join(__dirname,"lib","project")};if(S.port&&(L.port=S.port),S.smartStart&&(L.testsPath=[]),S.projectCachePath&&!S.quokka){if(S.projectCachePath&&S.projectCachePath.endsWith("-wsl")&&n.existsSync("/run/WSL")){var j=a.basename(S.projectCachePath),w=a.join(e("os").homedir(),".wallaby");S.projectCachePath=a.join(w,"projects",j.substr(0,j.length-4)),n.existsSync(w)||n.mkdirSync(w)}if(L.projectCachePath=S.projectCachePath,"true"!==S.ol){if(!n.existsSync(L.projectCachePath))if(L.projectCachePath){var x=a.dirname(L.projectCachePath);n.existsSync(x)||(x?n.mkdirSync(x):console.error("No project cache parent directory: "+JSON.stringify(s(s({},S),{options:void 0})))),n.mkdirSync(L.projectCachePath)}else console.error("No project cache directory: "+JSON.stringify(s(s({},S),{options:void 0})));try{L.projectCachePath=n.realpathSync(S.projectCachePath)}catch(F){}}}if(S.configPath){L.configPath=S.configPath,"win32"===process.platform&&(L.configPath=L.configPath.split(a.sep).reduce(function(e,t){if(e){var i=n.readdirSync(e+a.sep);return e+a.sep+(i.find(function(e){return e===t})||i.find(function(e){return e.toLowerCase()===t.toLowerCase()})||t)}return t.toUpperCase()},""));var E=a.dirname(L.configPath);if(E!==process.cwd())try{process.chdir(a.dirname(E)),process.chdir(E)}catch(c){try{process.chdir(E)}catch(c){throw new Error("Wallaby.js working directory could not be initialized.")}}}if(void 0!==S.testsPath&&(L.testsPath=S.testsPath),"win32"===process.platform&&(L.projectCachePath&&":"===L.projectCachePath[1]&&(L.projectCachePath=L.projectCachePath.charAt(0).toUpperCase()+L.projectCachePath.slice(1)),L.configPath&&":"===L.configPath[1]&&(L.configPath=L.configPath.charAt(0).toUpperCase()+L.configPath.slice(1))),L.projectCachePath&&!process.env.quokka&&"true"!==S.ol)for(var R=L.projectCachePath,I=1;;){var M=a.join(L.projectCachePath,"running"),O={pid:process.pid,date:Date.now()};if(!n.existsSync(L.projectCachePath)){n.mkdirSync(L.projectCachePath),n.writeFileSync(M,JSON.stringify(O));break}if(!n.existsSync(M)){n.writeFileSync(M,JSON.stringify(O));break}var P=!1;try{var q=JSON.parse(n.readFileSync(M));P=process.kill(q.pid,0)}catch(c){P="EPERM"===c.code}if(!P){n.writeFileSync(M,JSON.stringify(O));break}L.projectCachePath=a.join(a.dirname(R),a.basename(R)+"_"+I),I++}if(S.editorTypeScript&&(L.editorTypeScript=S.editorTypeScript),S.homeDir&&(L.homeDir=S.homeDir),S.cv&&(L.cv=S.cv),S.ol&&(L.ol=S.ol),S.te&&(L.te=parseInt(S.te,10),L.te>=0||delete L.te),S.fid&&(L.fileId=S.fid),C=S.quokka,C&&(process.env.quokka=!0),e("./lib/serverUtils").initServerOptions(L),L.intervalAction=!0,C){var N={},A={},D={},B=function(e){return A[e]||D[a.dirname(e)]||!(!e||!~e.indexOf("quokka_fake_path")&&!~e.indexOf(a.join(process.cwd(),C.substr(0,C.lastIndexOf(".")))))};L.fileStructureCachePromise=function(e){return L.readFilePromise(e).then(function(e){return Q.when(JSON.parse(e))})};var U=L.fileStatPromise;L.fileStatPromise=function(e){if(B(e)){var t=N[e];return t?Q.when({size:t.content?t.content.length:0}):Q.reject(new Error("File "+e+" not found"))}return U(e)};var V=L.readFilePromise;L.readFilePromise=function(e){if(B(e)){var t=N[e];return t?Q.when(t.content):Q.reject(new Error("File "+e+" not found"))}return V(e)};var H=L.writeFilePromise;L.writeFilePromise=function(e,t){return B(e)?(N[e]={content:t},Q.when(!0)):H(e,t)};var z=L.unlinkFilePromise;L.unlinkFilePromise=function(e){return B(e)?(delete N[e],Q.when(!0)):z(e)};var W=L.unlinkFileSync;L.unlinkFileSync=function(e){return B(e)?void delete N[e]:W(e)};var K=L.writeFileSync;L.writeFileSync=function(e,t){return B(e)?void(N[e]={content:t}):K(e,t)};var J=L.readFileSync;L.readFileSync=function(e){if(B(e)){var t=N[e];if(!t)throw new Error("File "+e+" not found");return t.content}return J(e)};var G=L.fileExistsSync;L.fileExistsSync=function(e){return B(e)?!!N[e]:G(e)};var Y=L.realpathSync;L.realpathSync=function(e){return B(e)?e:Y(e)};var X=L.dirRemovePromise;L.dirRemovePromise=function(e){return B(e)?Q.when(e):X(e)};var Z=L.dirRemoveSync;L.dirRemoveSync=function(e){return B(e)?e:Z(e)};var $=L.dirEnsurePromise;L.dirEnsurePromise=function(e){return B(e)?Q.when(e):$(e)};var ee=L.dirEnsureSync;L.dirEnsureSync=function(e){return B(e)?e:ee(e)},L.useMemoryFs=function(e,t){t&&(D[a.dirname(e)]=!0),A[e]=!0;for(var i=e;i!==a.dirname(i);)i=a.dirname(i),A[i]=!0}}L.onStart=_.noop,L.onConnected=_.noop;var te=e("ws/lib/Sender.fallbacks.js");if(L._init=te.create,L.coreVersion=e("./package.json").version,"extended-core"===process.argv[2]||"extended-core-ws"===process.argv[2]||C)if("extended-core"!==process.argv[2]){L.quokka=C,L.client=S.client||"Sublime",L.lkp=S.lkp,L.Receiver=te.create();var ie=e("ws").Server,ne=new ie({port:L.port,verifyClient:function(e){return _.verifyLocalOrigin(e.origin)}},function(){console.log(L.quokka?"quokka.js started":"wallaby.js started")});ne.on("connection",function(t){var i={send:function(e){t.send(JSON.stringify(e))},receive:_.noop};L.onConnected(i),t.on("message",function(e){var t=JSON.parse(e);"stop"===t.type?process.exit():i.receive(t)}),i.send({type:"started",version:e("./package.json").version})})}else{L.client=S.client||"Atom",L.lkp=S.lkp;e("util");L.Receiver=te.create(),process.nextTick(function(){var e={send:function(e){process.send(e)},receive:_.noop};process.on("message",function(t){"connection"===t.type?L.onConnected(e):"stop"===t.type?process.exit():e.receive(t)}),e.send({type:"started",version:L.coreVersion})})}else{L.Receiver=e("./lib/project");var re=e("ws").Server,oe=new re({port:L.port,verifyClient:function(e){return _.verifyLocalOrigin(e.origin)}},function(){console.log("wallaby.js started"),console.log("core v"+L.coreVersion)});oe.on("connection",function(e){var t={send:function(t){e.send(JSON.stringify(t))},receive:_.noop};L.onConnected(t),e.on("message",function(e){t.receive(JSON.parse(e))})})}T.start(L)}},{"./lib/app":7,"./lib/configurators/vitest/extract":38,"./lib/global":43,"./lib/instrumentor":44,"./lib/nodeTestWorker":47,"./lib/processor":61,"./lib/project":62,"./lib/serverUtils":64,"./lib/utils":72,"./package.json":74,commander:void 0,fs:void 0,"graceful-fs":void 0,os:void 0,path:void 0,"ts-node":void 0,util:void 0,ws:void 0,"ws/lib/Sender.fallbacks.js":void 0}]},{},[75]);